<!doctype html>
<html lang="zh-Hant">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E3KSVGJPGT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E3KSVGJPGT');
</script>
  
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BELAUG | FFXIV Library</title>
  <meta name="description" content="BELAUG’s FFXIV Library: A one-stop index for Main Story, Raids, BGM, Events, and Collections." />
  <link rel="icon" href="img/favicon.ico" />
  <meta property="og:title" content="BELAUG | FFXIV Library" />
  <meta property="og:description" content="主線、團本、BGM、活動與蒐集一站式索引。" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="img/og.png" />
  <meta property="og:url" content="https://example.com" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="stylesheet" href="style.css" />
  <script defer src="app.js"></script>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <a class="brand" href="#top" aria-label="BELAUG Home">Final Fantasy XIV Library</a>
      <div class="nav-right">
        <!-- 主題切換 -->
        <button id="themeToggle" class="icon-btn" aria-label="切換主題">🌙</button>
        <!-- 語言切換 -->
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
        <!-- YouTube -->
        <a class="icon-btn" href="https://www.youtube.com/@BELAUG" target="_blank" rel="noopener" aria-label="YouTube">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="yt-icon">
            <path d="M23.5 6.2s-.2-1.7-.8-2.5c-.8-.9-1.7-.9-2.1-1-3-.2-7.6-.2-7.6-.2h-.1s-4.6 0-7.6.2c-.4 0-1.3 0-2.1 1-.6.8-.8 2.5-.8 2.5S2 8.1 2 10v1.9c0 1.9.2 3.8.2 3.8s.2 1.7.8 2.5c.8.9 1.9.9 2.4 1 1.7.2 7.2.2 7.2.2s4.6 0 7.6-.2c.4 0 1.3 0 2.1-1 .6-.8.8-2.5.8-2.5s.2-1.9.2-3.8V10c0-1.9-.2-3.8-.2-3.8zM9.8 13.6V8.4l5.9 2.6-5.9 2.6z"/>
          </svg>
        </a>
      </div>
    </nav>
  </header>

  <main id="top">
    <section class="hero">
      <div class="container hero-inner">
        <h1>BELAUG’s FFXIV Library</h1>

        <!-- ★ tagline：之後由 JS 多語切換 -->
        <p id="tagline" class="sub">
          Organized by series: Main Story, Raids, BGM, Jobs/Events, Tools & Collections. Supports search, tags, and quick play.
        </p>

        <div class="filters">
          <input id="q" class="input" type="search" placeholder="搜尋標題、系列、標籤、章節…" />

          <!-- 分類：保留「全部分類」，其餘由 JS 產生 -->
          <select id="category" class="select">
            <option value="">全部分類</option>
          </select>

          <select id="expac" class="select">
            <option value="">全部資料片</option>
            <option value="ARR">ARR</option>
            <option value="HW">HW</option>
            <option value="SB">SB</option>
            <option value="SHB">SHB</option>
            <option value="EW">EW</option>
            <option value="DT">DT</option>
          </select>

          <select id="patch" class="select">
            <option value="">全部 Patch</option>
            <option value="2.x">2.x</option>
            <option value="3.x">3.x</option>
            <option value="4.x">4.x</option>
            <option value="5.x">5.x</option>
            <option value="6.x">6.x</option>
            <option value="7.x">7.x</option>
          </select>
          
<select id="sort" class="select">
  <option value="newest">Sort: Patch (new → old)</option>
  <option value="oldest">Sort: Patch (old → new)</option>
  <option value="titleAZ">Sort: Title (A→Z)</option>
  <option value="titleZA">Sort: Title (Z→A)</option>
  <option value="added">Sort: Last Added</option>
</select>
          
          <button id="clear" class="btn">清除條件</button>
        </div>

        <div id="activeTags" class="tags"></div>
      </div>
    </section>

    <section class="container">
      <div class="toolbar">
        <!-- 統計數：數字與單位分開，方便多語 -->
        <div class="count">
          <span id="resultCount">0</span><span id="itemsSuffix"> 項內容</span>
        </div>
      </div>
      
      <!-- ⭐ 推薦影片：JS 會自動填內容 -->
      <div id="featured" class="featured-slot"></div>

      <!-- 影片清單 -->
      <div id="grid" class="grid"></div>
      <div id="pager" class="pager"></div>
    </section>
  </main>

<!-- 播放器：使用 <dialog> -->
<dialog id="playerModal">
  <div class="modal-head">
    <h3 id="modalTitle">播放中…</h3>
    <button id="modalClose" class="btn ghost" aria-label="關閉">✕</button>
  </div>
  <div class="modal-body" style="height:min(70vh,600px); background:#000;">
    <iframe id="ytFrame" width="100%" height="100%" frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      allowfullscreen></iframe>
  </div>
</dialog>

  <footer class="site-footer">
    <div class="container foot">
      <small>© <span id="year"></span> BELAUG · FFXIV Library</small>
      <a href="#top" class="backtop" aria-label="回到頂端">↑</a>
    </div>
  </footer>

  <!-- 🔽 排序功能腳本放在這裡 -->
  <script>
  (function(){
    const grid = document.getElementById('grid');      
    const sortSelect = document.getElementById('sort'); 
    const clearBtn = document.getElementById('clear');  
    if(!grid || !sortSelect) return;

    function parsePatch(val){
      const m = (val ?? '').toString().match(/\d+(\.\d+)?/);
      return m ? parseFloat(m[0]) : NaN;
    }

    function sortGrid(mode){
      const rows = [...grid.querySelectorAll('.card')].map(el => ({
        el,
        title: (el.dataset.title || '').toLowerCase(),
        patch: parsePatch(el.dataset.patch)
      }));
      rows.sort((a,b)=>{
        switch(mode){
          case 'oldest':  return (a.patch||0) - (b.patch||0);
          case 'titleAZ': return a.title.localeCompare(b.title);
          case 'titleZA': return b.title.localeCompare(a.title);
          case 'newest':
          default:        return (b.patch||0) - (a.patch||0);
        }
      });
      rows.forEach(({el})=>grid.appendChild(el));
    }

    function applySort(){
      const mode = sortSelect.value || 'newest';
      sortGrid(mode);
      try{
        const u = new URL(location.href);
        if(mode && mode!=='newest') u.searchParams.set('sort', mode);
        else u.searchParams.delete('sort');
        history.replaceState(null,'',u);
      }catch(e){}
    }

    try{
      const s = new URL(location.href).searchParams.get('sort');
      if(s) sortSelect.value = s;
    }catch(e){}

    sortSelect.addEventListener('change', applySort);
    if(clearBtn){
      clearBtn.addEventListener('click', ()=> {
        requestAnimationFrame(applySort);
      });
    }

    const mo = new MutationObserver(()=>{
      clearTimeout(applySort._t);
      applySort._t = setTimeout(applySort, 50);
    });
    mo.observe(grid, { childList: true });

    applySort();
  })();
  </script>
</body>
</html>
  
</body>
</html>
