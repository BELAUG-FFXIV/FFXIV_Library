<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lost Promise | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="FFXIV MSQ â€“ Lost Promiseï¼ˆæ¶ˆãˆãŸç‹å¥³ / æ¶ˆå¤±çš„ç‹å¥³ï¼‰ï½œDawntrail Patch 7.0">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe src="https://www.youtube.com/embed/dSZKxXP35iY"
              title="Lost Promise" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="hd" id="pageTitle">Lost Promise</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Lost Promise',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true"><p>Rediroq is beside herself with worry, but Koana stays focused: if Lamatyâ€™i truly returned toward Earthenshire from the west, she should have passed by. Since Rediroq insists she never saw her, he reasons thereâ€™s a real chance she never made it back at allâ€”and the only way to confirm it is to question the sentry posted at the opposite entrance.</p><p>At the far gate, the sentry swears he has kept diligent watch and has seen no claimant pass, Lamatyâ€™i least of all. Yet when Koana asks about a Tonawawta with brightly colored hair, the sentry recalls local chatter: a Pelu peddler in Many Fires was attacked on the road by a â€œcrazyhairâ€ bandit. The report is enough for Koana to connect the dotsâ€”and to fear the messenger and the brigand may be the same person.</p><p>You hurry with Koana to Many Fires, where he points out the waylaid peddler and asks for every detail. The peddler recognizes Koana at once and names the attacker without hesitation: Wawkesa. With the great stairs broken and fewer travelers coming through, Wawkesaâ€™s gang has grown bolderâ€”preying on anyone they can for a handful of pel.</p><p>Koana doesnâ€™t waste time pretending this is a random robbery. If Wawkesa targeted Lamatyâ€™i, he likely intends to ransom her for a royal sumâ€”and Koana refuses to wait for demands that may come too late. He proposes a simple deception: he will disguise himself as a wealthy merchant to draw Wawkesa out, and when the bandit comes sniffing around, you seize him. The peddlerâ€”mercantile spirit intactâ€”provides the perfect outfit for the role.</p><p>With the bait prepared, Koana goes ahead into town to make himself seen. You follow behind and â€œspread the good wordâ€ to whoever will listenâ€”putting on a convincing show about how you paid a hefty purse for a rare gemstone, loud enough that the rumor canâ€™t help but travel. People blink at your performance, then start talking: if someone is flashing that kind of wealth, bandits will come.</p><p>Koana plays his part to the hilt, boasting like a man newly enriched and careless enough to travel without hired blades. Then he quietly signals what matters most: the rat has taken the nibble. He praises you for selling the lie convincinglyâ€”and with Wawkesaâ€™s attention caught at last, you move in to lure him out and spring the trap.</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>Quest Giver</b> Koana <small class="muted">Kozamaâ€™uka (X:10.8, Y:28.2)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-shape-of-peace.html">The Shape of Peace</a></div><div class="row">Any Disciple of War or Magic (excluding limited jobs) Lv. 92</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="a-brothers-duty.html">A Brotherâ€™s Duty</a></div></div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'æ¶ˆãˆãŸç‹å¥³',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true"><p>ãƒ¬ãƒ‡ã‚£ãƒ­ã‚¯ã¯ã²ã©ãä¸å®‰ãŒã£ã¦ã„ã‚‹ãŒã€ã‚³ãƒ¼ãƒŠã¯çŠ¶æ³ã‚’å†·é™ã«æ•´ç†ã™ã‚‹ã€‚ãƒ©ãƒãƒãŒè¥¿ã‹ã‚‰ã‚¢ãƒ¼ã‚¹ãƒ³ã‚·ãƒ£ã‚¤ã‚¢ã¸æˆ»ã£ãŸã®ãªã‚‰ã€ã“ã®é“ã‚’é€šã£ãŸã¯ãšã ã€‚ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšãƒ¬ãƒ‡ã‚£ãƒ­ã‚¯ã¯è¦‹ã¦ã„ãªã„ã¨è¨€ã†â€•â€•ã¨ãªã‚Œã°ã€ãã‚‚ãã‚‚æ‘ã¸æˆ»ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒé«˜ã„ã€‚ç¢ºã‹ã‚ã‚‹ã«ã¯ã€åå¯¾å´ã®å…¥å£ã«ç«‹ã¤è¦‹å¼µã‚Šã«è¨Šãã—ã‹ãªã„ã€‚</p><p>è¦‹å¼µã‚Šã¯ã€æŒã¡å ´ã§ç›®ã‚’å…‰ã‚‰ã›ã¦ã„ãŸãŒèª“ç´„è€…ã¯èª°ã‚‚é€šã£ã¦ã„ãªã„ã¨æ–­è¨€ã™ã‚‹ã€‚ã•ã‚‰ã«ã‚³ãƒ¼ãƒŠãŒã€Œæ´¾æ‰‹ãªé«ªè‰²ã®ãƒˆãƒŠãƒ¯ã‚¦ã‚¿æ—ã€ã«ã¤ã„ã¦å•ã†ã¨ã€æ€ã„å½“ãŸã‚‹å™‚ãŒå‡ºã¦ãã‚‹â€•â€•æœ‹å‹ã®ç¯ç«ã§ã€ãƒšãƒ«æ—ã®è¡Œå•†äººãŒâ€œå¥‡æŠœãªé«ªã®â€ç›—è³Šã«è¥²ã‚ã‚ŒãŸã¨ã„ã†è©±ã ã€‚ã‚³ãƒ¼ãƒŠã¯ãã®è¨€è‘‰ã‹ã‚‰ã€ä½¿è€…ã¨ç›—è³ŠãŒåŒä¸€äººç‰©ã§ã‚ã‚‹å±é™ºã‚’è¦‹ã¦å–ã‚Šã€ãƒ©ãƒãƒã®èº«ã«å·®ã—è¿«ã£ãŸå±é™ºãŒã‚ã‚‹ã¨åˆ¤æ–­ã™ã‚‹ã€‚</p><p>ã‚ãªãŸã¯ã‚³ãƒ¼ãƒŠã¨ã¨ã‚‚ã«æœ‹å‹ã®ç¯ç«ã¸æ€¥è¡Œã—ã€è¥²ã‚ã‚ŒãŸè¡Œå•†äººã‹ã‚‰äº‹æƒ…ã‚’èãã€‚è¡Œå•†äººã¯è¥²æ’ƒè€…ã®åã‚’å³åº§ã«æŒ™ã’ã‚‹â€•â€•ãƒ¯ãƒ¼ã‚±ã‚µã ã€‚éšæ®µãŒå´©ã‚Œã¦ç²ç‰©ãŒæ¸›ã£ãŸã›ã„ã§ã€é€£ä¸­ã¯å°‘ã—ã®é‡‘ã®ãŸã‚ãªã‚‰æ‰‹æ®µã‚’é¸ã°ãšã€è¡—é“ã§ç²ç‰©ã‚’ç‹™ã†ã‚ˆã†ã«ãªã£ãŸã®ã ã¨ã„ã†ã€‚</p><p>ã‚³ãƒ¼ãƒŠã¯ã€ç›¸æ‰‹ãŒãƒ©ãƒãƒã‚’ç‹™ã£ãŸã®ã¯èº«ä»£é‡‘ç›®çš„ã«é•ã„ãªã„ã¨è¦‹ã¦ã€è¦æ±‚ã‚’å¾…ã¤æ°—ã¯ãªã„ã¨å‘Šã’ã‚‹ã€‚ãã“ã§å½¼ã¯ç­–ã‚’ç¤ºã™â€•â€•è£•ç¦ãªå•†äººã«å¤‰è£…ã—ã¦ãƒ¯ãƒ¼ã‚±ã‚µã‚’èª˜ã„å‡ºã—ã€è¿‘ã¥ã„ãŸã¨ã“ã‚ã‚’æ•ã‚‰ãˆã‚‹ã€‚è¡Œå•†äººã¯å€¤å¼•ãã¾ã§ã—ã¦å¤‰è£…ç”¨ã®è¡£è£…ã‚’ç”¨æ„ã—ã€ã‚ãªãŸãŸã¡ã¯ãã®å ´ã§â€œé¤Œâ€ã‚’æ•´ãˆã‚‹ã€‚</p><p>ã‚³ãƒ¼ãƒŠã¯å…ˆã«é€²ã‚“ã§å­˜åœ¨ã‚’èª‡ç¤ºã—ã€ã‚ãªãŸã¯å¾Œã‚ã‹ã‚‰å™‚ã‚’åºƒã‚ã‚‹å½¹ã ã€‚å¸Œå°‘ãªå®çŸ³ã‚’æ‰‹ã«å…¥ã‚Œã‚‹ãŸã‚ã«å¤§é‡‘ã‚’æ‰•ã£ãŸã€ã¨å‘¨å›²ã«èã“ãˆã‚‹ã‚ˆã†å¤§ã’ã•ã«å–œã³ã€ã„ã‹ã«ã‚‚å„²ã‘è©±ãŒè»¢ãŒã‚Šè¾¼ã‚“ã ã‚ˆã†ã«æŒ¯ã‚‹èˆã†ã€‚äººã€…ã¯æˆ¸æƒ‘ã„ãªãŒã‚‰ã‚‚è©±ã«ä¹—ã‚Šã€ãã‚“ãªé‡‘ã®åŒ‚ã„ã¯ç›—è³Šã‚’å‘¼ã¶ã®ã ã¨å£ã€…ã«æ³¨æ„ã‚’ä¿ƒã™ã€‚</p><p>æœ€å¾Œã«ã‚³ãƒ¼ãƒŠãŒã€ç„¡ç”¨å¿ƒã«ã‚‚å¤§é‡‘ã‚’æŒã¡ãªãŒã‚‰è­·è¡›ã‚‚é€£ã‚Œãšã«æ—…ã‚’ç¶šã‘ã‚‹ã€ã¨ã‚ã–ã¨ã‚‰ã—ãèªã‚Šã€ç‹™ã‚ã‚Œã‚„ã™ã„ç²ç‰©ã‚’æ¼”ã˜åˆ‡ã‚‹ã€‚ã™ã‚‹ã¨å½¼ã¯åˆå›³ã™ã‚‹â€•â€•ç²ç‰©ã«å¯„ã£ã¦ãã‚‹å½±ãŒã‚ã‚‹ã€ã¨ã€‚ã‚ãªãŸã®æ¼”æŠ€ã‚’èªã‚ãŸã‚³ãƒ¼ãƒŠã¯ã€ä»Šã“ããƒ¯ãƒ¼ã‚±ã‚µã‚’è¡¨ã¸å¼•ããšã‚Šå‡ºã—ã€ç½ ã‚’ä»•æ›ã‘ã‚‹æ™‚ã ã¨æ­©ãå‡ºã™ã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ã‚³ãƒ¼ãƒŠ <small class="muted">ã‚³ã‚¶ãƒãƒ«ãƒ»ã‚« (X:10.8, Y:28.2)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-shape-of-peace.html">æœ›ã‚“ã å¹³å’Œã®å½¢</a></div><div class="row">ãƒ•ã‚¡ã‚¤ã‚¿ãƒ¼ ã‚½ãƒ¼ã‚µãƒ©ãƒ¼ (ãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ã) Lv 92</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="a-brothers-duty.html">å…„ã¨ã—ã¦</a></div></div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'æ¶ˆå¤±çš„ç‹å¥³',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true"><p>Rediroq ç„¦æ€¥å¾—åç«‹é›£å®‰ï¼Œä½† Koana é€¼è‡ªå·±å†·éœæ¨ç†ï¼šå¦‚æœ Lamatyâ€™i æ˜¯å¾è¥¿é‚Šå›åˆ° Earthenshireï¼Œå¥¹ç†æ‡‰æœƒç¶“éé€™è£¡ã€‚æ—¢ç„¶ Rediroq å …ç¨±æ²’è¦‹åˆ°å¥¹ï¼Œé‚£å°±å¾ˆå¯èƒ½å¥¹æ ¹æœ¬æ²’æœ‰å›åˆ°æ‘å­ã€‚è¦ç¢ºèªé€™ä»¶äº‹ï¼Œåªèƒ½å»å•å®ˆåœ¨å¦ä¸€å€‹å…¥å£çš„å“¨å…µã€‚</p><p>å“¨å…µèªªè‡ªå·±ä¸€ç›´åœ¨å´—ä½ä¸ŠèªçœŸç›¯å®ˆï¼Œå¾é ­åˆ°å°¾éƒ½æ²’çœ‹è¦‹ä»»ä½•èª“ç´„è€…ç¶“éï¼Œæ›´åˆ¥èªª Lamatyâ€™iã€‚å¯ç•¶ Koana è¿½å•ã€Œé‚£å€‹é ­é«®é¡è‰²å¾ˆé†’ç›®çš„ Tonawawtaã€æ™‚ï¼Œå“¨å…µç«‹åˆ»æƒ³èµ·è¿‘æœŸçš„å‚³èï¼šåœ¨ Many Firesï¼Œæœ‰ä½ Pelu çš„è¡Œå•†äººé­åˆ°ã€Œç‹‚é«®å¼·ç›œã€è¥²æ“Šã€‚Koana è½å®Œå°±æ˜ç™½ï¼Œå¸¶èµ° Lamatyâ€™i çš„äººå¾ˆå¯èƒ½å°±æ˜¯é‚£å€‹åŒªå¾’æœ¬äººã€‚</p><p>ä½ è·Ÿè‘— Koana è¶•å¾€ Many Firesï¼Œæ‰¾åˆ°é‚£åé­è¥²çš„è¡Œå•†äººã€‚è¡Œå•†äººä¸€çœ¼å°±èªå‡º Koanaï¼Œä¸¦æŠŠäº‹æƒ…èªªå¾—æ¸…æ¸…æ¥šæ¥šâ”€â”€è¥²æ“Šè€…æ˜¯ Wawkesaã€‚è‡ªå¾é€šå¾€ç€‘å¸ƒä¸Šçš„éšæ¢¯è¢«ç ´å£ï¼Œè·¯ä¸Šå°‘äº†æ–°çš„çµç‰©ï¼ŒWawkesa ä¸€å¤¥å°±è®Šå¾—æ›´è²ªæ›´ç‹ ï¼Œç‚ºäº†å¹¾å€‹ pel ä¹Ÿèƒ½ä¸æ“‡æ‰‹æ®µã€‚</p><p>Koana ä¸å†æŠŠé€™ç•¶æˆæ™®é€šæ¶åŠ«ï¼šå¦‚æœ Wawkesa ç›¯ä¸Š Lamatyâ€™iï¼Œç›®çš„å¤šåŠæ˜¯å‹’è´–ï¼Œç´¢è¦ã€Œç‹æ—ç­‰ç´šã€çš„å·¨é¡è´–é‡‘ã€‚å¯ä»–ä¸æ‰“ç®—ç­‰å°æ–¹é–‹å£æ‰è¡Œå‹•ï¼Œè€Œæ˜¯æå‡ºä¸€å€‹èª˜æ•µè¨ˆï¼šä»–è¦å‡æ‰®æˆå¯Œå•†ï¼ŒæŠŠ Wawkesa å¼•å‡ºä¾†ï¼›ç­‰åŒªå¾’ä¸€é è¿‘ï¼Œä½ å€‘å°±æŠŠä»–ç•¶å ´é€®ä½ã€‚è¡Œå•†äººç”šè‡³æ‹¿å‡ºä¸€å¥—åˆé©çš„è¡£è£ï¼Œè®“ Koana çš„å½è£æ›´åƒé‚£éº¼ä¸€å›äº‹ã€‚</p><p>é¤Œæº–å‚™å¥½å¾Œï¼ŒKoana å…ˆèµ°é€² Many Fires è®“äººæ³¨æ„åˆ°è‡ªå·±ï¼›ä½ å‰‡è·Ÿåœ¨å¾Œæ–¹ï¼Œé–‹å§‹æŠŠã€Œå¥½æ¶ˆæ¯ã€è¬›å¾—è¶ŠéŸ¿è¶Šå¥½â”€â”€ä½ èª‡å¼µåœ°ç‚«è€€è‡ªå·±èŠ±äº†ä¸€å¤§ç­†éŒ¢ï¼Œå¾ Koana é‚£è£¡è²·åˆ°ä¸€é¡†ç¨€æœ‰å¯¶çŸ³ï¼Œè®“æ—äººéƒ½è½è¦‹ã€éƒ½è·Ÿè‘—è­°è«–ã€‚æœ‰äººä¸€é–‹å§‹è½ä¸æ‡‚ä½ åœ¨æ¼”ä»€éº¼ï¼Œä½†å¾ˆå¿«å°±æŠ“åˆ°é‡é»ï¼šé€™ç¨®è²¡æ°£å¤–éœ²çš„å‚³èï¼Œæœ€å®¹æ˜“æŠŠå¼·ç›œæ‹›ä¾†ã€‚</p><p>Koana éš¨å³æŠŠæˆ²æ¼”åˆ°åº•ï¼šä»–å¾—æ„åœ°åƒå€‹å‰›å¤§è³ºä¸€ç­†çš„å•†äººï¼Œç”šè‡³æ•…æ„æåˆ°è‡ªå·±å¸¶è‘—åšåšçš„éŒ¢è¢‹ã€å»æ²’æœ‰é›‡å‚­å…µè­·è¡›â€”â€”ç°¡ç›´æ˜¯åœ¨å°åŒªå¾’æ‹›æ‰‹ã€‚ç„¶å¾Œä»–ä½è²æé†’ä½ ï¼šé­šä¸Šé‰¤äº†ã€‚ä½ å€‘ä¸å†å¤šèªªï¼Œè½‰è€Œå°ˆæ³¨ä¸‹ä¸€æ­¥â€”â€”æŠŠ Wawkesa é€¼åˆ°æª¯é¢ä¸Šï¼Œç«‹åˆ»æ”¶ç¶²ã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> Koana <small class="muted">Kozamaâ€™uka (X:10.8, Y:28.2)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-shape-of-peace.html">å’Œå¹³çš„æ¨£è²Œ</a></div><div class="row">ä»»ä¸€æˆ°é¬¥ï¼é­”æ³•è·ï¼ˆä¸å«é™åˆ¶è·æ¥­ï¼‰Lv.92</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="a-brothers-duty.html">èº«ç‚ºå…„é•·çš„è²¬ä»»</a></div></div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
