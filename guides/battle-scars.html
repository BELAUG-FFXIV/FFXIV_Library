<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Battle Scars | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Battle Scars (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/vr8H86qcITs"
              title="Battle Scars" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Battle Scars</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Battle Scars',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Drest, calmer now, thanks Shamani for his kindness. He wishes to return the favor, and entrusts you with a gift. Earlier that day at Red Mantis Falls, he had gathered sap from palm trees. Left in coconut shells for a few bells, the liquid ferments into a simple but fine wine. He asks you to retrieve the shells and deliver them to Shamani, expressing gladness that his friend has moved forward in life, and hope that he may one day do the same.</p>
      <p>When you return to Wineport, Shamani listens with quiet reflection. He inhales the scent of the palm wine and recalls that Drest had some skill in such rustic methods, simple yet effective. He resolves to enjoy the batch before it spoils. With somber tone, he admits how alike he and Drest truly areâ€”two men scarred, struggling not to be defined by their wounds. He worries Drest has been too long alone with his thoughts, and decides it is time he paid his old comrade a visit. With gratitude, he thanks you for looking after him.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Drest <small class="muted">(Eastern La Noscea, X:14.0, Y:30.3)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="that-weight.html">That Weight</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="it-was-a-very-good-year.html">It Was a Very Good Year</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'å‹æƒ…ã®æœ¨ã®å®Ÿ',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ãƒ‰ãƒ¬ã‚¹ãƒˆã¯è½ã¡ç€ãã‚’å–ã‚Šæˆ»ã™ã¨ã€ã‚·ãƒ£ãƒãƒ‹ãƒ»ãƒ­ãƒãƒ‹ã¸ã®æ„Ÿè¬ã‚’è¿°ã¹ãŸã€‚ãã—ã¦è‡ªåˆ†ã‹ã‚‰ã‚‚è´ˆã‚Šç‰©ã‚’è¨—ã—ãŸã„ã¨å‘Šã’ã‚‹ã€‚å…ˆã»ã©ã€ãƒ¬ãƒƒãƒ‰ãƒãƒ³ãƒ†ã‚£ã‚¹æ»ã§ãƒ¤ã‚·ã®æ¨¹æ¶²ã‚’é›†ã‚ã¦ã„ãŸã¨ã„ã†ã®ã ã€‚ã‚³ã‚³ãƒŠãƒƒãƒ„ã®æ®»ã«å…¥ã‚Œã¦æ•°ãƒ™ãƒ«ã®é–“å¯ã‹ã›ã‚Œã°ã€ç°¡ç´ ãªãŒã‚‰ã‚‚ä¸Šç­‰ãªé…’ã¨ãªã‚‹ã€‚ãã‚Œã‚’ã‚·ãƒ£ãƒãƒ‹ã«å±Šã‘ã¦ã»ã—ã„ã¨é ¼ã‚€ã€‚ã€Œå½¼ãŒæ–°ãŸãªäººç”Ÿã‚’æ­©ã‚“ã§ã„ã‚‹ã“ã¨ã‚’å¬‰ã—ãæ€ã†ã€‚ã„ã¤ã‹è‡ªåˆ†ã‚‚ãã†ã‚ã‚ŠãŸã„ã€ã¨ã€é™ã‹ã«å¸Œæœ›ã‚’å£ã«ã™ã‚‹ã€‚</p>
      <p>ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«æˆ»ã‚‹ã¨ã€ã‚·ãƒ£ãƒãƒ‹ãƒ»ãƒ­ãƒãƒ‹ã¯å ±å‘Šã‚’å—ã‘ã€æ·±ãé ·ãã€‚å·®ã—å‡ºã•ã‚ŒãŸé…’ã®é¦™ã‚Šã‚’å—…ãå–ã‚Šã€ã‹ã¤ã¦ãƒ‰ãƒ¬ã‚¹ãƒˆãŒã“ã†ã—ãŸç´ æœ´ãªé…’é€ ã‚Šã«é€šã˜ã¦ã„ãŸã“ã¨ã‚’æ€ã„å‡ºã™ã€‚ã€Œç°¡å˜ã ãŒåŠ¹æœçš„ãªæ–¹æ³•ã ã€‚å‚·ã‚€å‰ã«å‘³ã‚ã†ã¨ã—ã‚ˆã†ã€ã¨å¾®ç¬‘ã‚€ã€‚ãã—ã¦ã€Œæˆ‘ã‚‰ã¯ä¼¼ã¦ã„ã‚‹â€¦â€¦å‚·ã‚’èƒŒè² ã„ãªãŒã‚‰ã€ãã‚Œã«æ”¯é…ã•ã‚Œã¬ã‚ˆã†ã«ã‚‚ãŒãç¶šã‘ã¦ã„ã‚‹ç”·åŒå£«ã ã€ã¨åéœ²ã™ã‚‹ã€‚é•·ãå­¤ç‹¬ã«æ²ˆã‚“ã§ã„ãŸå½¼ã‚’æ¡ˆã˜ã€ã€Œãã‚ãã‚è¨ªã­ã¦ã‚„ã‚‰ã­ã°ãªã‚‹ã¾ã„ã€ã¨å¿ƒã«æ±ºã‚ã‚‹ã®ã ã£ãŸã€‚æœ€å¾Œã«ã€å›ã«æ„Ÿè¬ã‚’ä¼ãˆã€ãƒ‰ãƒ¬ã‚¹ãƒˆã‚’æ°—é£ã£ã¦ãã‚ŒãŸã“ã¨ã‚’å–œã‚“ã ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒ‰ãƒ¬ã‚¹ãƒˆã€€æ±ãƒ©ãƒã‚·ã‚¢ <small class="muted">(X:14.0, Y:30.3)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="that-weight.html">è€³ã«æ®‹ã‚‹ã¯èŸ²ã®éŸ³</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="it-was-a-very-good-year.html">äººã®å‘½é‹ã€ãƒ¯ã‚¤ãƒ³ã®é‹å‘½</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'å‚·ç—•å­•è‚²çš„å‹èª¼',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>Drest å¿ƒæƒ…å¹³å¾©å¾Œï¼Œæ„Ÿè¬ Shamani çš„å¥½æ„ï¼Œä¹Ÿå¸Œæœ›å›è´ˆä¸€ä»½ç¦®ç‰©ã€‚ä»–èªªè‡ªå·±æ—©äº›æ™‚å€™åœ¨ Red Mantis Falls æ¡é›†äº†æ£•æ«šæ¨¹æ¶²ï¼Œè‹¥æ”¾å…¥æ¤°æ®¼ä¸­éœç½®å¹¾å€‹é˜é ­ï¼Œå°±èƒ½ç™¼é…µæˆç°¡å–®å»å¯å£çš„é…’ã€‚ä»–è«‹ä½ æ›¿ä»–å–å›ä¸‰å€‹æ¤°æ®¼ä¸¦äº¤çµ¦ Shamaniï¼Œä¸¦æ„Ÿæ…¨åœ°èªªï¼Œä»–å¾ˆé«˜èˆˆçœ‹åˆ° Shamani å·²ç¶“èµ°ä¸Šæ–°çš„é“è·¯ï¼Œä¹Ÿå¸Œæœ›æœ‰ä¸€å¤©è‡ªå·±ä¹Ÿèƒ½å¦‚æ­¤ã€‚</p>
      <p>ä½ å›åˆ° Wineport å‘ Shamani å›å ±æ™‚ï¼Œä»–æ²‰æ€åœ°é»é ­ã€‚èè‘—æ£•æ«šé…’çš„æ°£æ¯ï¼Œä»–æƒ³èµ· Drest çš„ç¢ºæ‡‚å¾—é€™æ¨£çš„ç²—ç·é‡€é…’æ–¹æ³•ï¼Œé›–ç„¶ç°¡å–®å»è¡Œä¹‹æœ‰æ•ˆã€‚ä»–èªªæœƒè¶è®Šè³ªä¹‹å‰å¥½å¥½äº«ç”¨ã€‚éš¨å¾Œï¼Œä»–ç¥æƒ…åš´è‚…åœ°å¦è¨€ï¼Œè‡ªå·±èˆ‡ Drest å…¶å¯¦ä¸¦ç„¡ä¸åŒâ€”â€”éƒ½æ˜¯èƒŒè² å‚·ç—•å»åŠªåŠ›ä¸è®“å…¶æ±ºå®šä¸€åˆ‡çš„äººã€‚ä»–æ“”æ†‚ Drest å·²åœ¨å­¤å¯‚ä¸­å›°ä¹…äº†ï¼Œæ–¼æ˜¯æ±ºå®šè©²æ˜¯æ™‚å€™è¦ªè‡ªå‰å»æ¢æœ›ã€‚æœ€å¾Œï¼Œä»–è¡·å¿ƒæ„Ÿè¬ä½ æ›¿ä»–ç…§é¡§é€™ä½èˆŠå‹ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> å¾·é›·æ–¯ç‰¹ã€€æ‹‰è«¾è¥¿äºæ±éƒ¨ <small class="muted">(X:14.0, Y:30.3)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="that-weight.html">èŸ²é³´åœ¨è€³ã€é‡æ“”åœ¨å¿ƒ</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="it-was-a-very-good-year.html">å‘½é‹èˆ‡é…’é¦™äº¤ç¹”çš„ä¸€å¹´</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscusï¼šComments åˆ†é  === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
