<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Following Footfalls | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – Following Footfalls (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:#222;border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}

    /* 長文自動收合 */
    .story-collapsible{position:relative;max-height:380px;overflow:hidden}
    .story-collapsible::after{
      content:"";position:absolute;inset:auto 0 0 0;height:72px;
      background:linear-gradient(to bottom, rgba(255,248,230,0), var(--card));
    }
    .story-toggle{display:inline-block;margin-top:10px;padding:8px 14px;border:1px solid var(--border);
      border-radius:999px;background:#fff;cursor:pointer;font-weight:600}
    .story-expanded{max-height:none}
    .story-expanded::after{display:none}
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/TfZCL7818sg"
              title="Following Footfalls" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Following Footfalls</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:"Following Footfalls",
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest' },
    story:`<p>Fufulupa comes to you with urgent concern. Thaumaturges from the Ossuary are conducting a relic survey at the Footfalls, and Horizon has been tasked with their protection. But Captain Baldewyn, overseeing the deployment, has sent far too few Brass Blades for such a dangerous area.</p>
<p>Despite the chain of command, Fufulupa pleads for your help. You head toward the Footfalls and seek out Totoruna, one of the assigned guards. But your presence is not welcome. Totoruna scoffs at Fufulupa’s involvement, dismissing the boy’s caution and accusing him of overstepping.</p>
<p>Though you came to offer help, you now see the deeper issue—pride, power, and division within the ranks. Something isn’t right beneath the surface, and you’ve just stepped into the middle of it.</p>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Fufulupa <small class="muted">(Western Thanalan, X:22.6, Y:17.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="passing-the-blade.html">Passing the Blade</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="storms-on-the-horizon.html">Storms on the Horizon</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'足跡の谷へ',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト' },
    story:`<p>フフルパは深い憂慮を抱えてあなたに依頼を持ちかける。オッソアリーの呪術士たちがフットフォールズで古代遺物の調査を行っており、その護衛任務がホライズンの守備隊に下されたという。しかし、バルドウィン隊長が派遣した兵の数はあまりにも少なく、とても十分とは思えなかった。</p>
<p>命令系統を越える行動だと理解しつつも、フフルパはあなたに助力を求める。あなたは現地へ向かい、駐在するトトルナに声をかける。しかし、彼の反応は冷ややかだった。</p>
<p>「フフルパなんぞ関係ない」「バルドウィンの信頼を受けたのは俺たちだ」と、彼はあからさまにフフルパを侮り、排除しようとする。あなたが感じたのは、単なる人数不足ではない──組織内に広がる歪みと緊張の兆しだった。</p>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> フフルパ <small class="muted">（西ザナラーン, X:22.6, Y:17.1）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="passing-the-blade.html">受け継がれる護身刀</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="storms-on-the-horizon.html">酒のサカナ求む</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'踏尋足跡之谷',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務' },
    story:`<p>Fufulupa 神情凝重地向你求助。來自 Ossuary 的 Thaumaturges 正在 The Footfalls 探查古遺物，Horizon 駐軍被指派負責守衛。然而，負責部署的 Baldewyn 隊長卻只派出少數人手。</p>
<p>Fufulupa 深知這樣的編制根本不足以保障施法者安全。他懇請你前往支援。你來到 Footfalls，找到了 Brass Blade 駐守兵 Totoruna，卻遭遇不屑的冷眼。</p>
<p>「這又不關 Fufulupa 的事，」他這樣說。他不但拒絕你的幫助，還露骨地貶低 Fufulupa 的判斷力，暗示只有隊長親信才被視為「可信之人」。</p>
<p>你本是來幫忙的，卻無意中觸碰到更深的裂縫──階級、私利、與不願面對的危機，正在 Horizon 內部悄然蔓延。</p>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 弗弗魯帕 <small class="muted">（薩納蘭西部, X:22.6, Y:17.1）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="passing-the-blade.html">傳承之刃</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="storms-on-the-horizon.html">風暴前的酒宴</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}
function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  panels[key].innerHTML = t[key];
}
tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});
langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

/* —— 長文自動收合（依字數自動出現） —— */
const readMoreLabels = {
  EN: {more:'Read more', less:'Show less'},
  JP: {more:'続きを読む',   less:'折りたたむ'},
  ZH: {more:'展開全文',     less:'收合內容'}
};
function makeStoryCollapsible(lang){
  const panel = document.getElementById('panel-story');
  if(!panel) return;
  const textLen = panel.textContent.trim().length;
  if(textLen < 800) return;
  const inner = panel.innerHTML.trim();
  const wrap = document.createElement('div');
  wrap.className = 'story-collapsible';
  wrap.innerHTML = inner;
  const btn = document.createElement('button');
  const L = readMoreLabels[lang] || readMoreLabels.EN;
  btn.className = 'story-toggle';
  btn.textContent = L.more;
  btn.addEventListener('click', ()=>{
    const on = wrap.classList.toggle('story-expanded');
    btn.textContent = on ? L.less : L.more;
  });
  panel.innerHTML = '';
  panel.appendChild(wrap);
  panel.appendChild(btn);
}
/* 掛鉤 renderPanel：切到 Story 時套用收合 */
const _origRenderPanel = renderPanel;
renderPanel = function(key, lang){
  _origRenderPanel(key, lang);
  if(key==='story') makeStoryCollapsible(lang);
};

applyLang(getLang());
</script>
</body>
</html>
