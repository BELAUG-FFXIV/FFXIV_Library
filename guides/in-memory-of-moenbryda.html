<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>In Memory of Moenbryda | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ In Memory of Moenbryda (ARR Patch 2.5)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/c9VaOs1fsIU"
              title="In Memory of Moenbryda" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="hd" id="pageTitle">In Memory of Moenbryda</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"    class="tab-panel active"></div>
          <div id="panel-acq"      class="tab-panel"></div>
          <div id="panel-unlockq"  class="tab-panel"></div>
          <div id="panel-followq"  class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:`In Memory of Moenbryda`,
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true"><p>At the Rising Stones, Minfilia says that Moenbrydaâ€™s life and death were bound to Sharlayan, and that you should honor her in the Sharlayan mannerâ€”before the mark of the Scholar at Rathefrost, a monument sacred to Thaliak. There, you will pray for your friendâ€™s soul and bid her return in peace to the light of the Mothercrystal.</p><p>Thancred can only condemn himself for arriving too late, while Yda struggles to accept that Moenbryda is truly gone. Papalymo admits that loss is never easyâ€”least of all for Ydaâ€”while Yâ€™shtola knows it is foolish to torment oneself with what-ifs, and yet the heart refuses to listen to reason.</p><p>You make your way to Rathefrost in Mor Dhona, and Minfiliaâ€™s voice is heavy with apologyâ€”if only she had been quicker, or wiser. She cannot change what happened, but she believes Moenbryda would not want you to sink into sorrow; she would tell you to stand up and carry on. So Minfilia vows that you will defend this realm and its people to the very last.</p><p>Then, through the Echo, Midgardsormrâ€™s words reach you in a strange tongue you can nonetheless understand: life for deathâ€”a fair exchange. He adds that other bargains will be struck. The moment passes, leaving the meaning to linger.</p><p>Back at the Rising Stones, the grief does not lift. Thancred insists you must find a way to protect yourselves from Ascian intrusions. Yda asks only for time. Papalymo, usually quick with words, finds none that can ease her pain. Yâ€™shtola says the place itself feels colder, as if Moenbrydaâ€™s warmth is missing from every corner.</p><p>In the solar, Minfilia confesses that even after farewells, the sadness remains. As Antecedent, she must be the pillar for othersâ€”yet she cannot pretend the grief is something to sweep aside. It feels like a dagger in her chest, but it is a pain she must learn to bear to keep moving forward. She speaks of those already lostâ€”Louisoix, Moenbryda, and the comrades at the Waking Sandsâ€”and tells you their spirit will not be lost so long as you rise to fight again. And because there is no one else before whom she can show such weakness, she asks you to remain nearâ€”her steadfast presence, in the days to come.</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>Quest Giver</b> Minfilia <small class="muted">(Rising Stones, X:6.1, Y:5.2)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="an-uninvited-ascian.html">An Uninvited Ascian</a></div><div class="row">All classes and jobs (excluding limited jobs) (Level 50 or above)</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="mask-of-grief.html">Mask of Grief</a></div></div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'çŠ ç‰²ã¨èª“ã„',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true"><p>çŸ³ã®å®¶ã§ã€ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯èªã‚‹ã€‚ã‚·ãƒ£ãƒ¼ãƒ¬ã‚¢ãƒ³å‡ºèº«ã®ãƒ ãƒ¼ãƒ³ãƒ–ãƒªãƒ€ã‚’å²ã¶ãªã‚‰ã€å­¦éƒ½ã®å®ˆè­·ç¥ã‚µãƒªãƒ£ã‚¯ã«æ§ã’ã‚‰ã‚ŒãŸç¢‘ã®å‰â€•â€•ãƒ¢ãƒ¼ãƒ‰ã‚¥ãƒŠã®æ—©éœœå³ ã«ã‚ã‚‹ã€Œã‚µãƒªãƒ£ã‚¯ã®å°ã€ã«é›†ã†ã®ãŒãµã•ã‚ã—ã„ã€ã¨ã€‚ãã“ã§å‹ã®é­‚ã‚’ç¥ˆã‚Šã€ãƒã‚¶ãƒ¼ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã®å…‰ã¸å®‰ã‚‰ã‹ã«é‚„ã‚‹ã‚ˆã†è¦‹é€ã‚ã†ã€ã¨ã€‚</p><p>ã‚µãƒ³ã‚¯ãƒ¬ãƒƒãƒ‰ã¯ã€ã„ã¤ã‚‚ä¸€æ­©é…ã‹ã£ãŸã¨æ‚”ã‚„ã‚€ã°ã‹ã‚Šã§ã€ãƒ¤ãƒ»ãƒ€ã¯å—ã‘å…¥ã‚Œã‚‰ã‚Œãšã€ãƒ‘ãƒ‘ãƒªãƒ¢ã¯ã€èº«è¿‘ãªè€…ã‚’å¤±ã†ç—›ã¿ã®å‰ã§ã¯è¨€è‘‰ã‚’å¤±ã†ã“ã¨ã™ã‚‰ã‚ã‚‹ã®ã ã¨ç—›æ„Ÿã™ã‚‹ã€‚ãƒ¤ãƒ»ã‚·ãƒ¥ãƒˆãƒ©ã¯æ•‘ãˆãŸé“ãŒã‚ã£ãŸã®ã§ã¯ã¨è€ƒãˆã¦ã—ã¾ã†å¿ƒã®å¼±ã•ã‚’å¦å®šã§ããªã„ã€‚</p><p>ã‚ãªãŸãŒæ—©éœœå³ ã¸è¾¿ã‚Šç€ãã¨ã€ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯ãƒ ãƒ¼ãƒ³ãƒ–ãƒªãƒ€ã«è©«ã³ã‚‹ã€‚ã‚‚ã£ã¨æ—©ãã€ã‚‚ã£ã¨è³¢ãã‚ã‚ŒãŸãªã‚‰â€•â€•ãã†é¡˜ã£ã¦ã‚‚ç¾å®Ÿã¯æˆ»ã‚‰ãªã„ã€‚ã‘ã‚Œã©å½¼å¥³ã¯ã€ã‚ãªãŸãŸã¡ãŒæ‚²ã—ã¿ã«æ²ˆã‚€ã“ã¨ã‚’ãƒ ãƒ¼ãƒ³ãƒ–ãƒªãƒ€ã¯æœ›ã¾ãªã„ã¯ãšã ã¨è¨€ã„ã€ç«‹ã¡ä¸ŠãŒã£ã¦é€²ã‚ã€ã¨å±å’¤ã™ã‚‹å‹ã®å£°ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã€‚ã ã‹ã‚‰ã“ãã€æœ€å¾Œã¾ã§ã“ã®ä¸–ç•Œã¨äººã€…ã‚’å®ˆã‚ŠæŠœãã®ã ã¨èª“ã†ã€‚</p><p>ãã®ã¨ãã€ã‚¨ã‚³ãƒ¼ã‚’é€šã˜ã¦ã€ãƒŸãƒ‰ã‚¬ãƒ«ã‚ºã‚ªãƒ«ãƒ ã®ç•°ãªã‚‹è¨€è‘‰ãŒã‚ãªãŸã«å±Šãã€‚å‘½ã«ã¯å‘½ã§å¿œãˆã‚‹â€•â€•ãã‚Œã¯å…¬å¹³ãªå–å¼•ã ã€ã¨ã€‚ã•ã‚‰ã«ã€åˆ¥ã®å–å¼•ã‚‚äº¤ã‚ã•ã‚Œã‚‹ã ã‚ã†ã€ã¨ã ã‘å‘Šã’ã€ãã®æ°—é…ã¯é ã®ãã€‚</p><p>çŸ³ã®å®¶ã¸æˆ»ã£ã¦ã‚‚ã€å–ªå¤±ã®å½±ã¯è–„ã‚Œãªã„ã€‚ã‚¢ã‚·ã‚¨ãƒ³ã®ä¾µå…¥ã‚’é˜²ãè¡“ã‚’è¦‹ã¤ã‘ã­ã°ãªã‚‰ãªã„ã¨ã‚µãƒ³ã‚¯ãƒ¬ãƒƒãƒ‰ã¯è¨€ã„ã€ãƒ¤ãƒ»ãƒ€ã¯ä»Šã¯è©±ã™æ°—ã«ãªã‚Œãªã„ã‹ã‚‰æ™‚é–“ãŒã»ã—ã„ã¨ã“ã¼ã™ã€‚ãƒ‘ãƒ‘ãƒªãƒ¢ã¯æ…°ã‚ã®è¨€è‘‰ã‚’æŒã¦ãšã€ãƒ¤ãƒ»ã‚·ãƒ¥ãƒˆãƒ©ã¯ã€ãƒ ãƒ¼ãƒ³ãƒ–ãƒªãƒ€ã®æ¸©ã‹ã•ãŒæ¶ˆãˆãŸã›ã„ã‹çŸ³ã®å®¶ãŒä¸€æ®µã¨å†·ãŸãæ„Ÿã˜ã‚‹ã¨è¨€ã†ã€‚</p><p>ã‚½ãƒ¼ãƒ©ã§ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯æ‰“ã¡æ˜ã‘ã‚‹ã€‚ç›Ÿä¸»ã¨ã—ã¦çš†ã®æ”¯ãˆã§ã‚ã‚‰ã­ã°ãªã‚‰ãªã„ã®ã«ã€æ‚²ã—ã¿ã¯æ¶ˆãˆãšã€èƒ¸ã«çŸ­å‰£ã‚’çªãç«‹ã¦ã‚‰ã‚ŒãŸã‚ˆã†ã«ç—›ã‚€ã€‚ã ãŒè·è²¬ã‚’æœãŸã™ãŸã‚ã«ã¯ã€ãã®ç—›ã¿ã‚’æŠ±ãˆãŸã¾ã¾å‰ã¸é€²ã¾ã­ã°ãªã‚‰ãªã„ã€‚ãƒ«ã‚¤ã‚¾ãƒ¯ã€ãƒ ãƒ¼ãƒ³ãƒ–ãƒªãƒ€ã€ãã—ã¦ç ‚ã®å®¶ã§æ•£ã£ãŸä»²é–“ãŸã¡â€•â€•ãã®å¿—ã¯ã€ã‚ãªãŸãŒå†ã³ç«‹ã¡ä¸ŠãŒã‚Šæˆ¦ã†é™ã‚Šå¤±ã‚ã‚Œãªã„ã€‚ã ã‹ã‚‰ã“ãã€å¼±ã•ã‚’è¦‹ã›ã‚‰ã‚Œã‚‹ç›¸æ‰‹ã¯ã‚ãªãŸã—ã‹ã„ãªã„ã®ã ã¨èªã‚ã€ã“ã‚Œã‹ã‚‰ã®æ—¥ã€…ã‚‚å¤‰ã‚ã‚‰ã¬æ”¯ãˆã¨ã—ã¦ã€ãã°ã«ã„ã¦ã»ã—ã„ã¨é¡˜ã†ã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ <small class="muted">ï¼ˆçŸ³ã®å®¶, X:6.1, Y:5.2ï¼‰</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="an-uninvited-ascian.html">ãã®è€…ã€ãƒŠãƒ—ãƒªã‚¢ãƒ¬ã‚¹</a></div><div class="row">ã™ã¹ã¦ï¼ˆãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ãï¼‰Lv 50ï½</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="mask-of-grief.html">ã‚¤ãƒ€ã®æ±ºæ„</a></div></div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'çŠ§ç‰²èˆ‡èª“ç´„',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true"><p>åœ¨ Rising Stonesï¼ŒMinfilia èªªï¼ŒMoenbryda æ—¢æ˜¯ Sharlayan çš„äººï¼Œå°±è©²ä»¥ Sharlayan çš„æ–¹å¼å‘å¥¹é“åˆ¥â€”â€”å‰å¾€ Mor Dhona çš„ Rathefrostï¼Œåœ¨é‚£åº§åˆ»è‘—ã€Œå­¸è€…ä¹‹å°ã€çš„çŸ³ç¢‘å‰é›†çµã€‚é‚£è£¡æ˜¯ç»çµ¦ Thaliakã€å­¸éƒ½å®ˆè­·ç¥çš„è–åœ°ï¼›ä½ å€‘å°‡åœ¨é‚£è£¡ç‚ºå¥¹çš„éˆé­‚ç¥ˆç¦±ï¼Œé€å¥¹å®‰ç„¶å›æ­¸æ¯æ°´æ™¶ä¹‹å…‰ã€‚</p><p>Thancred ä»æ‡Šæ‚”è‡ªå·±ç¸½æ˜¯æ…¢äº†ä¸€æ­¥ï¼›Yda ä¸é¡˜ç›¸ä¿¡ Moenbryda çœŸçš„é›¢é–‹äº†ã€‚Papalymo æ˜ç™½å¤±å»æ‘¯å‹çš„ç—›å¾ä¸è¼•æ˜“ï¼Œå°¤å…¶å° Yda æ›´æ˜¯å¦‚æ­¤ï¼›Yâ€™shtola ä¹ŸçŸ¥é“åè¦†è¿½å•ã€Œè‹¥ç•¶æ™‚å¦‚ä½•ã€å¾ˆæ„šè ¢ï¼Œä½†äººçš„å¿ƒå¾€å¾€è½ä¸é€²å†·éœçš„é“ç†ã€‚</p><p>ä½ æŠµé” Rathefrostï¼ŒMinfilia çš„æ­‰æ„æ²‰ç”¸ç”¸çš„â€”â€”è‹¥å¥¹èƒ½æ›´å¿«ã€æ›´æ˜æ™ºä¸€äº›å°±å¥½äº†ã€‚å¯å¥¹ä¹ŸçŸ¥é“ï¼ŒMoenbryda ä¸æœƒå¸Œæœ›ä½ å€‘æ²‰æººåœ¨æ‚²å‚·è£¡ï¼›å¥¹ä¸€å®šæœƒè¦ä½ å€‘æŠŠè‡ªå·±æ’èµ·ä¾†ï¼Œç¹¼çºŒå¾€å‰èµ°ã€‚æ–¼æ˜¯ Minfilia ç™¼èª“ï¼šä½ å€‘æœƒå®ˆè­·é€™å€‹ä¸–ç•Œèˆ‡äººå€‘ï¼Œç›´åˆ°æœ€å¾Œä¸€åˆ»ã€‚</p><p>éš¨å³ï¼Œé€é Echoï¼Œä½ è½è¦‹ Midgardsormr ä»¥é™Œç”Ÿçš„èªè¨€é–‹å£ï¼Œå»ä»èƒ½ç†è§£å…¶æ„ï¼šä»¥å‘½å„Ÿå‘½â€”â€”é€™æ˜¯ä¸€å ´å…¬å¹³çš„äº¤æ›ã€‚ä»–åˆè£œä¸Šä¸€å¥ï¼šé‚„æœƒæœ‰å…¶ä»–äº¤æ˜“è¢«è¿«ç· çµã€‚è©±èªæ¶ˆæ•£ï¼Œå»æŠŠé‡é‡ç•™åœ¨ç©ºæ°£è£¡ã€‚</p><p>å›åˆ° Rising Stonesï¼Œå“€å‚·ä¾èˆŠæ®ä¹‹ä¸å»ã€‚Thancred èªªï¼Œå¿…é ˆæƒ³å‡ºèƒ½é˜²æ­¢ Ascians å…¥ä¾µçš„è¾¦æ³•ï¼›Yda åªæ±‚ä½ å€‘çµ¦å¥¹ä¸€äº›æ™‚é–“ã€‚Papalymo ç½•è¦‹åœ°æ‰¾ä¸åˆ°èƒ½å®‰æ…°äººçš„è©±ï¼›Yâ€™shtola å‰‡èªªï¼ŒRising Stones åƒæ˜¯è®Šå¾—æ›´å†·äº†â€”â€”å½·å½¿å°‘äº† Moenbryda é‚£ä»½ç¸½èƒ½å¸¶ä¾†çš„æº«åº¦èˆ‡æ˜æœ—ã€‚</p><p>Minfilia å¦æ‰¿ï¼šå°±ç®—é“åˆ¥äº†ï¼Œæ‚²å‚·ä»æœªæ¶ˆé€€ã€‚èº«ç‚º Antecedentï¼Œå¥¹å¿…é ˆæˆç‚ºçœ¾äººèƒ½å€šé çš„æ”¯æŸ±ï¼Œå»ä¹Ÿç„¡æ³•å¦èªé€™ä»½ç—›åƒåŒ•é¦–åˆºé€²èƒ¸å£ã€‚å¯è‹¥è¦å±¥è¡Œè²¬ä»»ï¼Œå°±å¾—å­¸æœƒèƒŒè² å®ƒå‰è¡Œã€‚å¥¹æèµ· Louisoixã€Moenbrydaï¼Œä»¥åŠåœ¨ Waking Sands å¤±å»çš„åŒä¼´â€”â€”åªè¦ä½ å€‘é‚„æœƒå†åº¦ç«™èµ·ä¾†æˆ°é¬¥ï¼Œä»–å€‘çš„ç²¾ç¥å°±ä¸æœƒæ¶ˆå¤±ã€‚æœ€å¾Œï¼Œå¥¹æŠŠè„†å¼±äº¤çµ¦ä½ ï¼šå› ç‚ºå†æ²’æœ‰å…¶ä»–äººèƒ½è®“å¥¹å¦‚æ­¤å¸ä¸‹é˜²å‚™ï¼›è€Œæœªä¾†çš„æ—¥å­è£¡ï¼Œå¥¹ä»éœ€è¦ä½ é‚£ä»½å …å®šçš„é™ªä¼´ã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>Quest Giver</b> æ•è²åˆ©äº <small class="muted">(çŸ³ä¹‹å®¶, X:6.1, Y:5.2)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="an-uninvited-ascian.html">ä¸é€Ÿä¹‹å®¢</a></div><div class="row">æ‰€æœ‰è·æ¥­ï¼ˆä¸å«é™å®šè·ï¼‰ ç­‰ç´š 50 ä»¥ä¸Š</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="mask-of-grief.html">æˆ´ä¸Šæ‚²å‚·çš„é¢å…·</a></div></div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle.replace(/&#39;/g,"'");
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

const GISCUS_CFG = {
      repo: 'BELAUG-FFXIV/FFXIV_Library',
      repoId: 'R_kgDOPyh4Kw',
      category: 'General',
      categoryId: 'DIC_kwDOPyh4K84CwPjL',
      theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
