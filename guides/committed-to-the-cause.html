<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Committed to the Cause | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Committed to the Cause (ARR Patch 2.55)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/2q7ppRvWjVk"
              title="Committed to the Cause" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="hd" id="pageTitle">Committed to the Cause</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"    class="tab-panel active"></div>
          <div id="panel-acq"      class="tab-panel"></div>
          <div id="panel-unlockq"  class="tab-panel"></div>
          <div id="panel-followq"  class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:`Committed to the Cause`,
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true"><p>Back at The Rising Stones, Alphinaud wastes no time. If you are to aid Ishgard in this war, preparations must be madeâ€”and soon. Yet before anything else, he insists you return and report to the Antecedent, so that the decision is heard and borne by all.</p><p>In The Solar, Minfilia receives Alphinaud with relief and urgency, asking what he has learned. He asks her to summon the others at once; everyone must hear the report. As the room gathers, Minfiliaâ€™s voice tightensâ€”this, then, was only a taste of what is to come. Alphinaud answers that it was: even now, the main host advances upon Ishgard.</p><p>Papalymo follows with the grim implicationâ€”those vaunted defenses have been nullified. Yâ€™shtola sharpens it further: shorn of its wards, the city will be forced to endure the full weight of Nidhoggâ€™s fury. Yda can only think of the people who will be caught beneath it. Thancred steadies the fear into resolve: Alphinaud is rightâ€”the Dravanians cannot be allowed to prevail. If Ishgard falls, all of Eorzea will suffer.</p><p>Alphinaud seizes the point. You all agree, then, that there is no choice but to intervene. For the good of the realm, Scions of the Seventh Dawn and the Crystal Braves must join the defense of Ishgard. Minfilia makes the stakes explicit: there can be no ambiguityâ€”this would be direct intervention in war. But if all present believe the cause is just, then to war you shall go.</p><p>She calls the path perilous, and asks you to walk it with them to the endâ€”for those you have lost, and for those you can yet save. With that, Alphinaud declares it settled. He will inform the council of your intentions, and request that they commit their own forces to Ishgardâ€™s defense.</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>Quest Giver</b> Alphinaud <small class="muted">(Intercessory, X:6.0, Y:6.1)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-wyrms-roar.html">The Wyrmâ€™s Roar</a></div><div class="row">All classes and jobs (excluding limited jobs) (Level 50 or above)</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="volunteer-dragonslayers.html">Volunteer Dragonslayers</a></div></div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'å‚æˆ¦ã®æ±ºæ„',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true"><p>ã‚¢ãƒ«ãƒ•ã‚£ãƒã¯æ±ºæ–­ã‚’æ€¥ãã€‚ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰ã®æˆ¦ã«æ‰‹ã‚’è²¸ã™ã®ãªã‚‰ã€æº–å‚™ã¯é¿ã‘ã‚‰ã‚Œãšã€ã—ã‹ã‚‚ä¸€åˆ»ã®çŒ¶äºˆã‚‚ãªã„ã€‚ã ãŒãã®å‰ã«ã€ã¾ãšã¯ãƒ©ã‚¤ã‚¸ãƒ³ã‚°ã‚¹ãƒˆãƒ¼ãƒ³ã‚ºã¸æˆ»ã‚Šã€ç›Ÿä¸»ã«å ±å‘Šã›ã­ã°ãªã‚‰ãªã„â€•â€•ãã†ã—ã¦ææ¡ˆã®é‡ã¿ã‚’çš†ã§èƒŒè² ã†ã®ã ã€ã¨ã‚ãªãŸã«ä¿ƒã™ã€‚</p><p>ã‚½ãƒ¼ãƒ©ãƒ«ã§ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯ã‚¢ãƒ«ãƒ•ã‚£ãƒã‚’è¿ãˆã€ä½•ã‚’å¾—ãŸã®ã‹ã¨å•ã†ã€‚ã‚¢ãƒ«ãƒ•ã‚£ãƒã¯ã€Œçš†ã‚’å‘¼ã‚“ã§ã»ã—ã„ã€ã¨é ¼ã‚€ã€‚å ±å‘Šã¯å…¨å“¡ãŒèãã¹ãã ã€‚é›†ã¾ã£ãŸç©ºæ°—ã®ä¸­ã§ã€ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯è¨€ã†â€•â€•å…ˆã»ã©ã®å‡ºæ¥äº‹ã¯ã€ã“ã‚Œã‹ã‚‰æ¥ã‚‹ã‚‚ã®ã®å‰è§¦ã‚Œã«ã™ããªã‹ã£ãŸã®ã ã‚ã†ã€ã¨ã€‚ã‚¢ãƒ«ãƒ•ã‚£ãƒã¯è‚¯å®šã—ã€ä¸»åŠ›ã¯ã™ã§ã«ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰ã¸é€²è»ä¸­ã ã¨å‘Šã’ã‚‹ã€‚</p><p>ãƒ‘ãƒ‘ãƒªãƒ¢ã¯ã€èª‡ç¤ºã•ã‚Œã¦ã„ãŸé˜²å‚™ãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸã“ã¨ã‚’æŒ‡æ‘˜ã™ã‚‹ã€‚ãƒ¤ãƒ»ã‚·ãƒ¥ãƒˆãƒ©ã¯ç¶šã‘ã‚‹â€•â€•çµç•Œã‚’å¤±ã£ãŸéƒ½å¸‚ã¯ã€ãƒ‹ãƒ¼ã‚ºãƒ˜ãƒƒã‚°ã®æ¿€æ€’ã‚’æ­£é¢ã‹ã‚‰å—ã‘ã‚‹ã»ã‹ãªã„ã€‚ãƒ¤ãƒ»ãƒ€ã¯æ€ã‚ãšã€äººã€…ã®ã“ã¨ã‚’å£ã«ã™ã‚‹ã€‚ã‚µãƒ³ã‚¯ãƒ¬ãƒƒãƒ‰ã¯ãã‚Œã‚’è¦šæ‚Ÿã¸å¤‰ãˆã€ã‚¢ãƒ«ãƒ•ã‚£ãƒã®è¨€è‘‰ã¯æ­£ã—ã„ã¨è¨€ã†ã€‚ãƒ‰ãƒ©ãƒ´ã‚¡ãƒ‹ã‚¢ã‚’å‹ãŸã›ã¦ã¯ãªã‚‰ãªã„ã€‚ã‚‚ã—ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰ãŒè½ã¡ã‚Œã°ã€è¢«å®³ã¯ã‚¨ã‚ªãƒ«ã‚¼ã‚¢å…¨åŸŸã«åŠã¶ã€‚</p><p>ã‚¢ãƒ«ãƒ•ã‚£ãƒã¯çµè«–ã‚’å¼•ãå–ã‚‹ã€‚ãªã‚‰ã°ä»‹å…¥ã¯ä¸å¯é¿ã ã€‚å›½ã®ãŸã‚ã«ã€ç¬¬ä¸ƒéœŠç½ã®æšã¨ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ–ãƒ¬ã‚¤ãƒ–ã¯ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰é˜²è¡›ã«åŠ ã‚ã‚‰ã­ã°ãªã‚‰ãªã„ã€‚ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯ã€ææ¡ˆã®æ„å‘³ã‚’ã¯ã£ãã‚Šã•ã›ã‚‹â€•â€•ã“ã‚Œã¯æˆ¦äº‰ã¸ã®ç›´æ¥ä»‹å…¥ã ã€‚ãã‚Œã§ã‚‚ã“ã“ã«ã„ã‚‹å…¨å“¡ãŒæ­£ç¾©ã®ãŸã‚ã ã¨ä¿¡ã˜ã‚‹ãªã‚‰ã€æˆ¦ã¸èµ´ã“ã†ã€‚</p><p>å½¼å¥³ã¯é“ãŒå±é™ºã§ã‚ã‚‹ã“ã¨ã‚’èªã‚ã¤ã¤ã€ã‚ãªãŸã«æœ€å¾Œã¾ã§å…±ã«æ­©ã‚“ã§ã»ã—ã„ã¨é¡˜ã†ã€‚å¤±ã£ãŸè€…ãŸã¡ã®ãŸã‚ã«ã€ãã—ã¦ã¾ã æ•‘ãˆã‚‹è€…ãŸã¡ã®ãŸã‚ã«ã€‚ã‚¢ãƒ«ãƒ•ã‚£ãƒã¯ã€Œæ±ºã¾ã£ãŸã€ã¨å‘Šã’ã€è©•è­°ä¼šã¸æ„å‘ã‚’ä¼ãˆã€ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰é˜²è¡›ã®ãŸã‚ã®å…µã®æä¾›ã‚’è¦è«‹ã™ã‚‹ã¨ç´„æŸã™ã‚‹ã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ã‚¢ãƒ«ãƒ•ã‚£ãƒ <small class="muted">ï¼ˆå¿œæ¥å®¤, X:6.0, Y:6.1ï¼‰</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-wyrms-roar.html">é‚ªç«œã®å’†å“®</a></div><div class="row">ã™ã¹ã¦ï¼ˆãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ãï¼‰Lv 50ï½</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="volunteer-dragonslayers.html">ç«‹ã¦ã‚ˆç¾©å‹‡å…µï¼</a></div></div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'åƒæˆ°çš„æ±ºå¿ƒ',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true"><p>Alphinaud èªªå¾—å¾ˆæ˜ç™½ï¼šè‹¥ä½ å€‘è¦å”åŠ© Ishgard çš„é€™å ´æˆ°çˆ­ï¼Œå°±å¿…é ˆç«‹åˆ»é–‹å§‹åšæº–å‚™ï¼Œæ‹–ä¸å¾—ã€‚ä½†åœ¨å‡ºç™¼ä¹‹å‰ï¼Œä½ å€‘å¾—å…ˆå› Rising Stonesï¼Œå‘ Antecedent å ±å‘Šï¼ŒæŠŠä½ å€‘å³å°‡åšå‡ºçš„æ±ºå®šæ”¤åœ¨æ‰€æœ‰äººé¢å‰ã€‚</p><p>å›åˆ° The Solarï¼ŒMinfilia è¦‹åˆ° Alphinaudï¼Œç«‹åˆ»è¿½å•ä»–å¾—åˆ°äº†ä»€éº¼æ¶ˆæ¯ã€‚Alphinaud è«‹å¥¹æŠŠå…¶ä»–äººéƒ½å¬é›†éä¾†â€”â€”é€™ä»½å ±å‘Šå¿…é ˆè®“æ¯å€‹äººè¦ªè€³è½è¦‹ã€‚ç­‰çœ¾äººåˆ°é½Šï¼ŒMinfilia ä½è²èªªï¼Œå…ˆå‰çš„ä¸€åˆ‡çœ‹ä¾†åªæ˜¯ã€Œåšåˆ°ä¸€å£ã€è€Œå·²ï¼›çœŸæ­£çš„é¢¨æš´é‚„åœ¨å¾Œé ­ã€‚Alphinaud ç›´æ¥å›æ‡‰ï¼šæ²’éŒ¯ï¼Œä¸»åŠ›æ­£åœ¨å‘ Ishgard æ¨é€²ã€‚</p><p>Papalymo æŒ‡å‡ºï¼Œé‚£äº›è¢«å¹æ§çš„é˜²ç¦¦å¦‚ä»Šå·²è¢«ç“¦è§£ã€‚Yâ€™shtola æ¥è‘—èªªï¼Œå¤±å»çµç•Œå¾Œï¼ŒåŸå¸‚å°‡ä¸å¾—ä¸æ­£é¢æ‰¿å— Nidhogg çš„æ€’ç«ã€‚Yda æƒ³åˆ°çš„æ˜¯é‚£äº›ç„¡è¾œçš„äººã€‚Thancred è®“æƒ…ç·’è½å›æ±ºå¿ƒï¼šAlphinaud èªªå¾—å°ï¼ŒDravanians ä¸èƒ½å¾—é€ï¼›ä¸€æ—¦ Ishgard æ·ªé™·ï¼Œæ•´å€‹ Eorzea éƒ½æœƒæ‰¿å—å¾Œæœã€‚</p><p>Alphinaud æ–¼æ˜¯æŠŠçµè«–èªªå‡ºå£ï¼šæ—¢ç„¶å¦‚æ­¤ï¼Œä½ å€‘åˆ¥ç„¡é¸æ“‡ï¼Œåªèƒ½ä»‹å…¥ã€‚ç‚ºäº†é€™ç‰‡å¤§åœ°ï¼ŒScions of the Seventh Dawn èˆ‡ Crystal Braves éƒ½å¿…é ˆåŠ å…¥ Ishgard çš„é˜²è¡›ã€‚Minfilia å…ˆæŠŠæ„ç¾©é‡˜æ­»â€”â€”é€™ä¸æ˜¯æ—è§€æˆ–æ”¯æ´é‚Šè§’ï¼Œè€Œæ˜¯å°æˆ°çˆ­çš„ç›´æ¥ä»‹å…¥ï¼›ä½†è‹¥åœ¨å ´æ‰€æœ‰äººéƒ½ç›¸ä¿¡é€™æ˜¯æ­£ç•¶çš„äº‹ï¼Œé‚£ä½ å€‘å°±è¸ä¸Šæˆ°å ´ã€‚</p><p>å¥¹æé†’ä½ å€‘ï¼Œå‰æ–¹é“è·¯å‡¶éšªï¼Œä»è«‹ä½ èˆ‡ä»–å€‘ä¸€èµ·èµ°åˆ°æœ€å¾Œâ€”â€”ç‚ºäº†é‚£äº›å·²ç¶“å¤±å»çš„äººï¼Œä¹Ÿç‚ºäº†é‚£äº›ä»æœ‰æ©Ÿæœƒè¢«ä½ å€‘æ•‘ä¸‹çš„äººã€‚Alphinaud æœ€å¾Œå®£å¸ƒä¸€åˆ‡å·²å®šï¼šä»–æœƒæŠŠä½ å€‘çš„æ„å‘é€šå ±è­°æœƒï¼Œä¸¦è«‹æ±‚ä»–å€‘ä¹Ÿæ´¾å‡ºå…µåŠ›ï¼Œå…±åŒå®ˆè­· Ishgardã€‚</p></div><div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack"><div class="row"><b>Quest Giver</b> é˜¿çˆ¾è²è«¾ <small class="muted">(æ‡‰æ¥å®¤, X:6.0, Y:6.1)</small></div></div>`,
    unlockq:`<div class="stack"><div class="row"><a class="link" href="the-wyrms-roar.html">å·¨é¾çš„æ€’å¼</a></div><div class="row">æ‰€æœ‰è·æ¥­ï¼ˆä¸å«é™å®šè·ï¼‰ ç­‰ç´š 50 ä»¥ä¸Š</div></div>`,
    followq:`<div class="stack"><div class="row"><a class="link" href="volunteer-dragonslayers.html">æ‹›å‹Ÿç¾©å‹‡å± é¾è€…</a></div></div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle.replace(/&#39;/g,"'");
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

const GISCUS_CFG = {
      repo: 'BELAUG-FFXIV/FFXIV_Library',
      repoId: 'R_kgDOPyh4Kw',
      category: 'General',
      categoryId: 'DIC_kwDOPyh4K84CwPjL',
      theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
