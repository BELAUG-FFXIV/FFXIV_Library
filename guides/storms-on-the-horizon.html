<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Storms on the Horizon | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Storms on the Horizon (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    /* å±•é–‹/æ”¶åˆ */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/4vjf6FrsOkk"
              title="Storms on the Horizon" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Storms on the Horizon</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Storms on the Horizon',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>At the Footfalls, with the worn stone of ancient ruins rising around you, Nunuzofu waves you over with the easy familiarity of someone used to grabbing passing adventurers. He asks if you would mind running a message to Crescent Cove on their behalf, then explains that Captain Baldewyn is planning a small celebration for the thaumaturges from the Ossuary and wants them treated to only the finest food and drinkâ€”nothing but the best for such distinguished guests. To make that happen, the feast will need fresh fish in abundance. Nunuzofu tells you to head west, then south along the coast to the fishing hamlet of Crescent Cove and deliver the captainâ€™s order: Raffe is to send a bounty of freshly caught fish to Horizon in time for the festivities.</p>
      <p>Following his directions, you leave the sandstone ridges of the Footfalls behind and make your way toward the sea, until the scent of salt and the sight of small boats drawn up along the shore tell you that youâ€™ve reached Crescent Cove. There you find Raffe, who stiffens the moment you mention Captain Baldewyn and the request for a great haul of fresh fish. Stammering slightly, he assures you that of course they will do their best, but admits that the catch has been poor of lateâ€”the seas have been rough, and the boats returning to the village bring in far less than they once did. More vessels should be back soon, he says, but he cannot promise that what they land will satisfy such high expectations. Even so, he straightens his shoulders and swears that the captain will have his fish, no matter what it takes, leaving you with the sense of a village struggling to meet a demand it can ill afford to fail.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Nunuzofu <small class="muted">Western Thanalan (X:17.9, Y:16.0)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="following-footfalls.html">Following Footfalls</a></div>
      <div class="row">All classes and jobs (excluding limited jobs) (Level 10 or above)</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="oh-captain-my-captain.html">Oh Captain, My Captain</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'é…’ã®ã‚µã‚«ãƒŠæ±‚ã‚€',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>è¶³è·¡ã®è°·ã§é¢¨åŒ–ã—ãŸçŸ³åƒã‚„éºè·¡ã«å›²ã¾ã‚Œã¦ã„ã‚‹ã¨ã€ãƒŒãƒŒã‚¾ãƒ•ãŒé€šã‚ŠãŒã‹ã£ãŸã‚ãªãŸã‚’è¦‹ã¤ã‘ã€æ°—ã•ããªæ§˜å­ã§æ‰‹ã‚’æŒ¯ã£ã¦å‘¼ã³æ­¢ã‚ã‚‹ã€‚å½¼ã¯ã€ã²ã¨ã¤ç”¨äº‹ã‚’é ¼ã¿ãŸã„ã¨åˆ‡ã‚Šå‡ºã—ã€ã‚¯ãƒ¬ã‚»ãƒ³ãƒˆã‚³ãƒ¼ãƒ´ã¾ã§ä¼è¨€ã‚’é‹ã‚“ã§ã»ã—ã„ã®ã ã¨äº‹æƒ…ã‚’èª¬æ˜ã™ã‚‹ã€‚ã©ã†ã‚„ã‚‰ãƒãƒ«ãƒ‰ã‚¦ã‚£ãƒ³éšŠé•·ãŒã€å±éª¸é¤¨ã‹ã‚‰ã‚„ã£ã¦æ¥ãŸå‘ªè¡“å£«ãŸã¡ã®ãŸã‚ã«ã•ã•ã‚„ã‹ãªå®´ã‚’å‚¬ãã†ã¨ã—ã¦ãŠã‚Šã€ãã®å¸­ã§ã¯ä¸Šç­‰ãªé…’ã¨æ–™ç†ã§ã‚‚ã¦ãªã—ãŸã„ã¨è€ƒãˆã¦ã„ã‚‹ã‚‰ã—ã„ã€‚å®¢äººãŸã‚‹å‘ªè¡“å£«ã«ã¯ã€æœ€é«˜ã®ã‚‚ã¦ãªã—ã‚’â”€â”€ãã®ãŸã‚ã«ã¯ã€æ–°é®®ãªé­šã‚’ãŸã£ã·ã‚Šã¨ç”¨æ„ã›ã­ã°ãªã‚‰ãªã„ã€‚ãƒŒãƒŒã‚¾ãƒ•ã¯ã€è¥¿ã¸ã€ãã—ã¦å—ã¸ã¨é€²ã‚“ã å…ˆã«ã‚ã‚‹æ¼æ‘ã‚¯ãƒ¬ã‚»ãƒ³ãƒˆã‚³ãƒ¼ãƒ´ã¸å‘ã‹ã„ã€ãƒ©ãƒ•ã«ã€ŒéšŠé•·ã®å®´ã®ãŸã‚ã€ãƒ›ãƒ©ã‚¤ã‚ºãƒ³ã¸å¤§é‡ã®é®®é­šã‚’å±Šã‘ã‚‹ã‚ˆã†ã«ã€ã¨ä¼ãˆã¦ã»ã—ã„ã¨é ¼ã¿è¾¼ã‚€ã®ã ã£ãŸã€‚</p>
      <p>ã‚ãªãŸã¯è¶³è·¡ã®è°·ã‚’å¾Œã«ã—ã¦ç ‚åœ°ã®é“ã‚’ãŸã©ã‚Šã€ã‚„ãŒã¦æ½®ã®åŒ‚ã„ã¨ã€å°ã•ãªèˆ¹ãŒæ‰“ã¡ä¸Šã’ã‚‰ã‚ŒãŸå…¥ã‚Šæ±Ÿã®å…‰æ™¯ãŒåºƒãŒã‚‹ã‚¯ãƒ¬ã‚»ãƒ³ãƒˆã‚³ãƒ¼ãƒ´ã¸ã¨è¾¿ã‚Šç€ãã€‚ãã“ã§å£°ã‚’ã‹ã‘ãŸãƒ©ãƒ•ã¯ã€ãƒãƒ«ãƒ‰ã‚¦ã‚£ãƒ³éšŠé•·ã®åã¨ã€Œæ–°é®®ãªé­šã‚’å¤§é‡ã«ã€ã¨ã„ã†æ³¨æ–‡ã‚’èã„ãŸé€”ç«¯ã«é¡”ã‚’å¼·å¼µã‚‰ã›ã€ã€Œã‚‚ã€ã‚‚ã¡ã‚ã‚“å…¨åŠ›ã‚’å°½ãã—ã¾ã™ã€ã¨æ…Œã¦ã¦ç­”ãˆãªãŒã‚‰ã‚‚ã€ã“ã“ã—ã°ã‚‰ãç¶šãè’ã‚ŒãŸæµ·ã®ã›ã„ã§æ¼ã®æˆæœãŒæŒ¯ã‚‹ã‚ãªã„ã®ã ã¨æ‰“ã¡æ˜ã‘ã‚‹ã€‚ã¾ã‚‚ãªãæ²–ã«å‡ºã¦ã„ã‚‹èˆ¹ãŒæˆ»ã£ã¦ãã‚‹ã¯ãšã ãŒã€ãã®æ°´æšã’ãŒéšŠé•·ã®æœŸå¾…ã«è¦‹åˆã†ã‹ã©ã†ã‹ã¯ç´„æŸã§ããªã„â”€â”€ãã‚Œã§ã‚‚ã€ãƒ©ãƒ•ã¯ä¸å®‰ã‚’æŠ¼ã—éš ã™ã‚ˆã†ã«èƒŒç­‹ã‚’ä¼¸ã°ã—ã€ã€Œãã‚Œã§ã‚‚éšŠé•·ã®é­šã¯å¿…ãšç”¨æ„ã—ã¦ã¿ã›ã¾ã™ã€ã¨åŠ›å¼·ãè¨€ã„åˆ‡ã‚‹ã€‚å³ã—ã„æµ·ã¨ä¹ã—ã„æ¼ç²ã«è‹¦ã—ã¿ãªãŒã‚‰ã‚‚ã€ã©ã†ã«ã‹æœŸå¾…ã«å¿œãˆã‚ˆã†ã¨ã™ã‚‹å°ã•ãªæ¼æ‘ã®æ±ºæ„ãŒã€å½¼ã®è¨€è‘‰ã®ç«¯ã€…ã‹ã‚‰ã«ã˜ã‚“ã§ã„ãŸã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒŒãƒŒã‚¾ãƒ•ã€€<small class="muted">è¥¿ã‚¶ãƒŠãƒ©ãƒ¼ãƒ³ (X:17.9, Y:16.0)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="following-footfalls.html">è¶³è·¡ã®è°·ã¸</a></div>
      <div class="row">ã™ã¹ã¦ï¼ˆãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ãï¼‰Lv 10ï½</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="oh-captain-my-captain.html">æ­£ç¾©ã‚’éŠ…ã®åˆƒã«å®¿ã—</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'é¢¨æš´å‰çš„é…’å®´',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>åœ¨ The Footfalls é‚£ç‰‡éå¸ƒé¢¨è•éºè·¡çš„é«˜åœ°ä¸Šï¼ŒNunuzofu æœä½ æ‹›æ‰‹ï¼ŒæŠŠä½ é€™ä½è·¯éçš„å†’éšªè€…å«åˆ°èº«é‚Šï¼Œçˆ½æœ—åœ°å•ä½ è¦ä¸è¦å¹«å¿™è·‘ä¸€è¶Ÿå·®äº‹ã€‚ä»–èªª Captain Baldewyn æ­£åœ¨æ›¿å¾ Ossuary éä¾†çš„ thaumaturges ç±Œå‚™ä¸€å ´å°å°çš„å®´æœƒï¼Œç‚ºäº†é«”é¢æ¬¾å¾…é€™äº›è²´å®¢ï¼Œé£Ÿç‰©å’Œé…’æ°´éƒ½å¾—ç”¨ä¸Šä¸Šä¹‹é¸ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ä¸€å¤§æ‰¹æ–°é®®çš„é­šã€‚ç‚ºäº†è¾¦åˆ°é€™ä»¶äº‹ï¼Œä»–å¸Œæœ›ä½ æ²¿è‘—é“è·¯å¾€è¥¿å†å¾€å—ï¼Œå‰å¾€æµ·é‚Šçš„æ¼æ‘ Crescent Coveï¼ŒæŠŠå£ä¿¡è½‰å‘Šçµ¦é‚£è£¡çš„æ¼å¤« Raffeâ”€â”€è«‹ä»–ç‚ºå³å°‡èˆ‰è¾¦çš„å®´å¸­å‚™å¦¥ã€Œbounty of fresh fishã€ï¼Œä¸¦æŠŠé€™äº›æ¼ç²é€åˆ° Horizonã€‚</p>
      <p>ä½ ç…§è‘—æŒ‡ç¤ºé›¢é–‹çŸ³è°·ï¼Œè¸ä¸Šè¦†æ»¿ç´°æ²™çš„é“è·¯ï¼Œç›´åˆ°ç©ºæ°£ä¸­é€æ¼¸å¸¶ä¸Šé¹¹å‘³ã€å²¸é‚Šæ’è‘—ä¸€è‰˜è‰˜å°èˆ¹ï¼Œå¯‚å¯¥çš„ Crescent Cove æ‰å‡ºç¾åœ¨çœ¼å‰ã€‚å‘ Raffe èªªæ˜è‡ªå·±æ˜¯å¥‰ Captain Baldewyn ä¹‹å‘½å‰ä¾†ï¼Œä¸¦è½‰é”éœ€è¦å¤§é‡æ–°é®®é­šè²¨çš„è«‹æ±‚æ™‚ï¼Œä»–é¡¯å¾—æ—¢ç·Šå¼µåˆæ…Œäº‚ï¼Œé€£è²ä¿è­‰ã€Œç•¶ç„¶ã€ç•¶ç„¶ï¼Œæˆ‘å€‘æœƒç›¡å…¨åŠ›æº–å‚™ã€ï¼Œå»ä¹Ÿä¸å¾—ä¸è€å¯¦èªªï¼Œæœ€è¿‘å› ç‚ºæµ·è±¡æƒ¡åŠ£ï¼Œæ¼ç²ä¸€ç›´æ¥è¿‘æ¯ç«­ï¼Œå°±ç®—å†éä¸€é™£å­æœƒæœ‰æ›´å¤šèˆ¹éš»å›æ¸¯ï¼Œä¹Ÿç„¡æ³•ä¿è­‰å¸¶å›ä¾†çš„é­šèƒ½è®“äººæ»¿æ„ã€‚ä¸éï¼Œä»–å¾ˆå¿«åˆæŒ¯ä½œèµ·ä¾†ï¼Œç¡¬æ˜¯æŠŠä¸å®‰åå›è‚šè£¡ï¼Œç™¼èª“ä¸ç®¡å¤šå›°é›£ï¼ŒCaptain ä¸€å®šæœƒæ‹¿åˆ°ä»–è¦çš„é­šã€‚çœ‹è‘—é€™ä½æ¼å¤«åœ¨ç²—ç³™çš„ç¢¼é ­é‚Šåè¦†ä¿è­‰çš„èƒŒå½±ï¼Œä½ ä¸é›£æƒ³åƒï¼Œé€™åº§å°æ¼æ‘æ­£ä¸€é‚Šå¿å—è²§ç˜ æµ·åŸŸçš„ç¾å¯¦ï¼Œä¸€é‚ŠåŠªåŠ›æ’èµ·åˆ¥äººçœ¼ä¸­ç†æ‰€ç•¶ç„¶çš„å®´å¸­ç´„å®šã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> åŠªåŠªä½å¤«ã€€<small class="muted">è–©ç´è˜­è¥¿éƒ¨ (X:17.9, Y:16.0)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="following-footfalls.html">è¸å°‹è¶³è·¡ä¹‹è°·</a></div>
      <div class="row">æ‰€æœ‰è·æ¥­ï¼ˆä¸å«é™å®šè·ï¼‰ ç­‰ç´š 10 ä»¥ä¸Š</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="oh-captain-my-captain.html">æ­£ç¾©è¨—ä»˜æ–¼éŠ…ä¹‹åˆƒ</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscusï¼šComments åˆ†é  === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
