<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For the Children | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – For the Children (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:1px solid transparent;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border-color:var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}

    /* Story 展開 / 收合 */
    .clamp{ position:relative; max-height:360px; overflow:hidden; }
    .clamp[data-collapsed="false"]{ max-height:none; }
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/1JWyHiOWOsQ"
              title="For the Children" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">For the Children</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"     class="tab-panel active"></div>
          <div id="panel-acq"       class="tab-panel"></div>
          <div id="panel-unlockq"   class="tab-panel"></div>
          <div id="panel-followq"   class="tab-panel"></div>
          <div id="panel-comments"  class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'For the Children',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Isembard struggles with Thancred’s suspicion. Could Sister Ourcen truly be involved? He remembers she often visits the Golden Bazaar, speaking kindly with the children. One boy in particular holds her affection. He asks you to find him, hoping his words might shed light on her activities.</p>
      <p>At the Bazaar, the boy—hair uncombed, voice trembling—tells you that Ourcen went out alone to search for a trinket he had lost: a ring left by his late mother. She has yet to return, and he fears monsters may have harmed her. You rush to the wilds and indeed sense danger. Amid the threat, you find Sister Ourcen, weary but alive. She thanks you for your timely rescue and explains she found the boy’s ring and will return it herself.</p>
      <p>Back at Camp Drybone, Isembard listens with relief. To think that Ourcen would risk her life to retrieve a memento for an orphan—this is no act of betrayal, but of compassion. He resolves to give her rest at the inn and rejects the idea that she could be guilty of the “dastardly deeds” Thancred suspects.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Isembard <small class="muted">(Eastern Thanalan, X:13.9, Y:23.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-proper-burial.html">A Proper Burial</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="amaljaa-wrong-places.html">Amalj’aa Wrong Places</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'共謀者の影',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト', comments:'コメント' },
    readMore:'全文を表示', readLess:'折りたたむ',
    story:`<div class="clamp" data-collapsed="true">
      <p>サンクレッドの疑念に、イセンバードは苦悩する。修道女オーセンが本当に関わっているのか？　彼は、オーセンがよくゴールドバザーを訪れ、子供たちに優しく接していることを思い出す。特にある少年を可愛がっていると聞き、彼女の行動を探る手がかりになるかもしれないと、あなたに調べを託す。</p>
      <p>バザーで出会った少年は、乱れた髪を震わせながら訴える。オーセンは、自分が失くした大切な指輪を探しに一人で出かけ、そのまま戻らないという。母の形見の指輪を探してくれると言ったのだ。あなたは急ぎ野外へ向かい、やがて迫る魔物の気配を感じる。その場にいたのは傷を負いながらも無事なオーセンだった。間一髪の救出に感謝しつつ、彼女は指輪を見つけ、必ず少年に返すと語る。</p>
      <p>キャンプ・ドライボーンに戻ると、イセンバードは胸を撫で下ろす。孤児のために命を懸けてまで探し物をするなど、裏切りではなく慈愛の証であると確信する。彼はオーセンに宿を手配し、サンクレッドの疑いを強く否定した。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> イセンバード <small class="muted">（東ザナラーン, X:13.9, Y:23.6）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-proper-burial.html">すがりし光は</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="amaljaa-wrong-places.html">虚ろな富の行方</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'為了孩子們',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務', comments:'留言' },
    readMore:'展開全文', readLess:'收合內容',
    story:`<div class="clamp" data-collapsed="true">
      <p>面對 Thancred 的懷疑，Isembard 心中掙扎。Sister Ourcen 真的會涉入其中嗎？他想起她經常獨自前往 Golden Bazaar，總是耐心地陪孩子們說話，尤其對某個男孩特別關心。於是他請你去找那孩子，或許能從他的話語中找到線索。</p>
      <p>在 Bazaar，你遇見那個頭髮凌亂的孩子。他緊張地告訴你，Ourcen 為了幫他尋找遺失的寶物而獨自外出，至今未歸。那是一枚母親過世前留給他的戒指，他擔心她會被外頭的怪物所傷。你立刻趕往荒野，果然感受到敵意的氣息。在危機之中，你發現了 Ourcen，她因疲憊而顯得虛弱，但仍安然無恙。她感謝你及時的援助，並說自己已經找到了那枚戒指，會親手歸還給孩子。</p>
      <p>回到 Camp Drybone，Isembard 得知後鬆了一口氣。為了孤兒的念想，她寧願冒險將自己置於危險之中──這怎麼會是背叛？分明是出自慈悲與善意的行為。他決定為 Ourcen 安排休養之處，並斷然否定了 Thancred 的懷疑。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 伊森巴德 <small class="muted">（薩納蘭東部, X:13.9, Y:23.6）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-proper-burial.html">在光中得以安息</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="amaljaa-wrong-places.html">失落之財的去向</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments:document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }

function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  const setLabel = ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  };
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if(key === 'story')   wireClamp(panels[key], t);
  if(key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscus：Comments 分頁 === */
const GISCUS_CFG = {
      repo: 'BELAUG-FFXIV/FFXIV_Library',
      repoId: 'R_kgDOPyh4Kw',
      category: 'General',
      categoryId: 'DIC_kwDOPyh4K84CwPjL',
      theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + '｜' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
