<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Step Nine | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Step Nine (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}

    /* å±•é–‹/æ”¶åˆ */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/RkgVkXBKdzI"
              title="Step Nine" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Step Nine</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"    class="tab-panel active"></div>
          <div id="panel-acq"      class="tab-panel"></div>
          <div id="panel-unlockq"  class="tab-panel"></div>
          <div id="panel-followq"  class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Step Nine',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Youâ€™re approached by Cicidoa, a man eager to repay an old favor. Heâ€™s purchased a plump pumpkin from the Royal Plantationsâ€”no ordinary fruit, but a prized harvest grown for the cityâ€™s elite. Yet, duty holds him in place, and so he asks you to retrieve it and deliver it to Roger, owner of the Coffer & Coffin.</p>
      <p>At the Royal Plantations, Gagari entrusts you with the grand gourd, praising its quality and freshness. With pumpkin in hand, you make your way westward, crossing the bridge to where miners and laborers take their rest.</p>
      <p>Roger receives it with unexpected warmth. Cicidoaâ€™s gesture clearly stirs a memoryâ€”one of loyalty, drink, and past regrets. More than that, the pumpkin promises a change in diet for his hard-working patrons. In your hands, a simple vegetable becomes a bridgeâ€”between friends, between past and present.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Cicidoa <small class="muted">(Central Thanalan, X:23.1, Y:27.7)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="underneath-the-sultantree.html">Underneath the Sultantree</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="prudence-at-this-junction.html">Prudence at This Junction</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'å¾¡ç¤¼å“ã¯äºˆç´„å“',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ã‚ãªãŸã«å£°ã‚’ã‹ã‘ã¦ããŸã®ã¯ã€ãƒã‚·ãƒ‰ã‚¢ã¨ã„ã†ç”·ã ã£ãŸã€‚å½¼ã¯ã€Œã‚³ãƒ•ã‚¡ãƒ¼ï¼†ã‚³ãƒ•ã‚£ãƒ³ã€ã®åº—ä¸»ã«æ©è¿”ã—ã‚’ã—ãŸã„ã¨è¨€ã„ã€ç‹å®¤è¾²å ´ã‹ã‚‰ç‰¹åˆ¥ã«è‚²ã¦ã‚‰ã‚ŒãŸç«‹æ´¾ãªã‚«ãƒœãƒãƒ£ã‚’è³¼å…¥ã—ãŸã¨ã„ã†ã€‚ã—ã‹ã—ã€é‰±å±±ã‹ã‚‰ã®è·ã®åˆ°ç€ã‚’å¾…ã£ã¦ã„ã¦ã€èº«å‹•ããŒå–ã‚Œãªã„ãŸã‚ã€ä»£ã‚ã‚Šã«å±Šã‘ã¦ã»ã—ã„ã¨é ¼ã¾ã‚Œã‚‹ã€‚</p>
      <p>ç‹å®¤è¾²å ´ã«èµ´ãã¨ã€ã‚¬ã‚¬ãƒªãŒã‚ãªãŸã«ç«‹æ´¾ãªã‚«ãƒœãƒãƒ£ã‚’æ‰‹æ¸¡ã™ã€‚ãã®é®®åº¦ã¨å“è³ªã¯æŠ˜ã‚Šç´™ä»˜ãã ã€‚ã‚ãªãŸã¯è¥¿ã¸å‘ã‹ã„ã€æ©‹ã‚’è¶Šãˆã¦ã€åŠ´åƒè€…ãŸã¡ãŒä¼‘æ¯ã‚’ã¨ã‚‹ã€Œã‚³ãƒ•ã‚¡ãƒ¼ï¼†ã‚³ãƒ•ã‚£ãƒ³ã€ã¸ã¨å‘ã‹ã†ã€‚</p>
      <p>åº—ä¸»ãƒ­ã‚¸ãƒ£ãƒ¼ã¯é©šãã¤ã¤ã‚‚ã€ã‚«ãƒœãƒãƒ£ã‚’å—ã‘å–ã‚‹ã€‚ãƒã‚·ãƒ‰ã‚¢ã®åã‚’èãã¨ã€ã©ã†ã‚„ã‚‰æ˜”ã®é…’ã®å¸­ã§ã®æ©ã‚’æ€ã„å‡ºã—ãŸã‚‰ã—ã„ã€‚ãã—ã¦ã€ã“ã®é‡èœãŒã€è‚‰ã°ã‹ã‚Šé£Ÿã¹ã¦ä¸å¥åº·ã«ãªã‚ŠãŒã¡ãªåº—ã®å¸¸é€£ãŸã¡ã«ã€å°‘ã—ã§ã‚‚å¥åº·çš„ãªé£Ÿäº‹ã‚’ã‚‚ãŸã‚‰ã™ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ã‚ˆã†ã ã€‚ã‚ãªãŸã®æ‰‹ã‚’é€šã˜ã¦å±Šã‘ã‚‰ã‚ŒãŸä¸€ã¤ã®ã‚«ãƒœãƒãƒ£ãŒã€å‹æƒ…ã¨å¤‰åŒ–ã®å…†ã—ã‚’é‹ã‚“ã ã®ã ã£ãŸã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ã‚·ã‚·ãƒ‰ã‚¢ <small class="muted">ï¼ˆä¸­å¤®ã‚¶ãƒŠãƒ©ãƒ¼ãƒ³, X:23.1, Y:27.7ï¼‰</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="underneath-the-sultantree.html">ã‚µã‚µã‚¬ãƒ³å¤§ç‹æ¨¹ã®ä¸‹ã§</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="prudence-at-this-junction.html">æˆ¦å ´ã®å‚™ãˆ</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'é ç´„ä¸­çš„è¬ç¦®',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>Cicidoa æ‰¾ä¸Šäº†ä½ ï¼Œä¸€åèª å¿ƒæƒ³è¦å ±æ©çš„ç”·å­ã€‚ä»–ç‰¹åœ°å¾ Royal Plantations è³¼è²·äº†ä¸€é¡†é ‚ç´šå—ç“œï¼Œæº–å‚™é€çµ¦ Coffer & Coffin çš„è€é—† Rogerï¼Œä»¥ç­”è¬ä»–éå»çš„æ©æƒ…ã€‚ä½†ç¤™æ–¼ä»–å¿…é ˆç­‰å€™ä¾†è‡ª Nanawa Mines çš„å»¶é²è²¨ç‰©ï¼Œåªèƒ½è«‹ä½ ä»£ç‚ºå–è²¨èˆ‡è½‰äº¤ã€‚</p>
      <p>ä½ ä¾†åˆ° Royal Plantationsï¼ŒGagari æ¬£ç„¶å°‡å—ç“œäº¤çµ¦ä½ ã€‚é€™é¡†å—ç“œå¯ä¸æ˜¯å°‹å¸¸ä½œç‰©ï¼Œè€Œæ˜¯é€£é¥•å®¢éƒ½æœƒè®šå˜†çš„çå“ã€‚å¸¶è‘—å—ç“œï¼Œä½ è¸ä¸Šå‰å¾€ Coffer & Coffin çš„è·¯é€”ï¼Œç©¿éæ©‹æ¢ï¼Œä¾†åˆ°å‹å·¥èšé›†ä¹‹åœ°ã€‚</p>
      <p>Roger æ”¶ä¸‹å—ç“œå¾Œéœ²å‡ºé›£å¾—çš„ç¬‘å®¹ã€‚ä»–æèµ· Cicidoa æ›¾å› å–é†‰è¢«ä»–é€å›å®¶çš„å¾€äº‹ï¼Œèªæ°£ä¸­æ—¢æœ‰æ‡·å¿µï¼Œä¹Ÿæœ‰æ„Ÿæ…¨ã€‚è€Œé€™é¡†å—ç“œï¼Œä¸åªæ˜¯æ„Ÿæ©çš„è±¡å¾µï¼Œä¹Ÿæˆäº†ä»–ç‚ºé¡§å®¢æ”¹å–„é£²é£Ÿçš„ä¸€ç·šå¸Œæœ›ã€‚ä½ é»˜é»˜å®Œæˆäº†ä»»å‹™ï¼Œå»ä¹Ÿè®“ä¸€æ®µå‹æƒ…èˆ‡å¥åº·çš„æ–°èµ·é»æ‚„ç„¶å±•é–‹ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> è¥¿è¥¿å¤šäº <small class="muted">ï¼ˆè–©ç´è˜­ä¸­éƒ¨, X:23.1, Y:27.7ï¼‰</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="underneath-the-sultantree.html">è˜‡ä¸¹ç‹æ¨¹ä¸‹</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="prudence-at-this-junction.html">è‡¨æˆ°çš„æˆ’å‚™</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscusï¼šComments åˆ†é  === */
const GISCUS_CFG = {
      repo: 'BELAUG-FFXIV/FFXIV_Library',
      repoId: 'R_kgDOPyh4Kw',
      category: 'General',
      categoryId: 'DIC_kwDOPyh4K84CwPjL',
      theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
