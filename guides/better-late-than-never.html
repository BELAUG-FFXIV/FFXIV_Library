<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Better Late than Never | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Better Late than Never (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/0zWnTo3oMLA"
              title="Better Late than Never" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="hd" id="pageTitle">Better Late than Never</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Better Late than Never',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>You catch Hedyn at the last moment, and he startles as if he has only just remembered something important. With an awkward apology, he hurriedly returns the crystal to youâ€”admitting he nearly let it slip his mindâ€”then adds that Professor Lamberteint also left a message. It mentioned a man named Marques, and something about the professor missing the â€œintellectual stimulation,â€ but Hedyn confesses he failed to write the details down and can only offer the gist.</p>
      <p>As he talks, another thought strikes him: he never actually asked what you needed the crystal for. A note of caution creeps into his voice as he wonders aloud whether you intend anything nefariousâ€”because if the crystal were used for evil ends, it would cast a shadow over him and his research as well.</p>
      <p>But the suspicion doesnâ€™t last. Hedyn quickly decides that ignorance is safer, and he retreats behind the logic that made him the professorâ€™s greatest pupil: he did not get there by cluttering his head with information he didnâ€™t strictly need. With that, he leaves you with the crystal and no further questions, letting you go.</p>
      <p>When you reach the airship landing in New Gridania, Lionnellais greets you with practiced courtesy and asks whether you wish to proceed to your vessel, as if the world is continuing on its ordinary rhythm while you carry something far from ordinary in your hands.</p>
      <p>Cid is already there, all focus and momentum. He tells you the repairs and modifications are complete, and that once you bring him the crystal, nothing will stand between the two of you and Garuda.</p>
      <p>He takes the crystal and studies it with a professional eye, saying he will still run tests to be sureâ€”but everything about it suggests it is exactly what you need. He promises your hard work will not be wasted, then looks beyond the immediate task to what comes next: the Enterprise is already more than a common airship, and soon it will become something greaterâ€”something extraordinary. The conviction turns personal, and he states it plainly: this is who he is, and this is what he was born to do.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Hedyn <small class="muted">Old Gridania (X:8.7, Y:8.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="the-curious-case-of-giggity.html">The Curious Case of Giggity</a></div>
      <div class="row">All classes and jobs (excluding limited jobs) (Level 43 or above)</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="lady-of-the-vortex.html">Lady of the Vortex</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'å§‹å‹•ï¼ ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ãƒ˜ãƒ‡ã‚£ãƒ³ã¯ã€ã‚ãªãŸã«å‘¼ã³æ­¢ã‚ã‚‰ã‚Œã¦ã¯ã£ã¨ã—ã€ã—ã¾ã£ãŸã¨ã„ã†é¡”ã§é ­ã‚’ä¸‹ã’ã‚‹ã€‚æ¸¡ã™ã¹ãçµæ™¶ã‚’è¿”ã—å¿˜ã‚Œã¦ã„ãŸã‚‰ã—ãã€ã‚ã‚ã¦ã¦ã‚ãªãŸã®æ‰‹ã¸æ±šæŸ“ã•ã‚ŒãŸã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚’æˆ»ã™ã¨ã€ç¶šã‘ã¦ãƒ©ãƒ³ãƒ™ãƒ«ãƒ†ã‚¤ãƒ³ãƒˆæ•™æˆã‹ã‚‰ã®ä¼è¨€ãŒã‚ã‚‹ã¨è¨€ã†ã€‚ãƒãƒ«ã‚±ã‚ºã¨ã„ã†ç”·ã®åãŒå‡ºã¦ã€æ•™æˆãŒã€ŒçŸ¥çš„ãªåˆºæ¿€ã€ã‚’æ‹ã—ãŒã£ã¦ã„ã‚‹ã€ãã‚“ãªè¶£æ—¨ã ã£ãŸã‚‰ã—ã„ãŒã€ãƒ˜ãƒ‡ã‚£ãƒ³ã¯æ›¸ãç•™ã‚ã¦ã„ãªã‹ã£ãŸã“ã¨ã‚’è©«ã³ã€æ›–æ˜§ãªå†…å®¹ã—ã‹ä¼ãˆã‚‰ã‚Œãªã„ã¨èªã‚ã‚‹ã€‚</p>
      <p>è©±ã—ãªãŒã‚‰ã€ãƒ˜ãƒ‡ã‚£ãƒ³ã¯ä»Šã•ã‚‰ä¸€ã¤ã®ç–‘å•ã«è¡Œãå½“ãŸã‚‹ã€‚ã‚ãªãŸã¯ãªãœãã®çµæ™¶ã‚’å¿…è¦ã¨ã—ã¦ã„ã‚‹ã®ã‹ã€‚å½¼ã¯ç”¨å¿ƒæ·±ãã€é‚ªãªç›®çš„ã§ã¯ãªã„ã ã‚ã†ãªã€ã¨æ¢ã‚‹ã‚ˆã†ã«è¨€ã†ã€‚ã‚‚ã—æ‚ªã—ãç”¨é€”ã«ä½¿ã‚ã‚Œã‚Œã°ã€è‡ªåˆ†ã¨ç ”ç©¶ã®åã«ã‚‚å‚·ãŒã¤ãã®ã ã€ã¨ã€‚</p>
      <p>ã ãŒãã®è­¦æˆ’ã¯ã™ãã«å¼•ã£è¾¼ã‚ã‚‰ã‚Œã‚‹ã€‚ãƒ˜ãƒ‡ã‚£ãƒ³ã¯ã€çŸ¥ã‚‰ã¬ãŒå‰ã ã¨è‡ªåˆ†ã§çµè«–ã¥ã‘ã€ä½™è¨ˆãªæƒ…å ±ã§é ­ã‚’æº€ãŸã•ãªã„ã‹ã‚‰ã“ãæ•™æˆã®æœ€å¤§ã®å¼Ÿå­ã«ãªã‚ŒãŸã®ã ã€ã¨è¨€ã£ã¦è©±ã‚’åˆ‡ã‚Šä¸Šã’ã‚‹ã€‚ãã—ã¦çµæ™¶ã‚’ã‚ãªãŸã«è¨—ã—ãŸã¾ã¾ã€ã“ã‚Œä»¥ä¸Šã¯è¸ã¿è¾¼ã¾ãšã«é€ã‚Šå‡ºã™ã€‚</p>
      <p>ã‚°ãƒªãƒ€ãƒ‹ã‚¢æ–°å¸‚è¡—ã®é£›ç©ºè‰‡ç™ºç€å ´ã¸å‘ã‹ã†ã¨ã€ãƒªã‚ªãƒãƒ«ãƒ¬ãŒæ…‡æ‡ƒã«æŒ¨æ‹¶ã—ã€ã‚ãªãŸã«èˆ¹ã¸é€²ã‚€ã‹ã©ã†ã‹ã‚’ç¢ºã‹ã‚ã‚‹ã€‚å‘¨å›²ã¯å¹³ç©ãã®ã‚‚ã®ã§ã€ã‚ãªãŸã®æ‰‹ã®ä¸­ã®çµæ™¶ã ã‘ãŒç•°è³ªãªé‡ã¿ã‚’æŒã£ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ã ã€‚</p>
      <p>ãã“ã«ã¯ã‚·ãƒ‰ãŒå¾…ã£ã¦ãŠã‚Šã€ä¿®ç†ã¨æ”¹ä¿®ã¯ã™ã¹ã¦å®Œäº†ã—ãŸã¨å‘Šã’ã‚‹ã€‚ã‚ã¨ã¯ãã®çµæ™¶ã‚’æŒã£ã¦æ¥ã‚Œã°ã€ã‚ãªãŸã¨å½¼ã‚’ã‚¬ãƒ«ãƒ¼ãƒ€ã¸å‘ã‹ã‚ã›ã‚‹éšœå®³ã¯ä½•ã‚‚æ®‹ã‚‰ãªã„â€•â€•å½¼ã¯è¿·ã„ãªãè¨€ã„åˆ‡ã‚‹ã€‚</p>
      <p>ã‚·ãƒ‰ã¯çµæ™¶ã‚’å—ã‘å–ã‚Šã€å¿µã®ãŸã‚è©¦é¨“ã¯å¿…è¦ã ã¨è¨€ã„æ·»ãˆã¤ã¤ã‚‚ã€ã“ã‚Œã¯ã¾ã•ã—ãå¿…è¦ãªã‚‚ã®ã ã¨è¦‹ã¦å–ã‚‹ã€‚ã‚ãªãŸã®åŠ´ã¯ç„¡é§„ã«ã—ãªã„ã¨ç´„æŸã—ã€ã•ã‚‰ã«ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå·ã¯ã™ã§ã«ãŸã ã®é£›ç©ºè‰‡ã§ã¯ãªã„ã€ã‚„ãŒã¦ã‚‚ã£ã¨å‰å¤§ã§ä¸¦å¤–ã‚ŒãŸå­˜åœ¨ã«ãªã‚‹ã®ã ã¨èªã‚‹ã€‚ãã®ç¢ºä¿¡ã¯æ¬¡ç¬¬ã«å½¼è‡ªèº«ã®è¨€è‘‰ã¸å¤‰ã‚ã‚Šã€ã“ã‚Œã¯è‡ªåˆ†ã§ã‚ã‚Šã€è‡ªåˆ†ãŒç”Ÿã¾ã‚ŒãŸç†ç”±ãã®ã‚‚ã®ã ã¨ã€å¼·ãè¨€ã„åˆ‡ã£ãŸã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒ˜ãƒ‡ã‚£ãƒ³ã€€<small class="muted">ã‚°ãƒªãƒ€ãƒ‹ã‚¢ï¼šæ—§å¸‚è¡— (X:8.7, Y:8.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="the-curious-case-of-giggity.html">æœ€å¾Œã®åå±æ€§ã‚¯ãƒªã‚¹ã‚¿ãƒ«</a></div>
      <div class="row">ã™ã¹ã¦ï¼ˆãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ãï¼‰Lv 43ï½</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="lady-of-the-vortex.html">æš´è™ã®åµç¥ã‚¬ãƒ«ãƒ¼ãƒ€</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'é²ä¾†ç¸½æ¯”ä¸åˆ°å¥½ï¼Œã€ŒEnterpriseã€çµ‚æ–¼å•Ÿå‹•',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>ä½ æ‰å‰›è¦é›¢é–‹ï¼ŒHedyn å°±åƒå¿½ç„¶æƒ³èµ·ä»€éº¼ä¼¼çš„ï¼Œæ€¥å¿™æŠŠä½ å«ä½ï¼Œé€£è²é“æ­‰èªªè‡ªå·±å·®é»å¿˜äº†æŠŠ crystal é‚„çµ¦ä½ ã€‚ä»–æŠŠé‚£é¡†ä½ è¾›è‹¦å¾—ä¾†çš„æ™¶é«”å¡å›ä½ æ‰‹è£¡ï¼Œæ¥è‘—åˆè£œä¸Šä¸€å¥ï¼šProfessor Lamberteint ä¹Ÿæœ‰è©±è¦è½‰é”ã€‚è¨Šæ¯è£¡ä¼¼ä¹æåˆ°ä¸€å€‹å« Marques çš„ç”·äººï¼Œé‚„èªªæ•™æˆæœ€è¿‘æƒ³å¿µé‚£ç¨®ã€Œæ™ºè­˜ä¸Šçš„åˆºæ¿€ã€â€”â€”ä½† Hedyn å¦ç™½è‡ªå·±æ²’æŠŠå…§å®¹è¨˜ä¸‹ä¾†ï¼Œåªèƒ½æŠŠè¨˜å¾—çš„éƒ¨åˆ†å‹‰å¼·èªªçµ¦ä½ è½ã€‚</p>
      <p>èªªè‘—èªªè‘—ï¼ŒHedyn æ‰æ„è­˜åˆ°è‡ªå·±ä¸€ç›´æ²’å•ï¼šä½ ç©¶ç«Ÿç‚ºä»€éº¼éœ€è¦é€™é¡† corrupted crystalï¼Ÿä»–èªæ°£ä¸€ç·Šï¼Œå¸¶è‘—å¯©è¦–çš„æˆ’å¿ƒè©¦æ¢ä½ ï¼Œå•ä½ è©²ä¸æœƒæ‰“ç®—æ‹¿å®ƒå»åšä»€éº¼ä¸æ­£ç•¶çš„äº‹å§ï¼›è¦æ˜¯å®ƒè¢«ç”¨åœ¨é‚ªæƒ¡çš„ç›®çš„ä¸Šï¼Œä¸Ÿè‡‰çš„ä¸åªæ˜¯ä½ ï¼Œä¹Ÿæœƒé€£å¸¶è®“ä»–çš„ç ”ç©¶è’™ä¸Šæ±¡é»ã€‚</p>
      <p>ç„¶è€Œé€™ä»½è­¦æˆ’å¾ˆå¿«å°±è¢«ä»–è‡ªå·±æ”¶èµ·ã€‚Hedyn åƒæ˜¯åˆ»æ„æŠŠé‚£é“é–€é—œä¸Šï¼Œèªªæˆ–è¨±ä»–æœ€å¥½ä¿æŒç„¡çŸ¥â€”â€”ä»–ä¹‹æ‰€ä»¥èƒ½æˆç‚ºæ•™æˆæœ€å¾—æ„çš„å¼Ÿå­ï¼Œæ­£æ˜¯å› ç‚ºä¸æŠŠä¸å¿…è¦çš„è³‡è¨Šå¡é€²è…¦è¢‹è£¡ã€‚æ–¼æ˜¯ä»–ä¸å†è¿½å•ï¼Œåªè®“ä½ å¸¶è‘— crystal é›¢é–‹ã€‚</p>
      <p>ä½ æŠµé” New Gridania çš„é£›ç©ºè‰‡èµ·é™å ´æ™‚ï¼ŒLionnellais ä¾èˆŠä»¥ä¸€è²«çš„ç¦®ç¯€å‘ä½ è‡´æ„ï¼Œè©¢å•ä½ æ˜¯å¦è¦å‰å¾€ä½ çš„èˆ¹è‰¦ã€‚å››å‘¨çš„ä¸€åˆ‡çœ‹èµ·ä¾†éƒ½å¾ˆå°‹å¸¸ï¼Œå½·å½¿åªæœ‰ä½ æ‰‹è£¡é‚£é¡†æ™¶é«”ä»åœ¨æé†’ä½ ï¼Œæ¥ä¸‹ä¾†è¦åšçš„äº‹ä¸¦ä¸å°‹å¸¸ã€‚</p>
      <p>Cid å·²ç¶“åœ¨é‚£è£¡ç­‰è‘—ä½ ã€‚ä»–å‘Šè¨´ä½ ï¼Œæ‰€æœ‰ä¿®ç†èˆ‡æ”¹è£éƒ½å·²å®Œæˆâ€”â€”åªè¦ä½ æŠŠ crystal äº¤çµ¦ä»–ï¼Œä½ å€‘å°±å†ä¹Ÿæ²’æœ‰ä»»ä½•é˜»ç¤™ï¼Œèƒ½å¤ ç›´é¢ Garudaã€‚</p>
      <p>Cid æ¥é crystalï¼Œä»ä»¥è¬¹æ…çš„å£å»èªªéœ€è¦å†åšæ¸¬è©¦æ‰èƒ½å®Œå…¨ç¢ºèªï¼Œä½†ä»–ä¸€çœ¼å°±çœ‹å‡ºå®ƒå¾ˆå¯èƒ½æ­£æ˜¯ä½ å€‘éœ€è¦çš„æ±è¥¿ã€‚ä»–è¦ä½ æ”¾å¿ƒï¼Œä¿è­‰ä½ çš„åŠªåŠ›ä¸æœƒç™½è²»ã€‚éš¨å¾Œä»–çš„ç›®å…‰è¶Šéçœ¼å‰çš„å·¥ä½œï¼Œè½åˆ°æ›´é çš„åœ°æ–¹ï¼šEnterprise æ—©å·²ä¸æ˜¯æ™®é€šçš„é£›ç©ºè‰‡ï¼Œå¾ˆå¿«å°±æœƒæˆç‚ºæ›´å‰å¤§ã€æ›´éå‡¡çš„å­˜åœ¨ã€‚é‚£ä»½ç¯¤å®šåƒæ˜¯å¾ä»–å¿ƒåº•æ¹§ä¸Šä¾†ï¼Œä»–èªªå¾—å¾ˆç›´æ¥â€”â€”é€™å°±æ˜¯ä»–è‡ªå·±ï¼Œé€™å°±æ˜¯ä»–ç”Ÿä¾†è¦åšçš„äº‹ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> èµ«ä¸ã€€<small class="muted">èˆŠæ ¼é‡Œé”å°¼äº (X:8.7, Y:8.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="the-curious-case-of-giggity.html">è¿½æŸ¥ Giggity é›¢å¥‡æ€ªæ¡ˆï¼Œå°‹å¾—æœ€å¾Œçš„åå±¬æ€§æ°´æ™¶</a></div>
      <div class="row">æ‰€æœ‰è·æ¥­ï¼ˆä¸å«é™å®šè·ï¼‰ ç­‰ç´š 43 ä»¥ä¸Š</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="lady-of-the-vortex.html">æš´é¢¨å¥³ç‹ Garuda ç¾èº«ï¼Œæš´è™å¸­æ²è€Œä¾†</a></div>
    </div>`
  }
};

const tabBtns = [...document.querySelectorAll('.tab-btn')];
const pageTitle = document.getElementById('pageTitle');
const langToggle = document.getElementById('langToggle');
const panels = {
  story: document.getElementById('panel-story'),
  acq: document.getElementById('panel-acq'),
  unlockq: document.getElementById('panel-unlockq'),
  followq: document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem('ffxiv-guide-lang') || 'EN'; }

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem('ffxiv-guide-lang', next);
  applyLang(next);
});

applyLang(getLang());

const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
