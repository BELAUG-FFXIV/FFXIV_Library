<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Dusk Vigil | BELAUG · FFXIV Library</title>
  <meta name="description" content="FFXIV HW 3.0 Dungeon — The Dusk Vigil：故事概要、需求條件、解鎖任務與後續任務，附影片。">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#ffffff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif; background:var(--bg); color:var(--fg);}
    .container{max-width:1080px; margin:0 auto; padding:0 16px}
    .site-header{border-bottom:1px solid var(--border); background:#fff9edb3; backdrop-filter:saturate(120%) blur(6px); position:sticky; top:0; z-index:10}
    .nav{display:flex; align-items:center; justify-content:space-between; height:60px}
    .left{display:flex; align-items:center; gap:12px}
    .home{border:1px solid var(--border); background:#fff; padding:4px 8px; border-radius:8px; text-decoration:none; color:var(--fg); font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex; align-items:center; gap:8px}
    .icon-btn{background:none; border:none; cursor:pointer; font-size:14px; padding:6px 10px; border-radius:8px}
    .icon-btn:hover{background:#fff; border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid; grid-template-columns:1.1fr 1fr; gap:20px; align-items:start;}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} .video-wrap{position:relative; padding-top:56.25%} .video-wrap iframe{position:absolute; inset:0; width:100%; height:100%} }
    .card{background:var(--card); border:1px solid var(--border); border-radius:16px; box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px; border-bottom:1px solid var(--border); font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%; height:420px; border:0; display:block; border-radius:16px}
    .tabs{display:flex; gap:8px; padding:12px 12px 0; flex-wrap:wrap}
    .tab-btn{background:#fff; border:1px solid var(--border); color:var(--fg); border-radius:999px; padding:8px 14px; cursor:pointer; font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent); color:#fff; background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex; flex-direction:column; gap:10px}
    .stack .row{padding:12px 14px; border:1px dashed var(--border); border-radius:12px; background:#fffdf6}
    .muted{color:var(--muted)}
    .link{color:#0b60d8; text-decoration:none}
    .link:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/NTB1exidObI" title="The Dusk Vigil" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">The Dusk Vigil</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true" data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="req">Requirements</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlock">Follow-Up Quest</button>
        </div>
        <div class="bd">
          <div id="panel-story" class="tab-panel active"></div>
          <div id="panel-acq" class="tab-panel"></div>
          <div id="panel-req" class="tab-panel"></div>
          <div id="panel-unlock" class="tab-panel"></div>
        </div>
      </section>
    </div>
  </main>

  <script>
    const LANG_KEY = 'ffxiv-guide-lang';

    const i18n = {
      EN:{
        langLabel:'EN',
        pageTitle:'The Dusk Vigil',
        tabs:{story:'Story',req:'Requirements',acq:'Unlock Quest',unlock:'Follow-Up Quest'},
        story:`<p>In the days following the Calamity, western Coerthas was abandoned by the knights of Ishgard, save for the Dusk Vigil, whose defenders refused to withdraw. Since then, the fortress has only fallen further into disrepair, and her garrison has long since been presumed dead. Unlike most Ishgardians, who would sooner put the tragic episode behind them, Father Wealdtheow would have you enter the forsaken fortress and reclaim a priceless treasure: an ice rondel set in the helm of a sculpture within the Vigil’s chapel. A simple request, perhaps, but if experience has taught you anything, such tasks are anything but…</p>`,
        req:`<div class="stack">
          <div class="row">1 to 4 players (1 Tank, 1 Healer, 2 DPS)</div>
          <div class="row">Class: Disciples of War or Magic</div>
          <div class="row">※ Limited jobs can participate only in a preformed party meeting party size requirements or an unrestricted party, and if duty rules allow.</div>
          <div class="row">Level: 51 (Sync from 52)</div>
          <div class="row">Average Item Level: 100</div>
          <div class="row">※ While synced, all item stats are adjusted.</div>
          <div class="row">※ Role and item level restrictions are lifted for parties meeting minimum size requirements.</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="../guides/sounding-out-the-amphitheatre.html">Sounding Out the Amphitheatre</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row"><a class="link" href="../guides/for-all-the-nights-to-come.html">For All the Nights to Come</a></div>
        </div>`
      },

      JP:{
        langLabel:'JP',
        pageTitle:'廃砦捜索 ダスクヴィジル',
        tabs:{story:'ストーリー',req:'必要条件',acq:'開放クエスト',unlock:'後続クエスト'},
        story:`<p>第七霊災の後、クルザス西部はイシュガルドの騎士たちによって放棄された。ただし、撤退を拒んだ「ダスクヴィジル」の守備隊だけはその場に留まったという。以来、要塞は荒れ果て、守備兵たちもすでに全滅したものと長らく考えられてきた。 多くのイシュガルド民がこの悲劇を忘れ去ろうとする中、神父ウェアルズセオウは、あなたに廃墟と化した要塞へと足を踏み入れ、「ヴィジル礼拝堂」の像に埋め込まれた宝──氷のロンデルを取り戻してほしいと依頼する。一見簡単な願いに思えるかもしれないが、数々の経験があなたに教えてきたはずだ……このような任務が決して容易ではないことを。</p>`,
        req:`<div class="stack">
          <div class="row">1～4人用（タンク1／ヒーラー1／DPS2）</div>
          <div class="row">参加条件：ファイター／ソーサラー</div>
          <div class="row">※ パーティ人数の条件を満たす事前結成パーティ、または制限解除パーティで、かつコンテンツルールで許可されている場合のみ、リミテッドジョブも参加可能です。</div>
          <div class="row">レベル：51（シンク：52）</div>
          <div class="row">平均アイテムレベル：100</div>
          <div class="row">※ シンク中はすべてのアイテムステータスが調整されます。</div>
          <div class="row">※ 最低人数を満たすパーティでは、ロールおよびアイテムレベルの制限が解除されます。</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="../guides/sounding-out-the-amphitheatre.html">円形劇場の激闘</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row"><a class="link" href="../guides/for-all-the-nights-to-come.html">廃砦捜索 ダスクヴィジル</a></div>
        </div>`
      },

      ZH:{
        langLabel:'ZH',
        pageTitle:'暮衛堡',
        tabs:{story:'故事概要',req:'需求條件',acq:'解鎖任務',unlock:'後續任務'},
        story:`<p>大災變之後，Ishgard 騎士放棄了 Coerthas 西部的守護，唯有 Dusk Vigil 的防禦者拒絕撤退。自那時起，堡壘便日益殘破，而其守軍也早已被認定為全數殞落。 大多數 Ishgard 人寧可將這段悲劇拋諸腦後，但 Father Wealdtheow 卻請你踏入這座被遺棄的要塞，尋回一件無價之寶──鑲嵌在 Vigil 禮拜堂雕像頭盔上的冰之 rondel。或許聽來簡單，但若經驗教會過你什麼，那便是此類任務絕不會如此單純……。</p>`,
        req:`<div class="stack">
          <div class="row">1–4 人（1 坦克、1 治療、2 輸出）</div>
          <div class="row">職業：戰鬥職業</div>
          <div class="row">※ 僅限滿足隊伍人數需求的預組隊伍，或在允許的情況下使用無限制隊伍時，限制職業才可參加。</div>
          <div class="row">等級：51（同步 52）</div>
          <div class="row">平均物品等級：100</div>
          <div class="row">※ 同步時，所有裝備屬性將被調整。</div>
          <div class="row">※ 當隊伍滿足最低人數時，角色定位與裝備等級限制將被解除。</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="../guides/sounding-out-the-amphitheatre.html">圓形劇場的激戰</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row"><a class="link" href="../guides/for-all-the-nights-to-come.html">永夜將臨</a></div>
        </div>`
      }
    };

    const langToggle = document.getElementById('langToggle');
    const pageTitle  = document.getElementById('pageTitle');
    const tabBtns    = [...document.querySelectorAll('.tab-btn')];
    const panels = {
      story : document.getElementById('panel-story'),
      acq   : document.getElementById('panel-acq'),
      req   : document.getElementById('panel-req'),
      unlock: document.getElementById('panel-unlock')
    };

    function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
    function applyLang(lang){
      const t = i18n[lang] || i18n.EN;
      pageTitle.textContent = t.pageTitle;
      langToggle.textContent = `🌐 ${t.langLabel}`;
      tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
      const activeBtn = tabBtns.find(b=>b.getAttribute('aria-selected')==='true') || tabBtns[0];
      renderPanel(activeBtn.dataset.tab, lang);
    }

    function renderPanel(key, lang){
      const t = i18n[lang] || i18n.EN;
      Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
      panels[key].classList.add('active');
      panels[key].innerHTML = t[key];
    }

    tabBtns.forEach(btn=>{
      btn.addEventListener('click',()=>{
        tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
        btn.setAttribute('aria-selected','true');
        renderPanel(btn.dataset.tab, getLang());
      });
    });

    langToggle.addEventListener('click',()=>{
      const cur=getLang();
      const next=cur==='EN'?'JP':(cur==='JP'?'ZH':'EN');
      localStorage.setItem(LANG_KEY,next);
      applyLang(next);
    });

    applyLang(getLang());
  </script>
</body>
</html>
