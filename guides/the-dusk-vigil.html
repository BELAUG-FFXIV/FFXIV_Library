<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Dusk Vigil | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="FFXIV HW 3.0 Dungeon â€” The Dusk Vigilï¼ˆå»ƒç ¦æœç´¢ ãƒ€ã‚¹ã‚¯ãƒ´ã‚£ã‚¸ãƒ« / æš®è¡›å ¡ï¼‰ï¼šæ•…äº‹æ¦‚è¦ã€éœ€æ±‚æ¢ä»¶ã€è§£é–ä»»å‹™èˆ‡å¾ŒçºŒä»»å‹™ï¼Œé™„å½±ç‰‡ã€‚">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#ffffff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif; background:var(--bg); color:var(--fg);}
    .container{max-width:1080px; margin:0 auto; padding:0 16px}
    .site-header{border-bottom:1px solid var(--border); background:#fff9edb3; backdrop-filter:saturate(120%) blur(6px); position:sticky; top:0; z-index:10}
    .nav{display:flex; align-items:center; justify-content:space-between; height:60px}
    .left{display:flex; align-items:center; gap:12px}
    .home{border:1px solid var(--border); background:#fff; padding:4px 8px; border-radius:8px; text-decoration:none; color:var(--fg); font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex; align-items:center; gap:8px}
    .icon-btn{background:none; border:none; cursor:pointer; font-size:14px; padding:6px 10px; border-radius:8px}
    .icon-btn:hover{background:#fff; border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid; grid-template-columns:1.1fr 1fr; gap:20px; align-items:start;}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} .video-wrap{position:relative; padding-top:56.25%} .video-wrap iframe{position:absolute; inset:0; width:100%; height:100%} }
    .card{background:var(--card); border:1px solid var(--border); border-radius:16px; box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px; border-bottom:1px solid var(--border); font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%; height:420px; border:0; display:block; border-radius:16px}
    .tabs{display:flex; gap:8px; padding:12px 12px 0; flex-wrap:wrap}
    .tab-btn{background:#fff; border:1px solid var(--border); color:var(--fg); border-radius:999px; padding:8px 14px; cursor:pointer; font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent); color:#fff; background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex; flex-direction:column; gap:10px}
    .stack .row{padding:12px 14px; border:1px dashed var(--border); border-radius:12px; background:#fffdf6}
    .muted{color:var(--muted)}
    .link{color:#0b60d8; text-decoration:none}
    .link:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/NTB1exidObI" title="The Dusk Vigil" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">The Dusk Vigil</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true" data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="req">Requirements</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlock">Follow-Up Quest</button>
          <!-- æ–°å¢ï¼šComments -->
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story" class="tab-panel active"></div>
          <div id="panel-acq" class="tab-panel"></div>
          <div id="panel-req" class="tab-panel"></div> <!-- ä¿®æ­£çµæ§‹ -->
          <div id="panel-unlock" class="tab-panel"></div>
          <!-- æ–°å¢ï¼šç•™è¨€é¢æ¿ -->
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <script>
    const LANG_KEY = 'ffxiv-guide-lang';

    const i18n = {
      EN:{
        langLabel:'EN',
        pageTitle:'The Dusk Vigil',
        tabs:{story:'Story', req:'Requirements', acq:'Unlock Quest', unlock:'Follow-Up Quest', comments:'Comments'},
        story:`<p>In the days following the Calamity, western Coerthas was abandoned by the knights of Ishgard, save for the Dusk Vigil, whose defenders refused to withdraw. Since then, the fortress has only fallen further into disrepair, and her garrison has long since been presumed dead.</p>
        <p>Unlike most Ishgardians, who would sooner put the tragic episode behind them, Father Wealdtheow would have you enter the forsaken fortress and reclaim a priceless treasure: an ice rondel set in the helm of a sculpture within the Vigilâ€™s chapel. A simple request, perhaps, but if experience has taught you anything, such tasks are anything butâ€¦</p>`,
        req:`<div class="stack">
          <div class="row"><strong>Players:</strong> 1â€“4 players (1 Tank, 1 Healer, 2 DPS)</div>
          <div class="row"><strong>Class/Job:</strong> Disciples of War or Magic</div>
          <div class="row">â€» Limited jobs can participate only in a preformed party meeting party size requirements or an unrestricted party, and if duty rules allow.</div>
          <div class="row"><strong>Level:</strong> 51 (Sync from 52)</div>
          <div class="row"><strong>Average Item Level:</strong> 100</div>
          <div class="row">â€» While synced, all item stats are adjusted.</div>
          <div class="row">â€» Role and item level restrictions are lifted for parties meeting minimum size requirements.</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="#">For All the Nights to Come</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row">N/A</div>
        </div>`
      },

      JP:{
        langLabel:'JP',
        pageTitle:'å»ƒç ¦æœç´¢ ãƒ€ã‚¹ã‚¯ãƒ´ã‚£ã‚¸ãƒ«',
        tabs:{story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', req:'å¿…è¦æ¡ä»¶', acq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', unlock:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ'},
        story:`<p>ç¬¬ä¸ƒéœŠç½ã«ã‚ˆã£ã¦ã€ã‚¯ãƒ«ã‚¶ã‚¹è¥¿éƒ¨ã¯å³ã—ã„å¯’å†·åœ°ã¸ã¨å¤‰è²Œã—ã€ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰ã®é¨å£«ãŸã¡ã«ã‚ˆã£ã¦æ”¾æ£„ã•ã‚ŒãŸã€‚ã—ã‹ã—ã€ã€Œãƒ€ã‚¹ã‚¯ãƒ´ã‚£ã‚¸ãƒ«ã€ã®å®ˆå‚™éšŠã ã‘ã¯æ’¤é€€ã‚’æ‹’ã¿ã€è¦å¡ã«ç•™ã¾ã£ãŸã®ã ã£ãŸã€‚</p>
        <p>ã‚ã‚Œã‹ã‚‰æ™‚ãŒæµã‚Œã€è¦å¡ã¯æœ½ã¡æœã¦ã€é§å±¯ã—ã¦ã„ãŸå…µã‚‚ã™ã§ã«å…¨æ»…ã—ãŸã¨è¦‹ãªã•ã‚Œã¦ã„ã‚‹ã€‚å¤šãã®ã‚¤ã‚·ãƒ¥ã‚¬ãƒ«ãƒ‰å¸‚æ°‘ãŒã“ã®æ‚²åŠ‡ã«è“‹ã‚’ã—ã¦ç”Ÿãã‚‹ãªã‹ã€ç¥çˆ¶ã‚¦ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ã‚ªã¯ã€ç¤¼æ‹å ‚ã®å½«åƒã«åã‚ã‚‰ã‚ŒãŸã€Œæ°·ã®ãƒ­ãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ã¨ã„ã†å®ã‚’å–ã‚Šæˆ»ã—ã¦ã»ã—ã„ã¨é¡˜ã„å‡ºã‚‹ã€‚ä¸€è¦‹å˜ç´”ãªé ¼ã¿ã ãŒã€å¹¾å¤šã®çµŒé¨“ãŒèªã‚‹é€šã‚Šã€ç°¡å˜ãªä»•äº‹ã»ã©â€¦â€¦è£ãŒã‚ã‚‹ã‚‚ã®ã ã€‚</p>`,
        req:`<div class="stack">
          <div class="row"><strong>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°ï¼š</strong>1ï½4äººï¼ˆã‚¿ãƒ³ã‚¯1ï¼ãƒ’ãƒ¼ãƒ©ãƒ¼1ï¼DPS2ï¼‰</div>
          <div class="row"><strong>ã‚¯ãƒ©ã‚¹ï¼ã‚¸ãƒ§ãƒ–ï¼š</strong>ãƒ•ã‚¡ã‚¤ã‚¿ãƒ¼ï¼ã‚½ãƒ¼ã‚µãƒ©ãƒ¼</div>
          <div class="row">â€» ãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã¯ã€è¦å®šäººæ•°ã®äº‹å‰çµæˆãƒ‘ãƒ¼ãƒ†ã‚£ã¾ãŸã¯åˆ¶é™è§£é™¤ãƒ‘ãƒ¼ãƒ†ã‚£ã‹ã¤è¦å®šãŒè¨±å¯ã™ã‚‹å ´åˆã®ã¿å‚åŠ å¯ã€‚</div>
          <div class="row"><strong>ãƒ¬ãƒ™ãƒ«ï¼š</strong>51ï¼ˆã‚·ãƒ³ã‚¯ï¼š52ï¼‰</div>
          <div class="row"><strong>å¹³å‡ã‚¢ã‚¤ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«ï¼š</strong>100</div>
          <div class="row">â€» ã‚·ãƒ³ã‚¯ä¸­ã¯å…¨è£…å‚™ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒèª¿æ•´ã•ã‚Œã¾ã™ã€‚</div>
          <div class="row">â€» æœ€ä½äººæ•°ã‚’æº€ãŸã™ãƒ‘ãƒ¼ãƒ†ã‚£ã§ã¯ãƒ­ãƒ¼ãƒ«ï¼ILåˆ¶é™ãŒè§£é™¤ã•ã‚Œã¾ã™ã€‚</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="#">å»ƒç ¦æœç´¢ ãƒ€ã‚¹ã‚¯ãƒ´ã‚£ã‚¸ãƒ«</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row">N/A</div>
        </div>`
      },

      ZH:{
        langLabel:'ZH-TW',
        pageTitle:'æš®è¡›å ¡',
        tabs:{story:'æ•…äº‹æ¦‚è¦', req:'éœ€æ±‚æ¢ä»¶', acq:'è§£é–ä»»å‹™', unlock:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€'},
        story:`<p>ç¬¬ä¸ƒéˆç½éå¾Œï¼ŒIshgard çš„é¨å£«åœ˜æ’¤é›¢äº†æ•´å€‹ Coerthas è¥¿éƒ¨ï¼Œå”¯ç¨ The Dusk Vigil çš„å®ˆè»æ‹’çµ•æ’¤å‡ºï¼Œé¸æ“‡å­¤èº«å …å®ˆã€‚æ­¤å¾Œï¼Œé€™åº§å ¡å£˜é€æ¼¸è’å»¢ï¼Œé§è»ä¹Ÿæ—©è¢«è¦–ç‚ºå…¨æ•¸å–ªç”Ÿã€‚</p>
        <p>å¤šæ•¸ Ishgard äººå¯§å¯éºå¿˜é€™æ®µå‚·ç—›å¾€äº‹ï¼Œä½† Father Wealdtheow å»å¸Œæœ›ä½ æ·±å…¥é€™åº§è¢«éºæ£„çš„è¦å¡ï¼Œå–å›ä¸€ä»¶ç„¡åƒ¹ä¹‹å¯¶â€”â€”ä¸€é¡†é‘²åµŒæ–¼ç¦®æ‹œå ‚é›•åƒé ­ç›”ä¸­çš„ã€Œå†°ä¹‹åœ“å¾½ã€ã€‚è¡¨é¢ä¸Šåªæ˜¯å€‹ç°¡å–®çš„è«‹è¨—ï¼Œä½†æ­£å¦‚æ­·æ¬¡ç¶“é©—æ‰€ç¤ºï¼Œè¶Šæ˜¯çœ‹ä¼¼ç°¡å–®çš„ä»»å‹™ï¼Œå¾€å¾€éš±è—è‘—é›£ä»¥é æ¸¬çš„å±æ©Ÿâ€¦â€¦</p>`,
        req:`<div class="stack">
          <div class="row"><strong>äººæ•¸ï¼š</strong>1â€“4 äººï¼ˆ1 å¦å…‹ï¼1 æ²»ç™‚ï¼2 è¼¸å‡ºï¼‰</div>
          <div class="row"><strong>è·æ¥­ï¼š</strong>æˆ°é¬¥è·æ¥­ï¼é­”æ³•è·æ¥­</div>
          <div class="row">â€» é™å®šè·æ¥­åƒ…èƒ½åœ¨äº‹å…ˆçµ„æˆç¬¦åˆäººæ•¸æ¢ä»¶çš„éšŠä¼ï¼Œæˆ–ä»¥ç„¡é™åˆ¶è¦å‰‡åƒåŠ ï¼Œä¸”éœ€ç¬¦åˆä»»å‹™è¦å‰‡å…è¨±çš„æƒ…æ³ã€‚</div>
          <div class="row"><strong>ç­‰ç´šï¼š</strong>51ï¼ˆåŒæ­¥è‡³ 52ï¼‰</div>
          <div class="row"><strong>å¹³å‡è£å‚™å“ç´šï¼š</strong>100</div>
          <div class="row">â€» åŒæ­¥æ™‚ï¼Œæ‰€æœ‰è£å‚™æ•¸å€¼å°‡è‡ªå‹•èª¿æ•´ã€‚</div>
          <div class="row">â€» ç•¶éšŠä¼åƒ…é”æœ€ä½äººæ•¸æ™‚ï¼Œè§’è‰²å®šä½èˆ‡è£å‚™å“ç´šé™åˆ¶å°‡è§£é™¤ã€‚</div>
        </div>`,
        acq:`<div class="stack">
          <div class="row"><a class="link" href="#">æ°¸å¤œå°‡è‡¨</a></div>
        </div>`,
        unlock:`<div class="stack">
          <div class="row">N/A</div>
        </div>`
      }
    };

    const langToggle = document.getElementById('langToggle');
    const pageTitle  = document.getElementById('pageTitle');
    const tabBtns    = [...document.querySelectorAll('.tab-btn')];
    const panels = {
      story : document.getElementById('panel-story'),
      acq   : document.getElementById('panel-acq'),
      req   : document.getElementById('panel-req'),
      unlock: document.getElementById('panel-unlock'),
      comments: document.getElementById('panel-comments') // æ–°å¢
    };

    function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
    function applyLang(lang){
      const t = i18n[lang] || i18n.EN;
      pageTitle.textContent = t.pageTitle;
      langToggle.textContent = `ğŸŒ ${t.langLabel}`;
      tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
      const activeBtn = tabBtns.find(b=>b.getAttribute('aria-selected')==='true') || tabBtns[0];
      renderPanel(activeBtn.dataset.tab, lang);
      // è‹¥ç›®å‰å°±åœ¨ç•™è¨€åˆ†é ï¼Œåˆ‡èªè¨€å¾Œé‡è¼‰ giscus
      if (activeBtn && activeBtn.dataset.tab === 'comments') loadGiscusForCurrentLang();
    }

    // ä¸è¦†å¯«ç•™è¨€å®¹å™¨ï¼›é€²å…¥ç•™è¨€åˆ†é æ™‚è¼‰å…¥ giscus
    function renderPanel(key, lang){
      const t = i18n[lang] || i18n.EN;
      Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
      panels[key].classList.add('active');

      if (key !== 'comments') {
        panels[key].innerHTML = t[key];
      } else {
        loadGiscusForCurrentLang();
      }
    }

    tabBtns.forEach(btn=>{
      btn.addEventListener('click',()=>{
        tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
        btn.setAttribute('aria-selected','true');
        renderPanel(btn.dataset.tab, getLang());
      });
    });

    langToggle.addEventListener('click',()=>{
      const cur=getLang();
      const next=cur==='EN'?'JP':(cur==='JP'?'ZH':'EN');
      localStorage.setItem(LANG_KEY,next);
      applyLang(next);
    });

    applyLang(getLang());

    /* === Giscusï¼šå–®ä¸€ Comments åˆ†é ï¼Œéš¨èªè¨€åˆ‡æ› === */
    const GISCUS_CFG = {
      repo: 'BELAUG-FFXIV/FFXIV_Library',
      repoId: 'R_kgDOPyh4Kw',
      category: 'General',
      categoryId: 'DIC_kwDOPyh4K84CwPjL',
      theme: 'preferred_color_scheme'
    };
    function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
    function loadGiscusForCurrentLang(){
      const mount = document.getElementById('giscus_container');
      if (!mount) return;
      mount.innerHTML = ''; // æ¸…æ‰èˆŠ iframe/script
      const langCode = getLang(); // EN / JP / ZH
      const s = document.createElement('script');
      s.src = 'https://giscus.app/client.js';
      s.setAttribute('data-repo', GISCUS_CFG.repo);
      s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
      s.setAttribute('data-category', GISCUS_CFG.category);
      s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
      s.setAttribute('data-mapping', 'specific');                   // ä½¿ç”¨å›ºå®š term
      s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode); // æ¯èªè¨€å„è‡ªä¸€ä¸²
      s.setAttribute('data-reactions-enabled', '1');
      s.setAttribute('data-emit-metadata', '0');
      s.setAttribute('data-input-position', 'bottom');
      s.setAttribute('data-lang', uiLang(langCode));
      s.setAttribute('data-theme', GISCUS_CFG.theme);
      s.setAttribute('crossorigin', 'anonymous');
      s.async = true;
      mount.appendChild(s);
    }
  </script>
</body>
</html>
