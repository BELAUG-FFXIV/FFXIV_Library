<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Company You Keep (Maelstrom) | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – The Company You Keep (Maelstrom) (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:#222;border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    /* Story 展開 / 收合 */
    .clamp{ position:relative; max-height:360px; overflow:hidden; }
    .clamp[data-collapsed="false"]{ max-height:none; }
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/9pe9pUqSGCo"
              title="The Company You Keep (Maelstrom)" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">The Company You Keep (Maelstrom)</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'The Company You Keep (Maelstrom)',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Having stood witness to the words of the three Grand Company leaders, you made your choice: the Maelstrom of Limsa Lominsa. The officer’s joy was plain, welcoming you as a brother of the crimson standard. Yet no sooner had you accepted than fate intervened—news arrived of a Garlond Ironworks airship, the Tiny Bronco, struck down by imperial fire and forced into an emergency landing.</p>
      <p>Without ceremony, your first mission was thrust upon you. In the wilds of Cedarwood, imperial scouts closed in, seeking to claim both the vessel and her crew. With steel in hand, you cut through the Garleans, saving the engineers Biggs and Wedge from certain capture. Though shaken, the airship endured, and with hurried repairs, it soared once more into the sky.</p>
      <p>Returning to Limsa, the Maelstrom welcomed you formally. The crimson standard was now yours to bear, and the Admiral’s navy your shield and family. Your journey as one of the Maelstrom had begun—not with pomp, but with fire and steel.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Storm Officer <small class="muted">(The Waking Sands, X:6.8, Y:6.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-hero-in-the-making.html">A Hero in the Making</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="#">Till Sea Swallows All</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'我が行く道は……（黒渦団）',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト' },
    readMore:'全文を表示', readLess:'折りたたむ',
    story:`<div class="clamp" data-collapsed="true">
      <p>三国のグランドカンパニーの演説を聞き終えたあなたは、ついに決断を下した──リムサ・ロミンサの「黒渦団」に身を投じると。士官は歓喜の笑みであなたを迎え、紅の旗の下に加わることを誇りとした。</p>
      <p>しかしその直後、運命は容赦なく介入する。ガーロンド・アイアンワークスの飛空艇「タイニー・ブロンコ」が帝国の砲火を受け、「シーダーウッド」へ不時着したという急報が届いたのだ。</p>
      <p>正式な任命を待つ間もなく、あなたは初任務に駆り出される。帝国斥候たちが迫る中、飛空艇とその搭乗員を守るべく剣を抜き、熾烈な戦いを繰り広げた。やがて帝国軍を退け、技師「ビッグス」と「ウェッジ」を救出。損傷を負いながらも「タイニー・ブロンコ」は修復され、再び空へ舞い上がった。</p>
      <p>リムサに戻ったあなたを、黒渦団は正式に迎え入れる。紅の旗は今やあなたの誇りとなり、提督の艦隊は新たな仲間としてあなたを守るだろう。華やかさではなく、戦火と試練によって──こうして、あなたの黒渦団としての旅路が始まった。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> 黒渦団士官 <small class="muted">（西ザナラーン：砂の家, X:6.8, Y:6.2）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-hero-in-the-making.html">英雄の卵</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="#">海が全てを呑み込むまで</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'與黑渦同行',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務' },
    readMore:'展開全文', readLess:'收合內容',
    story:`<div class="clamp" data-collapsed="true">
      <p>在聆聽過三國 Grand Company 的演說後，你終於做出抉擇──加入 Limsa Lominsa 的「黑渦團」。軍官的喜悅溢於言表，迎接你成為紅旗之下的新同袍。然而尚未完成正式任命，命運便緊急介入：消息傳來，Garlond Ironworks 的飛空艇「Tiny Bronco」遭帝國砲火擊落，被迫在 Cedarwood 緊急降落。</p>
      <p>來不及多想，你的首個任務已然展開。帝國斥候正逼近殘破的飛空艇，意圖奪取船體與技術。你毅然拔劍，與 Maelstrom 戰士並肩擊退敵軍，成功救出工程師 Biggs 與 Wedge。雖然飛空艇受損，但在臨時修復後，她再次衝破長空。</p>
      <p>回到 Limsa 後，你終於被正式授予 Maelstrom 的身份。自此，紅旗不僅是你的象徵，更是你與同伴的紐帶。這段旅程，並非在榮耀的典禮中展開，而是在戰火與鋼鐵的洗禮之下揭幕。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 黑渦團士官 <small class="muted">（薩納蘭西部 ‧ 覺醒沙之家, X:6.8, Y:6.2）</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-hero-in-the-making.html">初露頭角的英雄</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="#">直至大海吞沒一切</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }

function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  panels[key].innerHTML = t[key];
  if(key === 'story') wireClamp(panels[key], t);
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());
</script>
</body>
</html>
