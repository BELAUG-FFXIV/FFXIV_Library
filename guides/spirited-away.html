<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spirited Away | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – Spirited Away (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}

    /* 展開/收合 */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/fKcwDsclhAk"
              title="Spirited Away" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Spirited Away</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Spirited Away',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Komuxio greets you with uncharacteristic hesitation. He lowers his head and apologizes, confessing that he can no longer keep his promise to take you to meet the elder one. The elder has vanished—he entered the forest yesterday and has not returned since. Though the elder often wanders beneath the trees, never has he been gone for so long. Worry weighs heavily in Komuxio’s voice as he pleads for your help.</p>
      <p>He explains that near the place where the elder disappeared stands the home of a walking one named Buscarron. Perhaps Buscarron saw something, yet Komuxio admits that walking ones seldom trust his people. And so, he entrusts this delicate task to you. Before you depart, he asks that you also seek help from your kin in Gridania—for until the elder returns, none of his people will feel safe in the forest.</p>
      <p>Back in Gridania, Vorsaile Heuloix greets you as the sylphs’ envoy, his tone warm until your words turn grave. The moment you mention the missing elder, his expression hardens. Should the elder fall into the hands of the tempered ones, he warns, it would spell disaster. He vows that his sharpest-eyed Serpents will search the Twelveswood night and day, and sends you to Bentbranch Meadows to deliver word to Giah Molkoh—the Wood Wailers will join the hunt.</p>
      <p>When you find Giah Molkoh, she listens with calm resolve. The sylph elder has vanished? Then she and her people will watch under every leaf, behind every branch—if the elder is anywhere in the forest, they will find him.</p>
      <p>Later, in the South Shroud, you pause outside Buscarron’s alehouse. Yda remarks that Buscarron is a trusted friend and that no place in the region carries news faster than his. Papalymo, ever cautious, wonders what would bring a sylph elder to a place their kind usually avoids. Still, the question of motive must wait—finding him comes first.</p>
      <p>Inside, Buscarron greets you with his usual warmth, a tankard in hand and laughter on his lips. When he realizes you’re not there for drink or meal, his smile softens. A sylph sighting, you say? Aye, there’s been talk of one wandering nearby—but he cannot say if it’s the elder you seek. To most folk, the sylphs all look alike, he jokes, unless you paint one red and another blue. Then, with a wink, he adds that fate has a curious way of revealing answers when one simply lingers long enough to listen.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Komuxio, East Shroud <small class="muted">(X:21.9, Y:25.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="brotherly-love.html">Brotherly Love</a></div>
    </div>`,
    followq:`<div class="stack">
  <div class="row"><a class="link" href="druthers-house-rules.html">Druthers House Rules</a></div>
</div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'ただよえる長老',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト', comments:'コメント' },
    readMore:'全文を表示', readLess:'折りたたむ',
    story:`<div class="clamp" data-collapsed="true">
      <p>コムクシオは珍しくためらいを見せながら、あなたを迎えた。彼は深く頭を下げ、申し訳なさそうに語る。あなたを elder one に会わせると約束していたが、その約束を果たせなくなったのだ。elder は昨日、森に入ったきり戻っていない。これまでも森に出ることはあったが、これほど長く姿を消したことはなかった。声に滲む不安を抑えきれず、彼はあなたに助けを求めた。</p>
      <p>最後に elder が目撃されたのは、Buscarron という walking one の家の近くだという。もしかすると、彼なら何かを知っているかもしれない。しかし、コムクシオは続けて言う──walking ones は these ones を簡単には信用してくれない。だからこそ、あなたに代わりに話をしてほしいと頼んだ。そして出発前に、Gridania にいる仲間たちにも助けを求めてほしいと懇願する。elder が戻らぬ限り、森に暮らす彼らに安息はないのだ。</p>
      <p>Gridania に戻ると、Vorsaile Heuloix はあなたをシルフ族の使者として歓迎した。だが、あなたの報告を聞くと表情が一変する。elder が行方不明？ もし touched ones に捕らわれでもしたら、一大事だ。彼は鋭い目を持つ Serpent たちに森を昼夜見張らせると誓い、さらに Bentbranch Meadows にいる Giah Molkoh へ知らせを届けてほしいと託した。Wood Wailers も捜索に加わるのだという。</p>
      <p>Giah Molkoh は報告を聞くと、落ち着いた声で頷いた。elder が姿を消したのなら、葉の下も枝の影も、森のすべてを見張るつもりだと。Twleveswood のどこかにいるのなら、必ず見つけ出すと力強く言い切った。</p>
      <p>やがてあなたは South Shroud にある Buscarron の酒場にたどり着く。外で足を止めると、Yda が「Buscarron は信頼できる友人で、この地の噂はすべて彼の店を通る」と微笑む。だが Papalymo は慎重に眉をひそめた。シルフたちが滅多に近づかぬこの場所に、elder が来た理由は何だろうか？ とはいえ今は理由を問う時ではない。まず見つけることが先だ、と彼は言い切る。</p>
      <p>店の中で Buscarron はいつものように陽気にあなたを迎える。だが、あなたが飲みに来たのではないと知ると、笑みを和らげた。シルフを見かけたという話なら、確かに聞いたことがあるが、それが elder かどうかは分からない。どのシルフも見た目はよく似ており、赤と青にでも塗らねば見分けはつかないだろうと冗談を言いながら肩をすくめる。 それでも「神々の気まぐれに任せて、しばらくここで様子を見てみるのも悪くない」と、彼は軽くウィンクした。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> コムシオ　黒衣森：東部森林 <small class="muted">(X:21.9, Y:25.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="brotherly-love.html">クラクシオの決意</a></div>
    </div>`,
    followq:`<div class="stack">
  <div class="row"><a class="link" href="druthers-house-rules.html">バスカロンドラザーズの掟</a></div>
</div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'迷途的長老',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務', comments:'留言' },
    readMore:'展開全文', readLess:'收合內容',
    story:`<div class="clamp" data-collapsed="true">
      <p>當你回到 Little Solace 時，Komuxio 以往那份穩重的神情已不復存在。他壓低身子，滿懷歉意地告訴你，原本要帶你去見的 elder one 失蹤了。昨天他如往常一般進入森林，卻再也沒有回來。雖然 elder 常在林中行走，但這次的消失太長，讓不安的氣息在空氣裡蔓延。Komuxio 的聲音顫抖而誠懇，懇求你幫忙尋找。</p>
      <p>他說，elder 最後出現的地點在一位名叫 Buscarron 的 walking one 家附近。或許那裡能找到線索，但 Komuxio 自知 walking ones 向來不易信任 these ones，因此只能將希望託付給你。臨行前，他又想起 Gridania──請你回去尋求 fellow kind ones 的援手。直到 elder 平安歸來之前，這片森林都難再安寧。</p>
      <p>回到 Gridania，Vorsaile Heuloix 以外交使者的身分迎接你，語氣一如既往地溫和。然而當聽到 elder 失蹤的消息，他的神情瞬間沉下來。他說，若 elder 落入 touched ones 之手，後果將不堪設想。於是他承諾會派出最警覺的 Serpents，在 Twelveswood 昼夜搜查，並請你前往 Bentbranch Meadows 通知 Giah Molkoh──Wood Wailers 將會參與這場搜救。</p>
      <p>你將消息轉達後，Giah Molkoh 目光堅定地回應。若 elder 仍在這片森林，她說，無論樹葉之下還是枝幹之後，Wood Wailers 的眼睛都不會錯過。</p>
      <p>稍後，在 South Shroud 的酒館外，你與 Yda 和 Papalymo 匯合。Yda 輕聲說，Buscarron 是值得信任的朋友，在這片土地上，沒有哪裡比他的店更快傳出消息。Papalymo 卻若有所思──Sylph 平日避開這一帶，elder 為何會來？但他最終搖頭道：「理由之後再查，現在最重要的是把他找回來。」</p>
      <p>你推門走入酒館。Buscarron 面帶笑容迎接你，酒香混雜著木桶的氣息。當他察覺你不是來喝酒的，他收斂笑意，仔細聽你詢問。的確，最近有人在這裡見過 Sylph，但他無法確定那是不是 elder。對大多數人來說，Sylph 幾乎都長得一樣──除非給他們分別塗上紅與藍。話畢，他輕拍你的肩，笑著說，也許只要多待一會兒，命運女神就會讓答案自己出現在你面前。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 柯姆修歐　黑衣森東部森林 <small class="muted">(X:21.9, Y:25.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="brotherly-love.html">手足的羈絆</a></div>
    </div>`,
    followq:`<div class="stack">
  <div class="row"><a class="link" href="druthers-house-rules.html">酒館的行規</a></div>
</div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscus：Comments 分頁 === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + '｜' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
