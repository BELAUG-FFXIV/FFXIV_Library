<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Killing Him Softly | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – Killing Him Softly (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    /* 展開/收合 */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/7VEHzVPhuOM"
              title="Killing Him Softly" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Killing Him Softly</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Killing Him Softly',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>A desperate situation unfolds in Quarrymill, where Meffrid of the Ala Mhigan Resistance watches helplessly as one of his comrades, Gallien, succumbs to a festering wound. His pleas to the villagers are met with cold indifference, and only his lingering hope in Albreda—an old friend—remains.</p>
      <p>Moved by Meffrid’s urgency, you speak to Albreda, who reveals her torn heart. Though her roots tie her to the Ala Mhigan Resistance, her life in Quarrymill has taught her the price of disobedience to the elementals. The cost of defying their will could see the entire village banished. In quiet anguish, she points you toward Charline, a Hearer who might yet intervene.</p>
      <p>Charline listens with empathy, but her response is bound by ancient law. The will of the elementals is absolute, and they have denied the Ala Mhigans a place in the wood. Her hands tied, she sends you away with sorrow in her voice.</p>
      <p>Upon hearing the news, Meffrid’s fury erupts. Denied even a chance to save a dying friend, he curses the elementals and the suffocating order of the Twelveswood. The Ala Mhigan Resistance yearns not only for freedom from Garlemald—but from this forest that has turned its back on them.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Meffrid <small class="muted">(South Shroud, X: 25.6 Y: 20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="meeting-with-the-resistance.html">Meeting with the Resistance</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="helping-horn.html">Helping Horn</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'無慈悲な精霊',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト', comments:'コメント' },
    readMore:'全文を表示', readLess:'折りたたむ',
    story:`<div class="clamp" data-collapsed="true">
      <p>クォーリーミルで、アラミゴ解放軍のメッフリッドは、仲間であるガリアンの悪化した傷に手をこまねいていた。村人たちに救援を頼んだが、冷たく拒まれ、最後の望みは旧知のアルブレダに託されていた。</p>
      <p>あなたはメッフリッドの思いを受け取り、アルブレダを訪ねる。彼女は苦悩の表情で語る──アラミゴ解放軍への思いは消えていないが、クォーリーミルでの生活を通じて、精霊の意志に逆らうことの恐ろしさを学んだという。もし禁を破れば、村全体が追放されるかもしれない。悩んだ末、彼女は村の幻術士であるシャルリーヌのもとを訪ねるよう提案する。</p>
      <p>シャルリーヌはあなたの話に耳を傾けるも、答えは無情だった。精霊の意志は絶対であり、アラミゴの民の嘆願はすでに退けられていた。外の者が森の恵みを受けるには、夜の審判を経て許しを得る必要がある──それが古くからの決まりであり、今も変わらない。</p>
      <p>その報せを受けたメッフリッドは怒りを露わにする。死にゆく仲間を救う術すら与えられず、彼は精霊とトゥワイン大森林の掟を呪った。アラミゴ解放軍が求めているのは、ガレマール帝国からの自由だけではない。この森の束縛からの解放でもあるのだ。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> メフリッド　黒衣森：南部森林 <small class="muted">(X: 25.6 Y: 20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="meeting-with-the-resistance.html">アラミゴ解放軍を知る者</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="helping-horn.html">角薬が繋ぐ縁</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'無情的森靈',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務', comments:'留言' },
    readMore:'展開全文', readLess:'收合內容',
    story:`<div class="clamp" data-collapsed="true">
      <p>在 Quarrymill，Ala Mhigan 反抗軍的 Meffrid 無助地看著 Gallien 傷口潰爛、命在旦夕。他曾懇求村民援手，卻只換來冷漠的拒絕。如今，他唯一的希望只剩下舊友 Albreda。</p>
      <p>你依 Meffrid 之託前往尋找 Albreda。她滿懷矛盾地說道：雖然心繫 Ala Mhigan 反抗軍，但在 Quarrymill 的生活讓她明白，違抗精靈的意志會付出可怕代價——整個村莊都可能遭放逐。懷著痛苦與歉意，她將希望託付給村中的幻術士──Charline。</p>
      <p>Charline 聽完後語帶憐憫，卻無法改變結果。精靈的意志至高無上，他們已拒絕讓 Ala Mhigan 人民在這片森林中立足。受制於古老的律法，Charline 只能無奈地送你離開。</p>
      <p>當你將消息轉達給 Meffrid 時，他的憤怒終於爆發。連救助垂死戰友的機會都被奪走，他咒罵精靈與那令人窒息的規條。Ala Mhigan 反抗軍渴望的自由，不僅是脫離 Garlemald 的支配，更是擺脫這片背棄了他們的森林。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 梅弗里德　黑衣森林南部 <small class="muted">(X: 25.6 Y: 20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="meeting-with-the-resistance.html">與反抗軍的會面</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="helping-horn.html">因藥結緣</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscus：Comments 分頁 === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + '｜' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
