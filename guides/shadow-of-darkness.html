<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shadow of Darkness | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Shadow of Darkness (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    /* å±•é–‹/æ”¶åˆ */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/gkVpGEZBq10"
              title="Shadow of Darkness" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Shadow of Darkness</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Shadow of Darkness',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>After the uneasy peace with the sylphs, Minfilia wastes no time before turning her gaze toward a darker mystery. The Ascian known as Lahabrea, whose red mask was glimpsed deep within Toto-Rak, must be investigated before he can sow further chaos.</p>
      <p>She reveals that she has reached out to the Grand Companies, seeking any trace of these elusive beings. The Immortal Flames have reported a possible sighting in eastern Thanalan, and she entrusts you with the inquiry. Cautioning that little is known of the Ascians except the destruction they leave behind, Minfilia urges you to be vigilant and safe.</p>
      <p>In Ulâ€™dah, Flame Commander Swift confirms the report: a Brass Blade at Highbridge had described a masked man before perishing at the hands of Qiqirn raiders. Still, the crossroads bustles with travelers and merchants, any of whom might have seen the stranger. Among them, the merchant Hihibaru welcomes you with his usual bravadoâ€”eager for business, gossip, and perhaps, answers.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Minfilia <small class="muted">(The Waking Sands, X: 6.9 Y: 6.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="back-from-the-wood.html">Back from the Wood</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="highbridge-times.html">Highbridge Times</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'ä¸å‰ãªæ°—é…',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ã‚·ãƒ«ãƒ•æ—ã¨ã®å’Œå¹³ãŒæˆã‚Šç«‹ã£ãŸä»Šã€ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯ã™ãã•ã¾æ¬¡ãªã‚‹è„…å¨ã«ç›®ã‚’å‘ã‘ã‚‹ã€‚ãƒˆãƒˆãƒ©ã‚¯ã®åƒç„ã§ç›®æ’ƒã•ã‚ŒãŸã€Œä»®é¢ã®ç”·ã€â”€â”€ã‚¢ã‚·ã‚¨ãƒ³ãƒ»ãƒ©ãƒãƒ–ãƒ¬ã‚¢ã€‚ãã®åã‚’å† ã™ã‚‹å­˜åœ¨ã®ç›®çš„ã‚’æ¢ã‚‰ã­ã°ãªã‚‰ãªã„ã¨å½¼å¥³ã¯èªã‚‹ã€‚</p>
      <p>å½¼å¥³ã¯ã™ã§ã«ä¸‰å›½ã®ã‚°ãƒ©ãƒ³ãƒ‰ã‚«ãƒ³ãƒ‘ãƒ‹ãƒ¼ã¸å”åŠ›ã‚’è¦è«‹ã—ã¦ãŠã‚Šã€ãã®ã†ã¡ä¸æ»…éšŠã‹ã‚‰ã¯æ±ã‚¶ãƒŠãƒ©ãƒ¼ãƒ³ã§ã®ç›®æ’ƒæƒ…å ±ãŒå±Šã„ãŸã¨ã„ã†ã€‚ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã¯ãã®èª¿æŸ»ã‚’ã‚ãªãŸã«è¨—ã—ã€ã€Œã‚¢ã‚·ã‚¨ãƒ³ã€ã«ã¤ã„ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯ã€å½¼ã‚‰ãŒæ­©ã‚“ã è·¡ã«ç ´å£ŠãŒæ®‹ã‚‹ã¨ã„ã†äº‹å®Ÿã®ã¿ã ã¨å‘Šã’ã‚‹ã€‚æ²¹æ–­ã›ãšã€æ…é‡ã«è¡Œå‹•ã›ã‚ˆâ”€â”€ãã‚ŒãŒå½¼å¥³ã®é¡˜ã„ã ã£ãŸã€‚</p>
      <p>ã‚¦ãƒ«ãƒ€ãƒã®ã€Œç‚ã®é™£å–¶ã€ã‚’è¨ªã­ã‚‹ã¨ã€ã‚¹ã‚¦ã‚£ãƒ•ãƒˆå¸ä»¤ã¯å ±å‘Šã‚’ç¢ºèªã—ã¦ãã‚Œã‚‹ã€‚ãƒã‚¤ãƒ–ãƒªãƒƒã‚¸ã«é§åœ¨ã—ã¦ã„ãŸãƒ–ãƒ©ã‚¹ãƒ–ãƒ¬ãƒ¼ãƒ‰ãŒä»®é¢ã®ç”·ã‚’ç›®æ’ƒã—ãŸãŒã€äºŒæ—¥å‰ã€ã‚­ã‚­ãƒ«ãƒ³ã®è¥²æ’ƒã«ã‚ˆã‚Šå‘½ã‚’è½ã¨ã—ãŸã¨ã„ã†ã€‚ã—ã‹ã—äº¤æ˜“ã®è¦æ‰€ã§ã‚ã‚‹ã“ã®åœ°ã§ã¯ã€å•†äººã‚„æ—…äººã®å¾€æ¥ãŒçµ¶ãˆãªã„ã€‚ä¸­ã§ã‚‚ãƒ’ãƒ’ãƒãƒ«ã¨ã„ã†å•†äººãŒã€å™‚å¥½ãã§æœ‰åã ã€‚å½¼ãªã‚‰ä½•ã‹æ‰‹æ›ã‹ã‚Šã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒŸãƒ³ãƒ•ã‚£ãƒªã‚¢ã€€è¥¿ã‚¶ãƒŠãƒ©ãƒ¼ãƒ³ï¼šç ‚ã®å®¶ <small class="muted">(X: 6.9 Y: 6.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="back-from-the-wood.html">æ£®ã‹ã‚‰ã®å¸°é‚„</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="highbridge-times.html">æ©‹ä¸Šã®è¨¼è¨€</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'ä¸ç¥¥çš„æ°£æ¯',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>åœ¨èˆ‡ Sylph æ—é”æˆè„†å¼±çš„å’Œå¹³å¾Œï¼ŒMinfilia ç«‹åˆ»å°‡æ³¨æ„åŠ›è½‰å‘æ›´æ·±çš„é»‘æš—â€”â€”é‚£ä½åœ¨ Toto-Rak æ·±è™•ç¾èº«çš„ Ascianï¼ŒLahabreaã€‚å¥¹èªç‚ºå¿…é ˆè¶ Primal ä¹‹å¨æš«æ¯ä¹‹éš›ï¼Œæ­é–‹é€™åæˆ´ç´…è‰²é¢å…·ä¹‹äººçš„é™°è¬€ã€‚</p>
      <p>å¥¹è¡¨ç¤ºå·²å‘ä¸‰å¤§åœ‹é˜²è»è«‹æ±‚å”åŠ©ï¼Œè€Œ Immortal Flames å‚³ä¾†æƒ…å ±ï¼šæ± Thanalan æ›¾å‡ºç¾ç–‘ä¼¼ç›®æ¨™çš„è¹¤è·¡ã€‚Minfilia å°‡ä»»å‹™è¨—ä»˜æ–¼ä½ ï¼Œä¸¦æé†’é“ï¼šé—œæ–¼ Asciansï¼Œå”¯ä¸€ç¢ºçŸ¥çš„ï¼Œå°±æ˜¯ä»–å€‘è¡Œç¶“ä¹‹è™•ç›¡æ˜¯æ¯€æ»…ã€‚å‹™å¿…è¬¹æ…è¡Œäº‹ã€‚</p>
      <p>æŠµé” Ulâ€™dah å¾Œï¼ŒFlame Commander Swift è­‰å¯¦æ¶ˆæ¯å±¬å¯¦â”€â”€é§å®ˆ Highbridge çš„ Brass Blade æ›¾æè¿°éé‚£åç”·å­ï¼Œä½†ä¸ä¹…å‰é­ Qiqirn è¥²æ“Šèº«äº¡ã€‚ä¸éé€™è£¡æ˜¯å•†æ—…é›²é›†çš„è¦é“ï¼Œä¹Ÿè¨±é‚„æœ‰å…¶ä»–äººç›®ç¹éå¯ç–‘èº«å½±ã€‚å•†äºº Hihibaru æ»¿è‡‰ç¬‘æ„è¿æ¥ä½ ï¼Œå˜´ä¸Šæ›è‘—è€ç·´çš„èª‡å£èˆ‡å…«å¦ï¼Œæˆ–è¨±ä»–çš„è©±èªè£¡å°±è—è‘—ç·šç´¢ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> æ˜è²åˆ©äºã€€è–©ç´è˜­è¥¿éƒ¨ï¼šè¦ºé†’æ²™ä¹‹å®¶ <small class="muted">(X: 6.9 Y: 6.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="back-from-the-wood.html">è‡ªæ—é–“æ­¸ä¾†</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="highbridge-times.html">æ©‹ä¸Šæµè¨€èˆ‡çœŸç›¸</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscusï¼šComments åˆ†é  === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
