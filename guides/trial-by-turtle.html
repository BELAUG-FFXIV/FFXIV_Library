<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trial by Turtle | BELAUG · FFXIV Library</title>
  <meta name="description" content="MSQ – Trial by Turtle (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    /* 展開/收合 */
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">🏠 Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="切換語言">🌐 EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- 左：影片 -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/9KKb4xxfVwk"
              title="Trial by Turtle" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- 右：標題 + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Trial by Turtle</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Trial by Turtle',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Landenel makes his terms plain: whatever passes between you, him, and the captain stays secret. He reminisces about his days with the Company of Heroes—roaming the realm, meeting interesting folk, and, when required, killing them—then notes that Gridanians are seldom forgiving, Detoh being a rare exception. To preserve his image as a model citizen, he’s forsworn the vices he misses, and he warns that if you break his charade by talking, he’ll string you up with your own entrails.</p>
      <p>Your task is simple only in theory: to the east lies a nest with a giant adamantoise egg, and the mother never strays far. Touch it, and you’ll be attacked. Better to abandon Titan now and spare the swamp another corpse.</p>
      <p>You return with the egg. He had half-expected you to flee, but your stubborn resolve draws a bark of laughter—bravery or recklessness will serve against Titan. He’ll see the egg to the captain; you are to head for southern Thanalan. In Forgotten Springs, seek U’odh Nunh, your next guide.</p>
      <p>At Forgotten Springs, U’odh Nunh snorts at your arrival. So you’re the one Wheiskaet sent? He can’t imagine what the man sees in you—and until he can, you’ll get no aid.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Landenel <small class="muted">(South Shroud, X:16.8, Y:28.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-modest-proposal.html">A Modest Proposal</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="the-perfect-prey.html">The Perfect Prey</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'アダマンタスの大卵',
    tabs:{ story:'ストーリー', acq:'入手方法', unlockq:'開放クエスト', followq:'後続クエスト', comments:'コメント' },
    readMore:'全文を表示', readLess:'折りたたむ',
    story:`<div class="clamp" data-collapsed="true">
      <p>ランドゥネルはまず口止めを求める。自分と隊長、そしてあなたの間で交わされることはいっさい外に漏らすな、と。かつて海雄旅団として世界を渡り歩き、面白い連中に出会い、時にそれを葬ってきた日々は悔いていない。だが、グリダニアの民は概して容赦がない――例外はデト・モシュロカくらいのものだ。今の彼は「模範的な市民」を装うため、酒も博打も女遊びも断っている。その茶番を壊してみろ、腸で縄をこしらえて近くの柱に吊してやる、と物騒に釘を刺す。</p>
      <p>任務は単純に見えて命がけだ。東の巣にある「アダマンタスの大卵」を奪え。ただし親は子から離れず、卵に手を伸ばした刹那に襲いかかってくる。いまのうちに岩神タイタンを諦め、この湿地で朽ち果てる運命から逃れるのが賢明だ、と。</p>
      <p>やがて卵を抱えて戻ると、ランドゥネルは逃げ出すと思っていたと打ち明け、なおも食らいつく胆力に哄笑する。無謀さもまたタイタンには効く、と。卵は自分が隊長に渡す。あなたはサザン・サナラーンへ向かえ。忘れられたオアシスにいる「ウ・オド・ヌン」が次の案内役だ。</p>
      <p>忘れられたオアシスでウ・オド・ヌンは鼻を鳴らす。ヴェイスケートが寄越したのはおまえか、と。何を見込んだのか皆目わからん――納得するまで助力は与えん、と突き放す。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>クエスト発行</b> ランデネル　黒衣森：南部森林 <small class="muted">(X:16.8, Y:28.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-modest-proposal.html">エオルゼアの珍味を求めて</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="the-perfect-prey.html">ウ族の試練</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'巨龜的試煉之卵',
    tabs:{ story:'故事概要', acq:'取得方式', unlockq:'解鎖任務', followq:'後續任務', comments:'留言' },
    readMore:'展開全文', readLess:'收合內容',
    story:`<div class="clamp" data-collapsed="true">
      <p>Landenel 先把話說清楚：你、他、還有那位隊長之間的一切必須保密。他懷念在 Company of Heroes 的歲月——走遍各地、遇見形形色色的人、必要時也將其抹去——但 Gridanians 大多不寬容，Detoh 只是少數例外。為了維持「模範市民」的假象，他壓抑了所有舊癮；若你多嘴拆穿這場戲，他發誓要用你的腸子打成繩，把你吊在最近的柱上。</p>
      <p>任務表面簡單：往東有一個巢，裡頭正好有顆巨型 adamantoise 的蛋。但母獸從不遠離幼體，你一伸手就會被撕碎。他勸你此刻就放棄 Titan，免得讓這片沼澤多一具屍體。</p>
      <p>然而你抱著蛋回來了。他原以為你會知難而退，卻被你硬撐到底的意志逗得放聲大笑——這份勇敢或魯莽，面對 Titan 反倒管用。蛋交給他轉交給隊長；你立刻動身前往 southern Thanalan，在 Forgotten Springs 找到 U’odh Nunh，他會成為你的下一位引路人。</p>
      <p>抵達 Forgotten Springs 後，U’odh Nunh 冷冷地打量你，鼻間噴氣：原來 Wheiskaet 派來的是你？在他弄清自己憑什麼看上你之前，你休想得到任何幫助。</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>任務發布</b> 蘭德內爾　黑衣森林南部 <small class="muted">(X:16.8, Y:28.2)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="a-modest-proposal.html">尋找艾歐澤亞的珍味</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="the-perfect-prey.html">完美的獵物</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `🌐 ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscus：Comments 分頁 === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + '｜' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
