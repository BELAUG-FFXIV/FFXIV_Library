<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Helping Horn | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ Helping Horn (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/omjRZnM6WMM"
              title="Helping Horn" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">Helping Horn</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'Helping Horn',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>You find Meffrid at Quarrymill, and he doesnâ€™t bother to hide his frustration. He led his men here seeking refuge, only to meet cold indifferenceâ€”locals eager to see them gone. Worse still, some of his comrades arenâ€™t fit to travel, and Gallien canâ€™t even stand.</p>
      <p>With no help to be found in this cursed hamlet, Meffrid turns to you, an adventurer, because he has no other choice. In Ala Mhigo, he says, long antelope horn is a traditional remedy said to purge poison. If you can bring him four horns, heâ€™ll be forever in your debt.</p>
      <p>When you return with the four horns, Meffrid greets you with urgencyâ€”and then relief. He calls you a godsend and thanks Rhalgr that someone here still gives a damn. But thereâ€™s a problem: they need a way to prepare the horns. He asks if you know Buscarron, the man said to never turn away those in need. If you can take the horns to Buscarronâ€™s Druthers to have them ground down, then bring the powder back and give it to Faramund, he would be grateful.</p>
      <p>At Buscarronâ€™s Druthers, Buscarron welcomes you with his usual warmth and quick tongue, then leans in to see what youâ€™ve brought. He recognizes the antelope horns at onceâ€”and when you explain theyâ€™re meant to make medicine, he offers something better: heâ€™ll give you what he already has in his stores. He knows the remedy well. Years ago, an Ala Mhigan friend used it to treat a festering wound of his, and Buscarron says it saved his life. Hearing itâ€™s for an Ala Mhigan soldier in Quarrymill, he chuckles at the turn of fateâ€”and waves away any talk of payment.</p>
      <p>Back in Quarrymill, Faramund is visibly relieved to see you return. When you deliver the medicine, he blesses you and says heâ€™ll see that Gallien receives treatment at once. He adds that he hopes this will let the captain rest easierâ€”because trying to keep every man alive has been a terrible burden. He thanks you plainly for the kindness youâ€™ve shown.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Meffrid <small class="muted">South Shroud (X:25.6, Y:20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="killing-him-softly.html">Killing Him Softly</a></div>
      <div class="row">All classes and jobs (excluding limited jobs) (Level 27 or above)</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="he-aint-heavy.html">He Ainâ€™t Heavy</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'è§’è–¬ãŒç¹‹ãç¸',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ã‚ãªãŸãŒé»’è¡£æ£®ï¼šå—éƒ¨æ£®æ—ã®ã‚¯ã‚©ãƒ¼ãƒªãƒ¼ãƒŸãƒ«ã§ãƒ¡ãƒƒãƒ•ãƒªãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã¨ã€å½¼ã¯è‹›ç«‹ã¡ã‚’éš ãã†ã¨ã‚‚ã—ãªã„ã€‚éƒ¨ä¸‹ã‚’é€£ã‚Œã¦ã“ã“ã¸é¿é›£ã™ã‚‹ã¤ã‚‚ã‚Šã ã£ãŸãŒã€å¾…ã£ã¦ã„ãŸã®ã¯ç„¡é–¢å¿ƒã¨å†·ãŸã„è¿½ã„æ‰•ã„ã ã£ãŸã¨ã„ã†ã€‚ã—ã‹ã‚‚ä»²é–“ã®ä¸­ã«ã¯ç§»å‹•ã«è€ãˆã‚‰ã‚Œãªã„è€…ã‚‚ãŠã‚Šã€ã‚¬ãƒªã‚¨ãƒ³ã¯ç«‹ã¤ã“ã¨ã•ãˆã§ããªã„ã€‚</p>
      <p>ã“ã®å‘ªã‚ã‚ŒãŸé›†è½ã®è€…ãŸã¡ã¯åŠ©ã‘ã¦ãã‚Œãªã„â€•â€•ãã†è¨€ã„åˆ‡ã£ãŸãƒ¡ãƒƒãƒ•ãƒªãƒƒãƒ‰ã¯ã€ä»–ã«é ¼ã‚Œã‚‹ç›¸æ‰‹ãŒã„ãªã„ã‹ã‚‰ã“ãã€å†’é™ºè€…ã§ã‚ã‚‹ã‚ãªãŸã«é ­ã‚’ä¸‹ã’ã‚‹ã€‚ã‚¢ãƒ©ãƒŸã‚´ã§ã¯ã€Œã‚¢ãƒ³ãƒ†ãƒ­ãƒ¼ãƒ—ã®å¤§è§’ã€ã¯æ¯’ã‚’ç¥“ã†è–¬ã®ææ–™ã¨ã—ã¦ä¼ã‚ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚å››æœ¬æŒã£ã¦ãã¦ãã‚Œã‚‹ãªã‚‰ã€ä¸€ç”Ÿã®æ©ã«ç€ã‚‹ã¨å‘Šã’ã‚‹ã€‚</p>
      <p>ã‚ãªãŸãŒå››æœ¬ã®è§’ã‚’æŒã¡å¸°ã‚‹ã¨ã€ãƒ¡ãƒƒãƒ•ãƒªãƒƒãƒ‰ã¯ç„¦ã‚Šæ··ã˜ã‚Šã«ç¢ºã‹ã‚ã€ãã—ã¦å®‰å µã‚’ã«ã˜ã¾ã›ã‚‹ã€‚ã‚ãªãŸã¯ã¾ã•ã«æ•‘ã„ã®ç¥ã ã¨è¨€ã„ã€ãƒ©ãƒ¼ãƒ«ã‚¬ãƒ¼ã«æ„Ÿè¬ã™ã‚‹ãŒã€æ¬¡ã¯è§’ã‚’è–¬ã«ã™ã‚‹æ–¹æ³•ãŒå¿…è¦ã ã¨ã„ã†ã€‚ãã“ã§å½¼ã¯ãƒã‚¹ã‚«ãƒ­ãƒ³ã¨ã„ã†ç”·ã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹ã¨å°‹ã­ã‚‹ã€‚å›°ã£ã¦ã„ã‚‹è€…ã‚’å‡ºè‡ªã«é–¢ã‚ã‚‰ãšæ‹’ã¾ãªã„ã¨èã„ãŸã“ã¨ãŒã‚ã‚Šã€é…’æˆ¿ã€Œãƒã‚¹ã‚«ãƒ­ãƒ³ãƒ‰ãƒ©ã‚¶ãƒ¼ã‚ºã€ãªã‚‰è–¬ã‚’ä½œã‚‹é“å…·ã‚‚ã‚ã‚‹ã¯ãšã ã€‚è§’ã‚’æŒã£ã¦ã„ã£ã¦ã™ã‚Šæ½°ã—ã¦ã‚‚ã‚‰ã„ã€ã§ããŸè–¬ã‚’æŒã¡å¸°ã£ã¦ã€ã“ã“ã«ã„ã‚‹ãƒ•ã‚¡ãƒ©ãƒ ãƒ³ãƒ‰ã¸æ¸¡ã—ã¦ã»ã—ã„â€•â€•ãã†é ¼ã‚“ã§é€ã‚Šå‡ºã™ã€‚</p>
      <p>é…’æˆ¿ã€Œãƒã‚¹ã‚«ãƒ­ãƒ³ãƒ‰ãƒ©ã‚¶ãƒ¼ã‚ºã€ã§ãƒã‚¹ã‚«ãƒ­ãƒ³ã¯ã€ã‚ãªãŸã‚’è¦‹ã‚‹ãªã‚Šå¿«æ´»ã«å£°ã‚’ã‹ã‘ã€æŒå‚ã—ãŸã‚‚ã®ã«ç›®ã‚’ç•™ã‚ã‚‹ã€‚ã‚¢ãƒ³ãƒ†ãƒ­ãƒ¼ãƒ—ã®è§’ã ã¨è¦‹æŠœãã€è–¬ã«ã™ã‚‹ãŸã‚ã«ã™ã‚Šæ½°ã™ã®ã ã¨èãã¨ã€åº—ã®è²¯è”µã‹ã‚‰è‡ªåˆ†ã®ç”¨æ„ã—ã¦ã„ã‚‹ã‚‚ã®ã‚’æ¸¡ãã†ã¨è¨€ã„å‡ºã—ãŸã€‚å½¼ã¯ãã®è–¬ã«è¦šãˆãŒã‚ã‚Šã€æ˜”ã‚¢ãƒ©ãƒŸã‚´ã®å‹ãŒåŒ–è†¿ã—ãŸå‚·ã‚’æ²»ã—ã¦ãã‚Œã¦å‘½æ‹¾ã„ã—ãŸã®ã ã¨èªã‚‹ã€‚ã‚¯ã‚©ãƒ¼ãƒªãƒ¼ãƒŸãƒ«ã®ã‚¢ãƒ©ãƒŸã‚´å…µã®ãŸã‚ã ã¨çŸ¥ã‚‹ã¨ã€å·¡ã‚Šåˆã‚ã›ã ã¨ç¬‘ã„ã€ä»£é‡‘ã®å¿ƒé…ã¯ã™ã‚‹ãªã¨èƒŒä¸­ã‚’æŠ¼ã™ã€‚</p>
      <p>ã‚ãªãŸãŒã‚¯ã‚©ãƒ¼ãƒªãƒ¼ãƒŸãƒ«ã¸æˆ»ã‚‹ã¨ã€ãƒ•ã‚¡ãƒ©ãƒ ãƒ³ãƒ‰ã¯ç„¡äº‹ã®å¸°é‚„ã«å®‰å µã—ã€è–¬ã‚’å—ã‘å–ã‚‹ã¨ç¥ã€…ã®åŠ è­·ã‚’ç¥ˆã£ã¦ç¤¼ã‚’è¿°ã¹ã‚‹ã€‚ã‚¬ãƒªã‚¨ãƒ³ã«ã¯ã™ãå‡¦ç½®ã‚’æ–½ã™ã¨è¨€ã„ã€ã“ã‚Œã§éšŠé•·ã‚‚å°‘ã—ã¯æ¥½ã«ãªã‚‹ã ã‚ã†ã¨ç¶šã‘ãŸã€‚çš†ã‚’ç”Ÿã‹ãã†ã¨æŠ±ãˆè¾¼ã‚“ã§ããŸé‡è·ã¯å¤§ãã‹ã£ãŸã®ã ã¨æ‰“ã¡æ˜ã‘ã€ã‚ãªãŸã®åŠ©ã‘ã‚’ã¾ã£ã™ãã«æ„Ÿè¬ã™ã‚‹ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ãƒ¡ãƒƒãƒ•ãƒªãƒƒãƒ‰ã€€<small class="muted">é»’è¡£æ£®ï¼šå—éƒ¨æ£®æ— (X:25.6, Y:20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="killing-him-softly.html">ç„¡æ…ˆæ‚²ãªç²¾éœŠ</a></div>
      <div class="row">ã™ã¹ã¦ï¼ˆãƒªãƒŸãƒ†ãƒƒãƒ‰ã‚¸ãƒ§ãƒ–ã‚’é™¤ãï¼‰Lv 27ï½</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="he-aint-heavy.html">ç•°é‚¦ã®çµ†</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'å› è—¥çµç·£',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>ä½ åœ¨ Quarrymill æ‰¾åˆ° Meffrid æ™‚ï¼Œä»–æ¯«ä¸æ©é£¾è‡ªå·±çš„æ€’ç«ã€‚ä»–åŸæœ¬å¸¶è‘—éƒ¨ä¸‹ä¾†é€™è£¡å°‹æ±‚åº‡è­·ï¼Œå»åªæ›ä¾†å†·æ¼ â€”â€”é‚£äº›å†·è¡€çš„äººåªæƒ³æŠŠä»–å€‘è¶•èµ°ã€‚æ›´ç³Ÿçš„æ˜¯ï¼Œæœ‰äº›åŒä¼´æ ¹æœ¬ä¸é©åˆå†è¶•è·¯ï¼Œç”šè‡³é€£ Gallien éƒ½ç«™ä¸èµ·ä¾†ã€‚</p>
      <p>Meffrid èªªå¾—å¾ˆæ˜ç™½ï¼šé€™å€‹è©²æ­»çš„å°æ‘è½ä¸æœƒå¹«ä»–å€‘ï¼Œæ‰€ä»¥ä»–åªèƒ½è½‰å‘ä½ é€™ä½å†’éšªè€…æ±‚åŠ©ã€‚åœ¨ Ala Mhigoï¼Œé•·è§’ç¾šç¾Šè§’æ˜¯å‚³çµ±è—¥æ–¹çš„ä¸€éƒ¨åˆ†ï¼Œæ“šèªªèƒ½ç¥›æ¯’ä¿å‘½ã€‚åªè¦ä½ æ›¿ä»–å¸¶å›å››æ”¯è§’ï¼Œä»–ä¾¿æœƒæ°¸é è¨˜ä½ä½ çš„æ©æƒ…ã€‚</p>
      <p>ç•¶ä½ å¸¶è‘—å››æ”¯è§’å›ä¾†ï¼ŒMeffrid ç«‹åˆ»è¿½å•æ˜¯å¦å¸¶é½Šï¼Œéš¨å¾Œæ˜é¡¯é¬†äº†ä¸€å£æ°£ã€‚ä»–ç›´èªªä½ ç°¡ç›´æ˜¯æ•‘æ˜Ÿï¼Œä¹Ÿæ„Ÿå˜†åœ¨é€™è£¡è‡³å°‘é‚„æœ‰äººé¡˜æ„ä¼¸æ‰‹ã€‚å¯è¦æŠŠè§’è£½æˆè—¥ï¼Œé‚„å¾—æœ‰è¾¦æ³•è™•ç†ææ–™ã€‚æ–¼æ˜¯ä»–å•ä½ æ˜¯å¦èªè­˜ Buscarronâ€”â€”é‚£å€‹æ“šèªªä¸è«–ä¾†è‡ªä½•æ–¹ã€éƒ½ä¸æœƒæ‹’çµ•éœ€è¦å¹«åŠ©ä¹‹äººçš„äººã€‚å¦‚æœä½ é¡˜æ„æŠŠè§’å¸¶å» Buscarronâ€™s Druthersï¼Œè«‹å°æ–¹å”åŠ©è™•ç†æˆè—¥ï¼Œå†æŠŠæˆå“å¸¶å›ä¾†äº¤çµ¦ Faramundï¼Œä»–æœƒéå¸¸æ„Ÿæ¿€ã€‚</p>
      <p>åˆ°äº† Buscarronâ€™s Druthersï¼ŒBuscarron å…ˆç”¨ç†Ÿç¨”çš„èªæ°£æ‹›å‘¼ä½ ï¼Œæ¥è‘—ä¾¿æŠŠæ³¨æ„åŠ›æ”¾åœ¨ä½ å¸¶ä¾†çš„æ±è¥¿ä¸Šã€‚ä»–ä¸€çœ¼èªå‡ºé‚£æ˜¯ç¾šç¾Šè§’ï¼Œè½ä½ èªªè¦ç£¨æˆè—¥æå¾Œï¼Œä¹¾è„†æå‡ºæ›´å¥½çš„è¾¦æ³•ï¼šä»–å¯ä»¥ç›´æ¥æ‹¿å‡ºè‡ªå·±å‚™è‘—çš„ææ–™ã€‚Buscarron èªªä»–å°é€™ç¨®è—¥ä¸é™Œç”Ÿï¼Œå¤šå¹´å‰ä¸€ä½ Ala Mhigan æœ‹å‹æ›¾ç”¨å®ƒæ›¿ä»–æ²»å¥½åŒ–è†¿çš„å‚·å£ï¼Œç­‰æ–¼æ•‘äº†ä»–ä¸€å‘½ã€‚ç•¶ä»–å¾—çŸ¥é€™æ˜¯è¦æ•‘ Quarrymill çš„ Ala Mhigan å£«å…µæ™‚ï¼Œä¹Ÿå¿ä¸ä½æ„Ÿå˜†ç«Ÿæœ‰é€™æ¨£çš„å› ç·£ï¼Œä¸¦è¦ä½ åˆ¥å†æå ±é…¬ã€‚</p>
      <p>ä½ å›åˆ° Quarrymillï¼ŒFaramund çœ‹è¦‹ä½ å¹³å®‰æ­¸ä¾†ï¼Œèªæ°£è£¡å¸¶è‘—æ˜é¡¯çš„æ”¾é¬†ã€‚ä»–æ¥éè—¥å¾Œå‘ä½ è‡´è¬ï¼Œè¡¨ç¤ºæœƒç«‹åˆ»è®“ Gallien æ¥å—æ²»ç™‚ã€‚ä»–ä¹Ÿå¸Œæœ›é€™èƒ½è®“éšŠé•·ç¨å¾®å–˜å£æ°£â€”â€”ç‚ºäº†è®“æ¯å€‹äººéƒ½æ´»ä¸‹ä¾†ï¼ŒéšŠé•·æ‰¿å—äº†å¤ªæ²‰é‡çš„è² æ“”ã€‚æœ€å¾Œï¼ŒFaramund é„­é‡åœ°å‘ä½ é“è¬ï¼Œèªªä½ å€‘æ¬ ä½ ä¸€ä»½å¾ˆå¤§çš„æƒ…ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> æ¢…å¼—é‡Œå¾·ã€€<small class="muted">é»‘è¡£æ£® - å—éƒ¨æ£®æ— (X:25.6, Y:20.6)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="killing-him-softly.html">ç„¡æƒ…çš„æ£®éˆ</a></div>
      <div class="row">æ‰€æœ‰è·æ¥­ï¼ˆä¸å«é™å®šè·ï¼‰ ç­‰ç´š 27 ä»¥ä¸Š</div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="he-aint-heavy.html">ç•°é‚¦ä¹‹å‹</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
