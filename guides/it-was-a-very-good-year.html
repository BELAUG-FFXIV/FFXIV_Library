<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>It Was a Very Good Year | BELAUG Â· FFXIV Library</title>
  <meta name="description" content="MSQ â€“ It Was a Very Good Year (ARR Patch 2.0)">
  <link rel="icon" href="../img/favicon.ico" />
  <style>
    :root { --bg:#fff8e6; --card:#fff; --fg:#222; --muted:#666; --border:#e5e1d8; --accent:#e11d48; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Noto Sans TC","Noto Sans JP",Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .container{max-width:1080px;margin:0 auto;padding:0 16px}
    .site-header{border-bottom:1px solid var(--border);background:#fff9edb3;backdrop-filter:saturate(120%) blur(6px);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;height:60px}
    .left{display:flex;align-items:center;gap:12px}
    .home{border:1px solid var(--border);background:#fff;padding:4px 8px;border-radius:8px;text-decoration:none;color:var(--fg);font-weight:800}
    .home:hover{background:#fffef8}
    .right{display:flex;align-items:center;gap:8px}
    .icon-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:6px 10px;border-radius:8px}
    .icon-btn:hover{background:#fff;border:1px solid var(--border)}
    .main{padding:20px 0 40px}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:20px;align-items:start}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .video-wrap{position:relative;padding-top:56.25%}
      .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    }
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 14px rgba(0,0,0,.05)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700}
    .card .bd{padding:16px}
    .video-card .bd{padding:0}
    .video-card iframe{width:100%;height:420px;border:0;display:block;border-radius:16px}
    .tabs{display:flex;gap:8px;padding:12px 12px 0;flex-wrap:wrap}
    .tab-btn{background:#fff;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:8px 14px;cursor:pointer;font-weight:600}
    .tab-btn[aria-selected="true"]{border-color:var(--accent);color:#fff;background:var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .stack{display:flex;flex-direction:column;gap:10px}
    .stack .row{padding:12px 14px;border:1px dashed var(--border);border-radius:12px;background:#fffdf6}
    .row b{display:inline-block;min-width:130px}
    .muted{color:var(--muted)}
    .link{color:#0b60d8;text-decoration:none}
    .link:hover{text-decoration:underline}
    .clamp{position:relative; max-height:360px; overflow:hidden}
    .clamp[data-collapsed="false"]{max-height:none}
    .clamp[data-collapsed="true"]::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:72px;
      background:linear-gradient(to bottom, rgba(255,255,255,0), var(--card)); pointer-events:none;
    }
    .expand-wrap{ margin-top:12px; }
    .expand-btn{
      display:inline-block; padding:8px 14px; border-radius:10px;
      background:var(--card); border:1px solid var(--border); cursor:pointer; font-weight:600;
    }
    .expand-btn:hover{ background:#fffef8; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="container nav">
      <div class="left">
        <a class="home" href="../index.html">ğŸ  Home</a>
      </div>
      <div class="right">
        <button id="langToggle" class="icon-btn" aria-label="åˆ‡æ›èªè¨€">ğŸŒ EN</button>
      </div>
    </nav>
  </header>

  <main class="container main">
    <div class="grid">
      <!-- å·¦ï¼šå½±ç‰‡ -->
      <section class="card video-card">
        <div class="bd">
          <div class="video-wrap">
            <iframe id="ytFrame" src="https://www.youtube.com/embed/Oy-bLKM2L5k"
              title="It Was a Very Good Year" allowfullscreen></iframe>
          </div>
        </div>
      </section>

      <!-- å³ï¼šæ¨™é¡Œ + Tabs -->
      <section class="card">
        <div class="hd" id="pageTitle">It Was a Very Good Year</div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" aria-selected="true"  data-tab="story">Story</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="acq">Acquisition</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="unlockq">Unlock Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="followq">Follow-Up Quest</button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="comments">Comments</button>
        </div>
        <div class="bd">
          <div id="panel-story"   class="tab-panel active"></div>
          <div id="panel-acq"     class="tab-panel"></div>
          <div id="panel-unlockq" class="tab-panel"></div>
          <div id="panel-followq" class="tab-panel"></div>
          <div id="panel-comments" class="tab-panel">
            <div id="giscus_container" style="min-height:320px;"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

<script>
const LANG_KEY = 'ffxiv-guide-lang';
const i18n = {
  EN:{
    langLabel:'EN',
    pageTitle:'It Was a Very Good Year',
    tabs:{ story:'Story', acq:'Acquisition', unlockq:'Unlock Quest', followq:'Follow-Up Quest', comments:'Comments' },
    readMore:'Show more', readLess:'Show less',
    story:`<div class="clamp" data-collapsed="true">
      <p>Shamani Lohmaniâ€™s eyes widen in shock as he inspects the leaves that sealed Drestâ€™s palm wine. They are unmistakableâ€”Bacchus grape vine leaves. This means the legendary vine still survives somewhere in Raincatcher Gully. Overcome with excitement, he sends you back to Drest for answers.</p>
      <p>The hermit recalls seeing the leaves near a juggernaut to the south. He found no vines, but fresh goobbue tracks led him to suspect the plants might grow upon the beastsâ€™ backs. He warns you to be careful, for such creatures can be fiercely territorial.</p>
      <p>Following the trail, you recover a living cutting of the Bacchus grape vine. When you return, Shamani is elated. Byrglaent himself arrives, skeptical at firstâ€”yet the scent and texture leave no doubt. At Shamaniâ€™s urging, the cutting is gifted to the Wine Baron, the one most capable of restoring Wineportâ€™s former glory. Deeply moved, Byrglaent swears to revive the vineyards and ensure Bacchus wine flows once more across Eorzea.</p>
      <p>Then, as if fate itself blessed the moment, he presents a bottle from his private collection: a vintage 1547 Bacchus, thought lost since before the Calamity. He offers it freely, saying it was meant not for him, but for those who saved Wineport. Shamani can hardly contain his awe. With reverence, he entrusts the priceless wine to you, confident it will grace Master Gegerujuâ€™s banquet.</p>
      <p>At Costa del Sol, Wheiskaet marvels at the sight of the legendary bottle. He praises your dedication, promising that this feast shall be the finest Costa del Sol has seen in years. With the wine delivered, the preparations are completeâ€”and your companion awaits, eager for the banquet to begin.</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>Quest Giver</b> Shamani Lohmani <small class="muted">(Eastern La Noscea, X:21.6, Y:21.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="battle-scars.html">Battle Scars</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="in-the-company-of-heroes.html">In the Company of Heroes</a></div>
    </div>`
  },
  JP:{
    langLabel:'JP',
    pageTitle:'äººã®å‘½é‹ã€ãƒ¯ã‚¤ãƒ³ã®é‹å‘½',
    tabs:{ story:'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', acq:'å…¥æ‰‹æ–¹æ³•', unlockq:'é–‹æ”¾ã‚¯ã‚¨ã‚¹ãƒˆ', followq:'å¾Œç¶šã‚¯ã‚¨ã‚¹ãƒˆ', comments:'ã‚³ãƒ¡ãƒ³ãƒˆ' },
    readMore:'å…¨æ–‡ã‚’è¡¨ç¤º', readLess:'æŠ˜ã‚ŠãŸãŸã‚€',
    story:`<div class="clamp" data-collapsed="true">
      <p>ã‚·ãƒ£ãƒãƒ‹ãƒ»ãƒ­ãƒãƒ‹ã¯ãƒ‰ãƒ¬ã‚¹ãƒˆã®æ¤°å­é…’ã‚’å°ã˜ã¦ã„ãŸè‘‰ã«ç›®ã‚’è¦‹é–‹ãã€‚ãã‚Œã¯é–“é•ã„ãªãã€Œãƒãƒƒã‚«ã‚¹ã®è‘¡è„ã€ã®è‘‰ã ã£ãŸã€‚ã¤ã¾ã‚Šä¼èª¬ã®è‘¡è„æ¨¹ã¯ã¾ã ãƒ¬ã‚¤ãƒ³ã‚­ãƒ£ãƒƒãƒãƒ£ãƒ¼æ¨¹æ—ã®ã©ã“ã‹ã«ç”Ÿãæ®‹ã£ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚èˆˆå¥®ã‚’éš ã›ã¬å½¼ã¯ã€ãƒ‰ãƒ¬ã‚¹ãƒˆã«è©³ã—ãèã„ã¦ãã¦ã»ã—ã„ã¨é ¼ã‚€ã€‚</p>
      <p>ãƒ‰ãƒ¬ã‚¹ãƒˆã¯å—ã®ã‚¸ãƒ£ã‚¬ãƒ¼ãƒãƒ¼ãƒˆä»˜è¿‘ã§è¦‹ã¤ã‘ãŸã¨èªã‚‹ã€‚è‘¡è„æ¨¹è‡ªä½“ã¯è¦‹ãªã‹ã£ãŸãŒã€æ–°ã—ã„ã‚°ã‚¥ãƒ¼ãƒ–ãƒ¼ã®è¶³è·¡ãŒã‚ã‚Šã€ã‚‚ã—ã‹ã™ã‚‹ã¨ãã®èƒŒã«è‘¡è„ã®è”¦ãŒè‚²ã£ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã¨æ¨æ¸¬ã™ã‚‹ã€‚ç¸„å¼µã‚Šæ„è­˜ãŒå¼·ã„ãŸã‚ã€æ³¨æ„ã™ã‚‹ã‚ˆã†å¿ å‘Šã‚’æ®‹ã™ã€‚</p>
      <p>å›ãŒæ¢ç´¢ã®æœ«ã«æ‰‹ã«ã—ãŸã®ã¯ã€ç”ŸããŸã€Œãƒãƒƒã‚«ã‚¹ã®è‘¡è„ã€ã®æã ã£ãŸã€‚ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«æŒã¡å¸°ã‚‹ã¨ã€ã‚·ãƒ£ãƒãƒ‹ã¯æ­“å–œã®å£°ã‚’ä¸Šã’ã‚‹ã€‚ãã“ã¸ç¾ã‚ŒãŸã®ã¯ãƒ¯ã‚¤ãƒ³ç”·çˆµãƒã‚¤ã‚°ãƒ©ãƒ³ãƒˆã€‚æœ€åˆã¯ã€Œå†’é™ºè€…ã¨é§†ã‘å‡ºã—ã®é†¸é€ å®¶ã«æœ¬ç‰©ãŒè¦‹æŠœã‘ã‚‹ã¯ãšãŒãªã„ã€ã¨ä¸€ç¬‘ã«ä»˜ã™ãŒã€è‘‰ã®é¦™ã‚Šã¨æã®è³ªæ„Ÿã«è§¦ã‚Œã€ã¤ã„ã«æœ¬ç‰©ã ã¨èªã‚ã–ã‚‹ã‚’å¾—ãªã‹ã£ãŸã€‚ã‚·ãƒ£ãƒãƒ‹ã¯ã€Œè‘¡è„åœ’ã®å†å»ºã«ã¯ã‚ãªãŸã—ã‹ã„ãªã„ã€ã¨åˆ‡ã‚Šæã‚’å·®ã—å‡ºã—ã€ãƒã‚¤ã‚°ãƒ©ãƒ³ãƒˆã¯æ·±ãæ„Ÿå‹•ã—ã¦èª“ã†ã€‚ã€Œå¿…ãšã‚„ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®è‘¡è„é…’ã‚’è˜‡ã‚‰ã›ã€å†ã³ã‚¨ã‚ªãƒ«ã‚¼ã‚¢ä¸­ã«åã‚’é¦³ã›ã‚ˆã†ã€ã¨ã€‚</p>
      <p>ã•ã‚‰ã«å½¼ã¯ã€ç§˜è”µã®1æœ¬ã‚’å·®ã—å‡ºã™ã€‚ãªã‚“ã¨ã€Œ1547å¹´ã‚‚ã®ã®ãƒãƒƒã‚«ã‚¹ã®è‘¡è„é…’ã€â”€â”€éœŠç½ä»¥å‰ã‹ã‚‰å¤±ã‚ã‚ŒãŸã¨ã•ã‚Œã¦ã„ãŸå¹»ã®ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ã ã€‚ãã‚Œã¯è‡ªåˆ†ã®ãŸã‚ã§ã¯ãªãã€ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’æ•‘ã£ãŸè€…ãŸã¡ã®ãŸã‚ã«ã‚ã‚‹ã®ã ã¨ã€‚ã‚·ãƒ£ãƒãƒ‹ã¯æ„Ÿæ¥µã¾ã‚Šã€ãã®è²´é‡ãªé…’ã‚’å›ã«è¨—ã™ã€‚ã€Œã‚²ã‚²ãƒ«ã‚¸ãƒ¥æ§˜ã®å®´ã‚’é£¾ã‚‹ã«ã€ã“ã‚Œä»¥ä¸Šã®é…’ã¯ãªã„ã€ã¨ã€‚</p>
      <p>ã‚³ã‚¹ã‚¿ãƒ»ãƒ‡ãƒ«ãƒ»ã‚½ãƒ«ã«æˆ»ã‚‹ã¨ã€ã‚¦ã‚£ã‚¤ã‚¹ã‚±ãƒ¼ãƒˆãŒé©šæ„•ã®å£°ã‚’ä¸Šã’ã‚‹ã€‚ã€Œä¸ƒã¤ã®åœ°ç„ã‚ˆã€1547å¹´ã‚‚ã®ã®ãƒãƒƒã‚«ã‚¹ã‹ï¼ã€ã¨ã€‚ãã®å¸Œå°‘ã•ã‚’çŸ¥ã‚‹å½¼ã¯ã€å›ã®å°½åŠ›ã‚’ç§°ãˆã€ã“ã‚ŒãŒã‚³ã‚¹ã‚¿ãƒ»ãƒ‡ãƒ«ãƒ»ã‚½ãƒ«ã§ã‚‚å‰ä»£æœªèã®è±ªè¯ãªå®´ã«ãªã‚‹ã¨ä¿è¨¼ã™ã‚‹ã®ã ã£ãŸã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ã‚¯ã‚¨ã‚¹ãƒˆç™ºè¡Œ</b> ã‚·ãƒ£ãƒãƒ‹ãƒ»ãƒ­ãƒ¼ãƒãƒ‹ã€€æ±ãƒ©ãƒã‚·ã‚¢ <small class="muted">(X:21.6, Y:21.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="battle-scars.html">å‹æƒ…ã®æœ¨ã®å®Ÿ</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="in-the-company-of-heroes.html">æ°¸é ãªã‚‹æµ·é›„æ—…å›£</a></div>
    </div>`
  },
  ZH:{
    langLabel:'ZH',
    pageTitle:'å‘½é‹èˆ‡é…’é¦™äº¤ç¹”çš„ä¸€å¹´',
    tabs:{ story:'æ•…äº‹æ¦‚è¦', acq:'å–å¾—æ–¹å¼', unlockq:'è§£é–ä»»å‹™', followq:'å¾ŒçºŒä»»å‹™', comments:'ç•™è¨€' },
    readMore:'å±•é–‹å…¨æ–‡', readLess:'æ”¶åˆå…§å®¹',
    story:`<div class="clamp" data-collapsed="true">
      <p>Shamani Lohmani é©šè¨åœ°ç™¼ç¾ï¼Œå°ä½ Drest æ¤°å­é…’çš„è‘‰ç‰‡ï¼Œç«Ÿæ˜¯ Bacchus è‘¡è„è—¤çš„è‘‰å­ï¼é€™æ„å‘³è‘—å‚³èªªä¸­çš„è‘¡è„è—¤ä»å­˜æ´»æ–¼ Raincatcher Gullyã€‚ä»–æ¿€å‹•ä¸å·²ï¼Œç«‹åˆ»è«‹ä½ å¸¶è‘—è‘‰å­å›å»è©¢å• Drestã€‚</p>
      <p>Drest å›æƒ³èµ·æ˜¯åœ¨å—æ–¹ juggernaut é™„è¿‘æ‰¾åˆ°çš„ã€‚ä»–æ²’è¦‹åˆ°è—¤è”“ï¼Œä½†æ³¨æ„åˆ°æ–°é®®çš„ goobbue è¶³è·¡ï¼Œä¹Ÿè¨±è‘¡è„è—¤å°±ç”Ÿé•·åœ¨ç‰ å€‘çš„èƒŒä¸Šã€‚ä»–æé†’ä½ å‹™å¿…å°å¿ƒï¼Œé‚£äº›å·¨ç¸é ˜åœ°æ„è­˜æ¥µå¼·ã€‚</p>
      <p>å¾ªè·¡è€Œè¡Œï¼Œä½ çµ‚æ–¼ç²å¾—äº†ä¸€æ ªå°šå­˜æ´»çš„ Bacchus è‘¡è„è—¤ã€‚å¸¶å› Wineport å¾Œï¼ŒShamani æ¬£å–œè‹¥ç‹‚ã€‚Byrglaent èè¨Šè€Œä¾†ï¼Œèµ·åˆå—¤ä¹‹ä»¥é¼»ï¼Œä½†åœ¨è¦ªè‡ªæª¢è¦–å¾Œï¼Œä¸å¾—ä¸æ‰¿èªé€™æ˜¯çœŸæ­£çš„å‚³å¥‡è‘¡è„è—¤ã€‚Shamani å°‡ææ¢äº¤çµ¦ä»–ï¼Œå› ç‚ºå”¯æœ‰ Wine Baron æ“æœ‰é‡å»ºè‘¡è„åœ’çš„è³‡æºèˆ‡æŠ€è—ã€‚Byrglaent æ·±å—æ„Ÿå‹•ï¼Œç«‹èª“è¦è®“ Bacchus è‘¡è„é…’é‡è¿”æ¦®å…‰ã€‚</p>
      <p>æ›´ä»¤äººé›£ä»¥ç½®ä¿¡çš„æ˜¯ï¼Œä»–å–å‡ºç§äººæ”¶è—çš„è‡³å¯¶â”€â”€ä¸€ç“¶ 1547 å¹´çš„ Bacchusï¼Œé€™æ¬¾é…’è‡ª Calamity å‰ä¾¿å·²å¤±è½ã€‚ä»–èªªï¼Œé€™é…’ä¸¦éç‚ºè‡ªå·±è€Œç”Ÿï¼Œè€Œæ˜¯æ‡‰è©²ç»çµ¦æ‹¯æ•‘ Wineport çš„äººã€‚Shamani å¹¾ä¹è½æ·šï¼Œå°‡é€™ç“¶é…’è¨—ä»˜çµ¦ä½ ï¼Œæ·±ä¿¡é€™å°‡æ˜¯ Master Gegeruju å®´å¸­ä¸Šçš„å®Œç¾ä¹‹é¸ã€‚</p>
      <p>ç•¶ä½ å°‡é…’å¸¶å› Costa del Solï¼ŒWheiskaet éœ‡é©šåœ°èªå‡ºé€™å‚³èªªä¸­çš„å¹´ä»½é…’ï¼Œç¨±é€™æ˜¯å‰æ‰€æœªæœ‰çš„ç››å®´ï¼Œè¶³ä»¥åç•™ Costa del Sol æ­·å²ã€‚ä»–è¡·å¿ƒç¥è³€ä½ ï¼Œä¸¦æé†’è³“å®¢å·²åœ¨ç­‰å¾…ã€‚å®´æœƒï¼Œå³å°‡é–‹å§‹ã€‚</p>
    </div>
    <div class="expand-wrap"><button class="expand-btn" data-role="expand"></button></div>`,
    acq:`<div class="stack">
      <div class="row"><b>ä»»å‹™ç™¼å¸ƒ</b> å¤ç‘ªå°¼ãƒ»ç¾…ç‘ªå°¼ã€€æ‹‰è«¾è¥¿äºæ±éƒ¨ <small class="muted">(X:21.6, Y:21.1)</small></div>
    </div>`,
    unlockq:`<div class="stack">
      <div class="row"><a class="link" href="battle-scars.html">å‚·ç—•å­•è‚²çš„å‹èª¼</a></div>
    </div>`,
    followq:`<div class="stack">
      <div class="row"><a class="link" href="in-the-company-of-heroes.html">èˆ‡è‹±é›„ç‚ºä¼</a></div>
    </div>`
  }
};

const langToggle  = document.getElementById('langToggle');
const pageTitle   = document.getElementById('pageTitle');
const tabBtns     = [...document.querySelectorAll('.tab-btn')];
const panels = {
  story:  document.getElementById('panel-story'),
  acq:    document.getElementById('panel-acq'),
  unlockq:document.getElementById('panel-unlockq'),
  followq:document.getElementById('panel-followq'),
  comments: document.getElementById('panel-comments')
};

function getLang(){ return localStorage.getItem(LANG_KEY) || 'EN'; }
function applyLang(lang){
  const t = i18n[lang] || i18n.EN;
  pageTitle.textContent = t.pageTitle;
  langToggle.textContent = `ğŸŒ ${t.langLabel}`;
  tabBtns.forEach(btn => { btn.textContent = t.tabs[btn.dataset.tab]; });
  const activeBtn = tabBtns.find(b => b.getAttribute('aria-selected')==='true') || tabBtns[0];
  renderPanel(activeBtn.dataset.tab, lang);
}

function wireClamp(panelEl, t){
  const clamp = panelEl.querySelector('.clamp');
  const btn = panelEl.querySelector('[data-role="expand"]');
  if(!clamp || !btn) return;
  function setLabel(){
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    btn.textContent = collapsed ? t.readMore : t.readLess;
  }
  setLabel();
  btn.addEventListener('click', ()=>{
    const collapsed = clamp.getAttribute('data-collapsed') !== 'false';
    clamp.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
    setLabel();
  });
}

function renderPanel(key, lang){
  const t = i18n[lang] || i18n.EN;
  Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
  panels[key].classList.add('active');
  if (key !== 'comments') panels[key].innerHTML = t[key];
  if (key === 'story') wireClamp(panels[key], t);
  if (key === 'comments') loadGiscusForCurrentLang();
}

tabBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    tabBtns.forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    renderPanel(btn.dataset.tab, getLang());
  });
});

langToggle.addEventListener('click', ()=>{
  const cur = getLang();
  const next = cur==='EN' ? 'JP' : (cur==='JP' ? 'ZH' : 'EN');
  localStorage.setItem(LANG_KEY, next);
  applyLang(next);
});

applyLang(getLang());

/* === Giscusï¼šComments åˆ†é  === */
const GISCUS_CFG = {
  repo: 'BELAUG-FFXIV/FFXIV_Library',
  repoId: 'R_kgDOPyh4Kw',
  category: 'General',
  categoryId: 'DIC_kwDOPyh4K84CwPjL',
  theme: 'preferred_color_scheme'
};
function uiLang(code){ return code==='JP' ? 'ja' : (code==='ZH' ? 'zh-TW' : 'en'); }
function loadGiscusForCurrentLang(){
  const mount = document.getElementById('giscus_container');
  if (!mount) return;
  mount.innerHTML = '';
  const langCode = getLang();
  const s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', GISCUS_CFG.repo);
  s.setAttribute('data-repo-id', GISCUS_CFG.repoId);
  s.setAttribute('data-category', GISCUS_CFG.category);
  s.setAttribute('data-category-id', GISCUS_CFG.categoryId);
  s.setAttribute('data-mapping', 'specific');
  s.setAttribute('data-term', location.pathname + 'ï½œ' + langCode);
  s.setAttribute('data-reactions-enabled', '1');
  s.setAttribute('data-emit-metadata', '0');
  s.setAttribute('data-input-position', 'bottom');
  s.setAttribute('data-lang', uiLang(langCode));
  s.setAttribute('data-theme', GISCUS_CFG.theme);
  s.setAttribute('crossorigin', 'anonymous');
  s.async = true;
  mount.appendChild(s);
}
</script>
</body>
</html>
