<main id="top" class="container topic">

  <nav class="crumbs">
    <a href="../index.html">← Back to Library</a>
  </nav>

  <h1 id="tTitle"></h1>

  <div class="topic-meta">
    <span class="badge">MSQ</span>
    <span class="badge">DT</span>
    <span class="badge">Patch 7.0</span>
  </div>

  <!-- 任務資訊 -->
  <section class="facts">
    <dl>
      <div><dt id="lStartNpc">Start NPC</dt><dd id="vStartNpc"></dd></div>
      <div><dt id="lLocation">Location</dt><dd id="vLocation"></dd></div>
      <div><dt id="lPrereq">Prerequisites</dt><dd id="vPrereq"></dd></div>
      <div><dt id="lRewards">Rewards</dt><dd id="vRewards"></dd></div>
      <div><dt id="lExpansion">Expansion</dt><dd id="vExpansion"></dd></div>
      <div><dt id="lPatch">Patch</dt><dd id="vPatch"></dd></div>
    </dl>
  </section>

  <!-- 影片 -->
  <section class="video">
    <div class="video-wrap">
      <iframe
        id="yt"
        src="https://www.youtube.com/embed/HMf2Ldtb36Y"
        title="A New World to Explore"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen></iframe>
    </div>
  </section>

  <!-- 簡介 / 劇情說明 -->
  <section>
    <h2 id="lOverview">Overview</h2>
    <p id="pOverview"></p>
  </section>

  <!-- 步驟 -->
  <section>
    <h2 id="lSteps">Steps</h2>
    <ol id="olSteps"></ol>
  </section>

</main>

<!-- 單頁 i18n：三語內容寫在這邊 -->
<script>
/** 這裡填入此主題的三語內容（標題、簡介、步驟、任務資訊） **/
const TOPIC = {
  EN: {
    title: "A New World to Explore",
    facts: {
      startNpc: "Tataru",
      location: "Limsa Lominsa – Upper Decks (X:11.1 Y:11.1)",
      prereq:  "Complete “The Seventh Umbral Era”",
      rewards: "EXP + 615 gil",
      expansion: "Dawntrail",
      patch: "7.0"
    },
    overview: "The Warrior of Light sets sail for a distant continent to begin a new chapter...",
    steps: [
      "Speak with Tataru in Limsa Lominsa.",
      "Sail to the New World.",
      "Report to the local envoy and receive your letter of introduction."
    ],
    labels: {
      startNpc: "Start NPC",
      location: "Location",
      prereq: "Prerequisites",
      rewards: "Rewards",
      expansion: "Expansion",
      patch: "Patch",
      overview: "Overview",
      steps: "Steps"
    }
  },

  JP: {
    title: "新たな世界へ",
    facts: {
      startNpc: "タタル",
      location: "リムサ・ロミンサ：上甲板層 (X:11.1 Y:11.1)",
      prereq:  "「第七霊災編」をコンプリート",
      rewards: "経験値 + 615ギル",
      expansion: "黄金のレガシー",
      patch: "7.0"
    },
    overview: "光の戦士は新大陸へ向けて船出し、新たな物語が幕を開ける……。",
    steps: [
      "リムサ・ロミンサでタタルと話す。",
      "新大陸へ航海する。",
      "現地の使者に報告し、紹介状を受け取る。"
    ],
    labels: {
      startNpc: "開始NPC",
      location: "場所",
      prereq: "前提条件",
      rewards: "報酬",
      expansion: "資料片",
      patch: "パッチ",
      overview: "概要",
      steps: "手順"
    }
  },

  ZH: {
    title: "全新的世界",
    facts: {
      startNpc: "塔塔露",
      location: "利姆薩．羅敏薩─上層甲板 (X:11.1 Y:11.1)",
      prereq:  "完成「第七靈災篇」",
      rewards: "經驗值 + 615 金幣",
      expansion: "黃金的遺產",
      patch: "7.0"
    },
    overview: "光之戰士向新大陸啟航，新的故事由此展開……",
    steps: [
      "在利姆薩．羅敏薩與塔塔露對話。",
      "啟程前往新大陸。",
      "向當地使者報到並取得介紹信。"
    ],
    labels: {
      startNpc: "開始 NPC",
      location: "地點",
      prereq: "前置條件",
      rewards: "報酬",
      expansion: "資料片",
      patch: "Patch",
      overview: "簡介",
      steps: "步驟"
    }
  }
};

// 讀全站語言（沿用你現有的 LANG_KEY）
const CUR_LANG_KEY = localStorage.getItem('ffxiv-lib-lang') || 'EN';

function fillTopic(lang) {
  const d = TOPIC[lang] || TOPIC.EN;
  const L = d.labels;

  // 標題
  document.getElementById('tTitle').textContent = d.title;

  // facts
  document.getElementById('lStartNpc').textContent = L.startNpc;
  document.getElementById('lLocation').textContent = L.location;
  document.getElementById('lPrereq').textContent  = L.prereq;
  document.getElementById('lRewards').textContent = L.rewards;
  document.getElementById('lExpansion').textContent = L.expansion;
  document.getElementById('lPatch').textContent   = L.patch;

  document.getElementById('vStartNpc').textContent = d.facts.startNpc;
  document.getElementById('vLocation').textContent = d.facts.location;
  document.getElementById('vPrereq').textContent   = d.facts.prereq;
  document.getElementById('vRewards').textContent  = d.facts.rewards;
  document.getElementById('vExpansion').textContent = d.facts.expansion;
  document.getElementById('vPatch').textContent    = d.facts.patch;

  // Overview + Steps
  document.getElementById('lOverview').textContent = L.overview;
  document.getElementById('pOverview').textContent = d.overview;
  document.getElementById('lSteps').textContent    = L.steps;
  document.getElementById('olSteps').innerHTML     = d.steps.map(s => `<li>${s}</li>`).join('');
}

// 初始化 + 監聽全站語言切換
fillTopic(CUR_LANG_KEY);
document.getElementById('langToggle')?.addEventListener('click', () => {
  // 等全站 lang 寫入 localStorage 後再取值
  setTimeout(() => fillTopic(localStorage.getItem('ffxiv-lib-lang') || 'EN'), 0);
});
</script>
